'use strict';(function(a){function b(a){throw RangeError(w[a]);}function d(a,b){for(var g=a.length,c=[];g--;)c[g]=b(a[g]);return c}function c(a,b){var g=a.split("@"),c="";1<g.length&&(c=g[0]+"@",a=g[1]);a=a.replace(t,".");g=a.split(".");g=d(g,b).join(".");return c+g}function e(a){for(var b=[],g=0,c=a.length,k,p;g<c;)k=a.charCodeAt(g++),55296<=k&&56319>=k&&g<c?(p=a.charCodeAt(g++),56320==(p&64512)?b.push(((k&1023)<<10)+(p&1023)+65536):(b.push(k),g--)):b.push(k);return b}function f(a){return d(a,function(a){var b=
"";65535<a&&(a-=65536,b+=x(a>>>10&1023|55296),a=56320|a&1023);return b+=x(a)}).join("")}function h(a,b){return a+22+75*(26>a)-((0!=b)<<5)}function m(a,b,g){var c=0;a=g?v(a/700):a>>1;for(a+=v(a/b);455<a;c+=36)a=v(a/35);return v(c+36*a/(a+38))}function n(a){var g=[],c=a.length,k,p=0,d=128,r=72,e,l,n,h,q;e=a.lastIndexOf("-");0>e&&(e=0);for(l=0;l<e;++l)128<=a.charCodeAt(l)&&b("not-basic"),g.push(a.charCodeAt(l));for(e=0<e?e+1:0;e<c;){l=p;k=1;for(n=36;;n+=36){e>=c&&b("invalid-input");h=a.charCodeAt(e++);
h=10>h-48?h-22:26>h-65?h-65:26>h-97?h-97:36;(36<=h||h>v((2147483647-p)/k))&&b("overflow");p+=h*k;q=n<=r?1:n>=r+26?26:n-r;if(h<q)break;h=36-q;k>v(2147483647/h)&&b("overflow");k*=h}k=g.length+1;r=m(p-l,k,0==l);v(p/k)>2147483647-d&&b("overflow");d+=v(p/k);p%=k;g.splice(p++,0,d)}return f(g)}function p(a){var g,c,k,p,d,f,r,l,n,q=[],u,t,w;a=e(a);u=a.length;g=128;c=0;d=72;for(f=0;f<u;++f)n=a[f],128>n&&q.push(x(n));for((k=p=q.length)&&q.push("-");k<u;){r=2147483647;for(f=0;f<u;++f)n=a[f],n>=g&&n<r&&(r=n);
t=k+1;r-g>v((2147483647-c)/t)&&b("overflow");c+=(r-g)*t;g=r;for(f=0;f<u;++f)if(n=a[f],n<g&&2147483647<++c&&b("overflow"),n==g){l=c;for(r=36;;r+=36){n=r<=d?1:r>=d+26?26:r-d;if(l<n)break;w=l-n;l=36-n;q.push(x(h(n+w%l,0)));l=v(w/l)}q.push(x(h(l,0)));d=m(c,t,k==p);c=0;++k}++c;++g}return q.join("")}var g="object"==typeof exports&&exports&&!exports.nodeType&&exports,r="object"==typeof module&&module&&!module.nodeType&&module,k="object"==typeof global&&global;if(k.global===k||k.window===k||k.self===k)a=
k;var q,l=/^xn--/,u=/[^\x20-\x7E]/,t=/[\x2E\u3002\uFF0E\uFF61]/g,w={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},v=Math.floor,x=String.fromCharCode,y;q={version:"1.3.2",ucs2:{decode:e,encode:f},decode:n,encode:p,toASCII:function(a){return c(a,function(a){return u.test(a)?"xn--"+p(a):a})},toUnicode:function(a){return c(a,function(a){return l.test(a)?n(a.slice(4).toLowerCase()):a})}};if("function"==
typeof define&&"object"==typeof define.amd&&define.amd)define("punycode",function(){return q});else if(g&&r)if(module.exports==g)r.exports=q;else for(y in q)q.hasOwnProperty(y)&&(g[y]=q[y]);else a.punycode=q})(this);
(function(a){function b(a){if(!a)return"";for(var b;;){b=a.indexOf(".");if(0>b)return a;if(d(e,a))return a.slice(b+1);if(d(f,a)||d(f,"*"+a.slice(b)))return a;a=a.slice(b+1)}}function d(a,b){var c=b.lastIndexOf("."),k;0>c?c=k=b:(k=b.slice(c+1),c=b.slice(0,c));var m=a[k];if(!m)return!1;if("string"===typeof m)return 0<=m.indexOf(" "+c+" ");k=c.length;m=m[k];if(!m)return!1;for(var d=0,f=Math.floor(m.length/k+.5),e,n;d<f;)if(e=d+f>>1,n=m.substr(k*e,k),c<n)f=e;else if(c>n)d=e+1;else return!0;return!1}function c(a){var b,
c,k,m,d;for(d in a)if(a.hasOwnProperty(d))if(b=a[d].join(" "))if(256>b.length)a[d]=" "+b+" ";else{k=a[d].length;for(b=[];k--;)c=a[d][k],m=c.length,b[m]||(b[m]=[]),b[m].push(c);for(m=b.length;m--;)b[m]&&(b[m]=b[m].sort().join(""));a[d]=b}else a[d]="";return a}var e={},f={},h=/[^a-z0-9.-]/,m=[],n=function(a){for(var b=0;b<a.length;b++)a[b]()};a=a||window;a.publicSuffixList={version:"1.0",parse:function(a,b){e={};f={};a=a.toLowerCase();for(var d=0,k,q=a.length,l,u,t;d<q;)if(k=a.indexOf("\n",d),0>k&&
(k=a.indexOf("\r",d),0>k&&(k=q)),l=a.slice(d,k).trim(),d=k+1,0!==l.length&&(u=l.indexOf("//"),0<=u&&(l=l.slice(0,u)),l=l.trim()))h.test(l)&&(l=b(l)),"!"===l.charAt(0)?(k=e,l=l.slice(1)):k=f,u=l.lastIndexOf("."),0>u?t=l:(t=l.slice(u+1),l=l.slice(0,u)),k.hasOwnProperty(t)||(k[t]=[]),l&&k[t].push(l);c(e);c(f);n(m)},getDomain:function(a){if(!a||"."===a.charAt(0))return"";a=a.toLowerCase();var c=b(a);if(c===a)return"";c=a.lastIndexOf(".",a.lastIndexOf(".",a.length-c.length)-1);return 0>=c?a:a.slice(c+
1)},getPublicSuffix:b,toSelfie:function(){return{magic:"iscjsfsaolnm",rules:f,exceptions:e}},fromSelfie:function(a){if("object"!==typeof a||"string"!==typeof a.magic||"iscjsfsaolnm"!==a.magic)return!1;f=a.rules;e=a.exceptions;n(m);return!0},onChanged:{addListener:function(a){"function"===typeof a&&-1===m.indexOf(a)&&m.push(a)},removeListener:function(a){a=m.indexOf(a);-1!==a&&m.splice(a,1)}}}})(this);
(function(a){var b=function(a,b){var c=a[0],g=a[1],d=a[2],k=a[3],c=c+((g&d|~g&k)+b[0]-680876936|0),c=(c<<7|c>>>25)+g|0,k=k+((c&g|~c&d)+b[1]-389564586|0),k=(k<<12|k>>>20)+c|0,d=d+((k&c|~k&g)+b[2]+606105819|0),d=(d<<17|d>>>15)+k|0,g=g+((d&k|~d&c)+b[3]-1044525330|0),g=(g<<22|g>>>10)+d|0,c=c+((g&d|~g&k)+b[4]-176418897|0),c=(c<<7|c>>>25)+g|0,k=k+((c&g|~c&d)+b[5]+1200080426|0),k=(k<<12|k>>>20)+c|0,d=d+((k&c|~k&g)+b[6]-1473231341|0),d=(d<<17|d>>>15)+k|0,g=g+((d&k|~d&c)+b[7]-45705983|0),g=(g<<22|g>>>10)+
d|0,c=c+((g&d|~g&k)+b[8]+1770035416|0),c=(c<<7|c>>>25)+g|0,k=k+((c&g|~c&d)+b[9]-1958414417|0),k=(k<<12|k>>>20)+c|0,d=d+((k&c|~k&g)+b[10]-42063|0),d=(d<<17|d>>>15)+k|0,g=g+((d&k|~d&c)+b[11]-1990404162|0),g=(g<<22|g>>>10)+d|0,c=c+((g&d|~g&k)+b[12]+1804603682|0),c=(c<<7|c>>>25)+g|0,k=k+((c&g|~c&d)+b[13]-40341101|0),k=(k<<12|k>>>20)+c|0,d=d+((k&c|~k&g)+b[14]-1502002290|0),d=(d<<17|d>>>15)+k|0,g=g+((d&k|~d&c)+b[15]+1236535329|0),g=(g<<22|g>>>10)+d|0,c=c+((g&k|d&~k)+b[1]-165796510|0),c=(c<<5|c>>>27)+g|
0,k=k+((c&d|g&~d)+b[6]-1069501632|0),k=(k<<9|k>>>23)+c|0,d=d+((k&g|c&~g)+b[11]+643717713|0),d=(d<<14|d>>>18)+k|0,g=g+((d&c|k&~c)+b[0]-373897302|0),g=(g<<20|g>>>12)+d|0,c=c+((g&k|d&~k)+b[5]-701558691|0),c=(c<<5|c>>>27)+g|0,k=k+((c&d|g&~d)+b[10]+38016083|0),k=(k<<9|k>>>23)+c|0,d=d+((k&g|c&~g)+b[15]-660478335|0),d=(d<<14|d>>>18)+k|0,g=g+((d&c|k&~c)+b[4]-405537848|0),g=(g<<20|g>>>12)+d|0,c=c+((g&k|d&~k)+b[9]+568446438|0),c=(c<<5|c>>>27)+g|0,k=k+((c&d|g&~d)+b[14]-1019803690|0),k=(k<<9|k>>>23)+c|0,d=d+
((k&g|c&~g)+b[3]-187363961|0),d=(d<<14|d>>>18)+k|0,g=g+((d&c|k&~c)+b[8]+1163531501|0),g=(g<<20|g>>>12)+d|0,c=c+((g&k|d&~k)+b[13]-1444681467|0),c=(c<<5|c>>>27)+g|0,k=k+((c&d|g&~d)+b[2]-51403784|0),k=(k<<9|k>>>23)+c|0,d=d+((k&g|c&~g)+b[7]+1735328473|0),d=(d<<14|d>>>18)+k|0,g=g+((d&c|k&~c)+b[12]-1926607734|0),g=(g<<20|g>>>12)+d|0,c=c+((g^d^k)+b[5]-378558|0),c=(c<<4|c>>>28)+g|0,k=k+((c^g^d)+b[8]-2022574463|0),k=(k<<11|k>>>21)+c|0,d=d+((k^c^g)+b[11]+1839030562|0),d=(d<<16|d>>>16)+k|0,g=g+((d^k^c)+b[14]-
35309556|0),g=(g<<23|g>>>9)+d|0,c=c+((g^d^k)+b[1]-1530992060|0),c=(c<<4|c>>>28)+g|0,k=k+((c^g^d)+b[4]+1272893353|0),k=(k<<11|k>>>21)+c|0,d=d+((k^c^g)+b[7]-155497632|0),d=(d<<16|d>>>16)+k|0,g=g+((d^k^c)+b[10]-1094730640|0),g=(g<<23|g>>>9)+d|0,c=c+((g^d^k)+b[13]+681279174|0),c=(c<<4|c>>>28)+g|0,k=k+((c^g^d)+b[0]-358537222|0),k=(k<<11|k>>>21)+c|0,d=d+((k^c^g)+b[3]-722521979|0),d=(d<<16|d>>>16)+k|0,g=g+((d^k^c)+b[6]+76029189|0),g=(g<<23|g>>>9)+d|0,c=c+((g^d^k)+b[9]-640364487|0),c=(c<<4|c>>>28)+g|0,k=
k+((c^g^d)+b[12]-421815835|0),k=(k<<11|k>>>21)+c|0,d=d+((k^c^g)+b[15]+530742520|0),d=(d<<16|d>>>16)+k|0,g=g+((d^k^c)+b[2]-995338651|0),g=(g<<23|g>>>9)+d|0,c=c+((d^(g|~k))+b[0]-198630844|0),c=(c<<6|c>>>26)+g|0,k=k+((g^(c|~d))+b[7]+1126891415|0),k=(k<<10|k>>>22)+c|0,d=d+((c^(k|~g))+b[14]-1416354905|0),d=(d<<15|d>>>17)+k|0,g=g+((k^(d|~c))+b[5]-57434055|0),g=(g<<21|g>>>11)+d|0,c=c+((d^(g|~k))+b[12]+1700485571|0),c=(c<<6|c>>>26)+g|0,k=k+((g^(c|~d))+b[3]-1894986606|0),k=(k<<10|k>>>22)+c|0,d=d+((c^(k|~g))+
b[10]-1051523|0),d=(d<<15|d>>>17)+k|0,g=g+((k^(d|~c))+b[1]-2054922799|0),g=(g<<21|g>>>11)+d|0,c=c+((d^(g|~k))+b[8]+1873313359|0),c=(c<<6|c>>>26)+g|0,k=k+((g^(c|~d))+b[15]-30611744|0),k=(k<<10|k>>>22)+c|0,d=d+((c^(k|~g))+b[6]-1560198380|0),d=(d<<15|d>>>17)+k|0,g=g+((k^(d|~c))+b[13]+1309151649|0),g=(g<<21|g>>>11)+d|0,c=c+((d^(g|~k))+b[4]-145523070|0),c=(c<<6|c>>>26)+g|0,k=k+((g^(c|~d))+b[11]-1120210379|0),k=(k<<10|k>>>22)+c|0,d=d+((c^(k|~g))+b[2]+718787259|0),d=(d<<15|d>>>17)+k|0,g=g+((k^(d|~c))+b[9]-
343485551|0);a[0]=c+a[0]|0;a[1]=((g<<21|g>>>11)+d|0)+a[1]|0;a[2]=d+a[2]|0;a[3]=k+a[3]|0},d=[],c=function(){this._dataLength=0;this._state=new Int32Array(4);this._buffer=new ArrayBuffer(68);this._bufferLength=0;this._buffer8=new Uint8Array(this._buffer,0,68);this._buffer32=new Uint32Array(this._buffer,0,17);this.start()},e=new Int32Array([1732584193,-271733879,-1732584194,271733878]),f=new Int32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);c.prototype.appendStr=function(a){for(var c=this._buffer8,d=this._buffer32,
g=this._bufferLength,f,k=0;k<a.length;k++){f=a.charCodeAt(k);if(128>f)c[g++]=f;else{if(2048>f)c[g++]=(f>>>6)+192;else{if(55296>f||56319<f)c[g++]=(f>>>12)+224;else{f=1024*(f-55296)+(a.charCodeAt(++k)-56320)+65536;if(1114111<f)throw"Unicode standard supports code points up to U+10FFFF";c[g++]=(f>>>18)+240;c[g++]=f>>>12&63|128}c[g++]=f>>>6&63|128}c[g++]=f&63|128}64<=g&&(this._dataLength+=64,b(this._state,d),g-=64,d[0]=d[16])}this._bufferLength=g;return this};c.prototype.appendAsciiStr=function(a){for(var c=
this._buffer8,d=this._buffer32,g=this._bufferLength,f,k=0;;){for(f=Math.min(a.length-k,64-g);f--;)c[g++]=a.charCodeAt(k++);if(64>g)break;this._dataLength+=64;b(this._state,d);g=0}this._bufferLength=g;return this};c.prototype.appendByteArray=function(a){for(var c=this._buffer8,d=this._buffer32,g=this._bufferLength,f,k=0;;){for(f=Math.min(a.length-k,64-g);f--;)c[g++]=a[k++];if(64>g)break;this._dataLength+=64;b(this._state,d);g=0}this._bufferLength=g;return this};c.prototype.start=function(){this._bufferLength=
this._dataLength=0;this._state.set(e);return this};c.prototype.end=function(a){var c=this._bufferLength;this._dataLength+=c;var e=this._buffer8;e[c]=128;e[c+1]=e[c+2]=e[c+3]=0;var e=this._buffer32,g=(c>>2)+1;e.set(f.subarray(g),g);55<c&&(b(this._state,e),e.set(f));c=8*this._dataLength;4294967295>=c?e[14]=c:(g=c.toString(16).match(/(.*?)(.{0,8})$/),c=parseInt(g[2],16),g=parseInt(g[1],16)||0,e[14]=c,e[15]=g);b(this._state,e);if(a)a=this._state;else{a=this._state;for(var h=0;4>h;h++)for(c=8*h,e=a[h],
g=0;8>g;g+=2)d[c+1+g]="0123456789abcdef".charAt(e&15),e>>>=4,d[c+0+g]="0123456789abcdef".charAt(e&15),e>>>=4;a=d.join("")}return a};var h=new c;c.hashStr=function(a,b){return h.start().appendStr(a).end(b)};c.hashAsciiStr=function(a,b){return h.start().appendAsciiStr(a).end(b)};"5d41402abc4b2a76b9719d911017c592"!==c.hashStr("hello")&&console.error("YaMD5> this javascript engine does not support YaMD5. Sorry.");"object"===typeof a&&(a.YaMD5=c);return c})(this);
(function(){self.vAPI=self.vAPI||{};var a=self.chrome,b=self.vAPI;b.download=function(a){if(a.url){var b=document.createElement("a");b.href=a.url;b.setAttribute("download",a.filename||"");b.dispatchEvent(new MouseEvent("click"))}};b.insertHTML=function(a,b){a.innerHTML=b};b.getURL=a.runtime.getURL;b.i18n=a.i18n.getMessage;(function(a){document.body.setAttribute("dir",-1!==["ar","he","fa","ps","ur"].indexOf(a)?"rtl":"ltr")})(b.i18n("@@ui_locale"));b.closePopup=function(){window.open("","_self").close()};
b.localStorage=window.localStorage;b.newTabUrl="chrome://newtab";b.changeHomePage=function(){}})();
(function(){var a=self.vAPI=self.vAPI||{},b=self.chrome,d=b.runtime.getManifest();a.chrome=!0;var c=function(){};a.app={name:d.name,version:d.version};b.runtime?b.runtime.onMessage||(b.runtime.onMessage=b.extension.onMessage,b.runtime.sendMessage=b.extension.sendMessage,b.runtime.onConnect=b.extension.onConnect,b.runtime.connect=b.extension.connect):b.runtime=b.extension;a.app.restart=function(){b.runtime.reload()};a.storage=b.storage.local;a.storage.preferences=a.storage;a.tabs={};a.isBehindTheSceneTabId=
function(a){return"-1"===a.toString()};a.noTabId="-1";var e=function(a){"string"===typeof a&&(a=parseInt(a,10));return"number"!==typeof a||isNaN(a)||-1===a?0:a};a.tabs.registerListeners=function(){var d=this.onNavigation||c,f=this.onPopup||c,e=this.onUpdated||c,g=this.onClosed||c,h=Object.create(null),k=function(a){this.targetTabId=a.tabId.toString();this.openerTabId=a.sourceTabId.toString();this.targetURL=a.url;this.selfDestructionTimer=null};k.prototype.selfDestruct=function(){null!==this.selfDestructionTimer&&
clearTimeout(this.selfDestructionTimer);delete h[this.targetTabId]};k.prototype.launchSelfDestruction=function(){null!==this.selfDestructionTimer&&clearTimeout(this.selfDestructionTimer);this.selfDestructionTimer=setTimeout(this.selfDestruct.bind(this),1E4)};var q=function(a){var b=h[a.tabId];if(void 0!==b&&(b.targetURL=a.url,!0===f(b)))return b.selfDestruct(),!0},l=/^https?:\/\//;b.webNavigation.onCreatedNavigationTarget.addListener(function(a){!1===l.test(a.url)&&(a.frameId=0,d(a));void 0===h[a.tabId]&&
(h[a.tabId]=new k(a));q(a)});b.webNavigation.onBeforeNavigate.addListener(function(a){0===a.frameId&&q(a)});b.webNavigation.onCommitted.addListener(function(b){0===b.frameId&&(d(b),delete a.iconStateForTabId[b.tabId],!0!==q(b)&&(b=h[b.tabId],b instanceof k&&b.launchSelfDestruction()))});b.tabs.onUpdated.addListener(function(b,c,d){if("chrome://newtab/"==d.url)a.tabs.onNewTab(d);c.url&&q({tabId:b,url:c.url})||e(b,c,d)});b.tabs.onRemoved.addListener(function(b){delete a.iconStateForTabId[b];g(b)})};
a.tabs.get=function(a,c){var d=function(a){c(a)};null!==a?(a=e(a),0===a?c(null):b.tabs.get(a,d)):b.tabs.query({active:!0,currentWindow:!0},function(a){c(a[0])})};a.tabs.open=function(c){var d=c.url;if("string"!==typeof d||""===d)return null;!0!==/^[\w-]{2,}:/.test(d)&&(d=a.getURL(d));var f=function(){void 0===c.active&&(c.active=!0);var g=function(){var g={url:d,active:!!c.active},k=function(a){a.active&&b.windows.update(a.windowId,{focused:!0})};c.tabId?b.tabs.update(e(c.tabId),g,function(d){a.lastError()?
b.tabs.create(g,k):void 0!==c.index&&b.tabs.move(d.id,{index:c.index})}):(void 0!==c.index&&(g.index=c.index),b.tabs.create(g,k))};-1!==c.index?g():a.tabs.get(null,function(a){a?c.index=a.index+1:delete c.index;g()})};c.select?b.tabs.query({url:d},function(a){(a=a[0])?b.tabs.update(a.id,{active:!0},function(a){b.windows.update(a.windowId,{focused:!0})}):f()}):f()};a.tabs.replace=function(c,d){c=e(c);if(0!==c){var f=d;!0!==/^[\w-]{2,}:/.test(f)&&(f=a.getURL(f));b.tabs.update(c,{url:f},function(){})}};
a.tabs.remove=function(a){a=e(a);0!==a&&b.tabs.remove(a,function(){})};a.tabs.reload=function(a){a=e(a);0!==a&&b.tabs.reload(a,function(){})};a.tabs.injectScript=function(a,c,d){var g=function(){"function"===typeof d&&d()};a?b.tabs.executeScript(e(a),c,g):b.tabs.executeScript(c,g)};a.iconStateForTabId={};var f={whitelist:{38:"img/browsericons/intentlyLogoWhite38.png",19:"img/browsericons/intentlyLogoWhite19.png"},active:{38:"img/browsericons/intentlyLogoActive38.png",19:"img/browsericons/intentlyLogoActive19.png"},
off:{38:"img/browsericons/intentlyLogoRed38.png",19:"img/browsericons/intentlyLogoRed19.png"},init:{38:"img/browsericons/intentlyLogoInit38.png",19:"img/browsericons/intentlyLogoInit19.png"}};a.setIntentlyIcon=function(c,d){var e=d.status,g=d.badge,h=d.label;c=a.tabs.toChromiumTabId(c);0!==c&&(b.browserAction.setIcon({tabId:c,path:f[e]},function(){a.lastError()||b.browserAction.setBadgeText({tabId:c,text:g})}),b.browserAction.setTitle({tabId:c,title:h}))};a.messaging={ports:{},listeners:{},defaultHandler:null,
NOOPFUNC:c,UNHANDLED:"vAPI.messaging.notHandled"};a.messaging.listen=function(a,b){this.listeners[a]=b};a.messaging.onPortMessage=function(b,c){var d=a.messaging.NOOPFUNC;void 0!==b.requestId&&(d=h.factory(c,b).callback);var g=a.messaging.UNHANDLED,f=a.messaging.listeners[b.channelName];"function"===typeof f&&(g=f(b.msg,c.sender,d));g===a.messaging.UNHANDLED&&(g=a.messaging.defaultHandler(b.msg,c.sender,d),g===a.messaging.UNHANDLED&&(console.error("µBlock> messaging > unknown request: %o",b),d()))};
a.messaging.onPortDisconnect=function(b){b.onDisconnect.removeListener(a.messaging.onPortDisconnect);b.onMessage.removeListener(a.messaging.onPortMessage);delete a.messaging.ports[b.name]};a.messaging.onPortConnect=function(b){b.onDisconnect.addListener(a.messaging.onPortDisconnect);b.onMessage.addListener(a.messaging.onPortMessage);a.messaging.ports[b.name]=b};a.messaging.setup=function(c){null===this.defaultHandler&&("function"!==typeof c&&(c=function(){return a.messaging.UNHANDLED}),this.defaultHandler=
c,b.runtime.onConnect.addListener(this.onPortConnect))};a.messaging.broadcast=function(a){a={broadcast:!0,msg:a};for(var b in this.ports)!1!==this.ports.hasOwnProperty(b)&&this.ports[b].postMessage(a)};var h=function(b,c){this.callback=this.proxy.bind(this);this.messaging=a.messaging;this.init(b,c)};h.junkyard=[];h.factory=function(a,b){var c=h.junkyard.pop();return c?(c.init(a,b),c):new h(a,b)};h.prototype.init=function(a,b){this.port=a;this.request=b};h.prototype.proxy=function(a){this.port&&(this.messaging.ports.hasOwnProperty(this.port.name)&&
this.port.postMessage({requestId:this.request.requestId,channelName:this.request.channelName,msg:void 0!==a?a:null}),this.port=this.request=null,h.junkyard.push(this))};a.net={};a.net.registerListeners=function(){var a=\u00b5Block.URI,c=function(b){a.set(b.url);b.tabId=b.tabId.toString();b.hostname=a.hostnameFromURI(b.url);if("other"===b.type){var c=a.path.slice(-6),d=c.lastIndexOf(".");-1===d?b.type="object":(c=c.slice(d)+".",-1!==".eot.ttf.otf.svg.woff.woff2.".indexOf(c)?b.type="font":-1!==".ico.png.gif.jpg.jpeg.webp.".indexOf(c)?
b.type="image":b.type="object")}},d=this.onBeforeRequest.callback;b.webRequest.onBeforeRequest.addListener(function(a){c(a);return d(a)},{urls:this.onBeforeRequest.urls||["<all_urls>"],types:this.onBeforeRequest.types||[]},this.onBeforeRequest.extra);var g=this.onHeadersReceived.callback;b.webRequest.onHeadersReceived.addListener(function(a){c(a);return g(a)},{urls:this.onHeadersReceived.urls||["<all_urls>"],types:this.onHeadersReceived.types||[]},this.onHeadersReceived.extra)};a.contextMenu={menus:[],
handleContextMenu:function(b,c){var d=a.contextMenu.getMenuIndex(b.menuItemId);-1<d&&(d=a.contextMenu.menus[d].callback)&&"function"===typeof d&&d(b,c)},create:function(c,d){c.isParent&&delete c.isParent;var f=b.contextMenus.create(c);a.contextMenu.menus.push({callback:d,details:c,id:f})},removeAll:function(){a.contextMenu.menus=[];b.contextMenus.removeAll(function(){})},getMenuIndex:function(b){for(var c=0;c<a.contextMenu.menus.length;c++)if(a.contextMenu.menus[c].details.id==b)return c;return-1},
disabledmenus:[],getDisabledMenuIndex:function(b){for(var c=0;c<a.contextMenu.disabledmenus.length;c++)if(a.contextMenu.disabledmenus[c].details.id==b)return c;return-1},hide:function(b){var c=a.contextMenu.getMenuIndex(b);-1<c&&(a.contextMenu.disabledmenus.push(a.contextMenu.menus[c]),this.remove(b))},show:function(b){b=this.getDisabledMenuIndex(b);if(-1<b){var c=a.contextMenu.disabledmenus[b];a.contextMenu.create(c.details,c.callback);a.contextMenu.disabledmenus.splice(b,1)}},changeLabel:function(b,
c){var d=a.contextMenu.getMenuIndex(b);if(-1<d){var g=a.contextMenu.menus[d],d=g.details;d.title=c;g=g.callback;a.contextMenu.remove(b);a.contextMenu.create(d,g)}},remove:function(c){c=a.contextMenu.getMenuIndex(c);if(-1<c){var d=a.contextMenu.menus[c].details;b.contextMenus.onClicked.removeListener(a.contextMenu.menus[c].callback);b.contextMenus.remove(d.id);a.contextMenu.menus.splice(c,1)}}};b.contextMenus.onClicked.addListener(a.contextMenu.handleContextMenu);a.lastError=function(){return b.runtime.lastError};
a.onLoadAllCompleted=function(){var c=function(){a.lastError()},d=function(b){a.lastError()||a.tabs.injectScript(b,{file:"js/contentscript-end.js",allFrames:!0,runAt:"document_idle"},function(){a.tabs.injectScript(b,{file:"js/intently-content.js",allFrames:!0,runAt:"document_idle"},c)})},f=function(b){a.tabs.injectScript(b,{file:"js/vapi-client.js",allFrames:!0,runAt:"document_start"},function(){});a.tabs.injectScript(b,{file:"js/intently-utils.js",allFrames:!0,runAt:"document_start"},function(){a.tabs.injectScript(b,
{file:"js/intently-conf.js",allFrames:!0,runAt:"document_start"},function(){a.tabs.injectScript(b,{file:"js/intently-client.js",allFrames:!0,runAt:"document_start"},function(){a.tabs.injectScript(b,{file:"js/contentscript-start.js",allFrames:!0,runAt:"document_start"},function(){d(b)})})})})},g=function(a){for(var b=\u00b5Block,c=a.length,d;c--;)d=a[c],b.tabContextManager.commit(d.id,d.url),b.bindTabToPageStats(d.id),f(d.id)};b.tabs.query({url:"http://*/*"},g);b.tabs.query({url:"https://*/*"},g)};
a.punycodeHostname=function(a){return a};a.punycodeURL=function(a){return a}})();
var \u00b5Block=function(){return{userSettings:{advancedUserEnabled:!1,autoUpdate:!0,collapseBlocked:!0,contextMenuEnabled:!0,dynamicFilteringEnabled:!1,experimentalEnabled:!1,externalLists:"! Examples:\n! https://easylist-downloads.adblockplus.org/antiadblockfilters.txt\n! https://easylist-downloads.adblockplus.org/fb_annoyances_full.txt\n! https://easylist-downloads.adblockplus.org/fb_annoyances_sidebar.txt\n! https://easylist-downloads.adblockplus.org/fb_annoyances_newsfeed.txt\n! https://easylist-downloads.adblockplus.org/yt_annoyances_full.txt\n! https://easylist-downloads.adblockplus.org/yt_annoyances_comments.txt\n! https://easylist-downloads.adblockplus.org/yt_annoyances_suggestions.txt\n! https://easylist-downloads.adblockplus.org/yt_annoyances_other.txt",firewallPaneMinimized:!0,
parseAllABPHideFilters:!0,requestLogMaxEntries:1E3,showIconBadge:!0},netWhitelist:{},netWhitelistModifyTime:0,netWhitelistDefault:"about-scheme\nbehind-the-scene\nchrome-extension-scheme\nchrome-scheme\nloopconversation.about-scheme\nopera-scheme".trim(),userFiltersPath:"assets/user/filters.txt",localSettings:{blockedRequestCount:0,allowedRequestCount:0},localSettingsModifyTime:0,localSettingsSaveTime:0,systemSettings:{compiledMagic:"eopszukpnrct",selfieMagic:"menhiasrxfed"},restoreBackupSettings:{lastRestoreFile:"",
lastRestoreTime:0,lastBackupFile:"",lastBackupTime:0},updateAssetsEvery:3492E5,projectServerRoot:"https://raw.githubusercontent.com/chrisaljoudi/uBlock/master/",pslPath:"assets/thirdparties/publicsuffix.org/list/effective_tld_names.dat",permanentLists:{"assets/user/filters.txt":{group:"default"},"assets/ublock/filters.txt":{title:"uBlock filters",group:"default"},"assets/ublock/privacy.txt":{title:"uBlock filters – Privacy",group:"default"}},remoteBlacklists:{},selfieAfter:138E4,pageStores:{},storageQuota:vAPI.storage.QUOTA_BYTES,
storageUsed:0,noopFunc:function(){},apiErrorCount:0,contextMenuClientX:-1,contextMenuClientY:-1,epickerTarget:null,epickerEprom:null,dummy:0}}();"use strict";
\u00b5Block.asyncJobs=function(){var a=function(){c.process()},b=function(a){this.name=a;this.callback=this.data=null;this.period=this.when=0};b.prototype.destroy=function(){this.name="";this.callback=this.data=null};var d=function(){this.timeResolution=200;this.jobs={};this.jobCount=0;this.jobJunkyard=[];this.timerId=null;this.timerWhen=Number.MAX_VALUE};d.prototype.restartTimer=function(){var c=Number.MAX_VALUE,d=this.jobs,h,m;for(m in d)h=d[m],h instanceof b&&h.when<c&&(c=h.when);c=Math.floor((c+
this.timeResolution-1)/this.timeResolution)*this.timeResolution;c<this.timerWhen&&(clearTimeout(this.timerId),this.timerWhen=c,this.timerId=setTimeout(a,Math.max(c-Date.now(),10)))};d.prototype.add=function(a,c,d,m,n){var p=this.jobs[a];p||((p=this.jobJunkyard.pop())?p.name=a:p=new b(a),this.jobs[a]=p,this.jobCount++);p.data=c;p.callback=d;p.when=Date.now()+m;p.period=n?m:0;this.restartTimer()};d.prototype.remove=function(a){if(!1!==this.jobs.hasOwnProperty(a)){var b=this.jobs[a];delete this.jobs[a];
b.destroy();this.jobCount--;this.jobJunkyard.push(b);this.restartTimer()}};d.prototype.process=function(){this.timerId=null;this.timerWhen=Number.MAX_VALUE;var a=Date.now(),b,c;for(c in this.jobs)!1!==this.jobs.hasOwnProperty(c)&&(b=this.jobs[c],b.when>a||(b.callback(b.data),b.period?b.when=a+b.period:(delete this.jobs[c],b.destroy(),this.jobCount--,this.jobJunkyard.push(b))));this.restartTimer()};var c=new d;return c}();
\u00b5Block.updateContextAsync=function(){var a={},b=function(b){delete a[b];extension.intentlyContextMenus.updateContext(b)};return function(d){vAPI.isBehindTheSceneTabId(d)||a.hasOwnProperty(d)||(a[d]=setTimeout(b.bind(null,d),500))}}();\u00b5Block.updateBadgeAsync=function(){var a={},b=function(b){delete a[b];vAPI.tabs.get(null,function(a){a&&extension.updateBadge(a)})};return function(d){vAPI.isBehindTheSceneTabId(d)||a.hasOwnProperty(d)||(a[d]=setTimeout(b.bind(null,d),500))}}();"use strict";
\u00b5Block.utils=function(){return{formatCount:function(a){if("number"!==typeof a)return"";var b=a.toFixed(0);1E3<=a&&(b=1E4>a?">"+b.slice(0,1)+"k":1E5>a?b.slice(0,2)+"k":1E6>a?b.slice(0,3)+"k":1E7>a?b.slice(0,1)+"M":b.slice(0,-6)+"M");return b}}}();
\u00b5Block.URI=function(){var a=/^([^:\/?#]+:)?(\/\/[^\/?#]*)?([^?#]*)(\?[^#]*)?(#.*)?/,b=/^[^:\/?#]+:/,d=/^(?:[^:\/?#]+:)?(\/\/[^\/?#]+)/,c=/^https?:\/\/([0-9a-z_][0-9a-z._-]*[0-9a-z])\//,e=/^(?:[^@]*@)?([0-9a-z._-]*)(:\d*)?$/i,f=/^(?:[^@]*@)?(\[[0-9a-f:]*\])(:\d*)?$/i,h=/^[0-9a-z._-]+[0-9a-z]$/i,m=/^(?:[^@]*@)?([0-9a-z._-]+)(?::\d*)?$/i,n=/^(?:[^@]*@)?(\[[0-9a-f:]+\])(?::\d*)?$/i,p=/^([a-z\d]+(-*[a-z\d]+)*)(\.[a-z\d]+(-*[a-z\d])*)*$/,g=/^\d+\.\d+\.\d+\.\d+$|^\[[\da-zA-Z:]+\]$/,r=function(a){a.scheme=
"";a.hostname="";a._ipv4=void 0;a._ipv6=void 0;a.port="";a.path="";a.query="";a.fragment="";return a},k={scheme:"",authority:"",hostname:"",_ipv4:void 0,_ipv6:void 0,port:"",domain:void 0,path:"",query:"",fragment:"",schemeBit:1,userBit:2,passwordBit:4,hostnameBit:8,portBit:16,pathBit:32,queryBit:64,fragmentBit:128,allBits:65535};k.authorityBit=k.userBit|k.passwordBit|k.hostnameBit|k.portBit;k.normalizeBits=k.schemeBit|k.hostnameBit|k.pathBit|k.queryBit;k.set=function(b){if(void 0===b)return r(k);
b=a.exec(b);if(!b)return r(k);this.scheme=void 0!==b[1]?b[1].slice(0,-1):"";this.authority=void 0!==b[2]?b[2].slice(2).toLowerCase():"";this.path=void 0!==b[3]?b[3]:"";""!==this.authority&&""===this.path&&(this.path="/");this.query=void 0!==b[4]?b[4].slice(1):"";this.fragment=void 0!==b[5]?b[5].slice(1):"";if(h.test(this.authority))return this.hostname=this.authority,this.port="",this;b=e.exec(this.authority);if(!b&&(b=f.exec(this.authority),!b))return k.hostname="",k._ipv4=void 0,k._ipv6=void 0,
k.port="",k;this.hostname=void 0!==b[1]?b[1]:"";"."===this.hostname.slice(-1)&&(this.hostname=this.hostname.slice(0,-1));this.port=void 0!==b[2]?b[2].slice(1):"";return this};k.assemble=function(a){void 0===a&&(a=this.allBits);var b=[];this.scheme&&a&this.schemeBit&&b.push(this.scheme,":");this.hostname&&a&this.hostnameBit&&b.push("//",this.hostname);this.port&&a&this.portBit&&b.push(":",this.port);this.path&&a&this.pathBit&&b.push(this.path);this.query&&a&this.queryBit&&b.push("?",this.query);this.fragment&&
a&this.fragmentBit&&b.push("#",this.fragment);return b.join("")};k.schemeFromURI=function(a){return(a=b.exec(a))?a[0].slice(0,-1).toLowerCase():""};k.authorityFromURI=function(a){return(a=d.exec(a))?a[1].slice(2).toLowerCase():""};k.hostnameFromURI=function(a){var b=c.exec(a);if(b)return b[1];b=d.exec(a);if(!b)return"";a=b[1].slice(2);if(h.test(a))return a.toLowerCase();b=m.exec(a);if(!b&&(b=n.exec(a),!b))return"";b=b[1];"."===b.slice(-1)&&(b=b.slice(0,-1));return b.toLowerCase()};k.domainFromHostname=
function(a){return v.hasOwnProperty(a)?(a=v[a],a.tstamp=Date.now(),a.domain):!1===g.test(a)?t(a,q.getDomain(a)):t(a,a)};k.domain=function(){return this.domainFromHostname(this.hostname)};var q=publicSuffixList,l=function(a){this.init(a)};l.prototype.init=function(a){this.domain=a;this.tstamp=Date.now();return this};l.prototype.dispose=function(){this.domain="";25>u.length&&u.push(this)};var u=[],t=function(a,b){if(v.hasOwnProperty(a))v[a].tstamp=Date.now();else{var c=v,d;d=(d=u.pop())?d.init(b):new l(b);
c[a]=d;x+=1;if(x===H){c=Object.keys(v).sort(w).slice(y);d=c.length;x-=d;for(var k;d--;)k=c[d],v[k].dispose(),delete v[k]}}return b},w=function(a,b){return b.tstamp-a.tstamp},v={},x=0,y=75,H=100;q.onChanged.addListener(function(){v={};x=0});k.domainFromURI=function(a){return a?this.domainFromHostname(this.hostnameFromURI(a)):""};k.normalizedURI=function(){return this.assemble(this.normalizeBits)};k.rootURL=function(){return this.hostname?this.assemble(this.schemeBit|this.hostnameBit):""};k.isValidHostname=
function(a){var b;try{b=p.test(a)}catch(c){return!1}return b};k.parentHostnameFromHostname=function(a){var b=this.domainFromHostname(a);return""===b||b===a?void 0:a.slice(a.indexOf(".")+1)};k.parentHostnamesFromHostname=function(a){var b=this.domainFromHostname(a);if(""===b||b===a)return[];for(var c=[],d;;){d=a.indexOf(".");if(0>d)break;a=a.slice(d+1);c.push(a);if(a===b)break}return c};k.allHostnamesFromHostname=function(a){var b=this.parentHostnamesFromHostname(a);b.unshift(a);return b};k.toString=
function(){return this.assemble()};return k}();
\u00b5Block.Firewall=function(){var a=function(){this.reset()},b={"3p":!0,image:!0,"inline-script":!0,"1p-script":!0,"3p-script":!0,"3p-frame":!0},d={"*":0,"inline-script":2,"1p-script":4,"3p-script":6,"3p-frame":8,image:10,"3p":12},c={1:"block",2:"allow",3:"noop"},e={block:1,allow:2,noop:3},f=/[g-z_-]/,h=/\.\d+$/,m=/[^0-9a-z_.\[\]:-]/,n=function(a){if("*"===a)return"";var b;b=f.test(a)?!1:h.test(a)?!0:"["===a.charAt(0);if(b)return"*";b=a.indexOf(".");return-1===b?"*":a.slice(b+1)};a.toBroaderHostname=
n;a.prototype.reset=function(){this.r=0;this.z=this.y=this.type="";this.rules={}};a.prototype.assign=function(a){var b=this.rules;a=a.rules;for(var c in b)!1!==b.hasOwnProperty(c)&&!1===a.hasOwnProperty(c)&&delete b[c];for(c in a)!1!==a.hasOwnProperty(c)&&(b[c]=a[c])};a.prototype.copyRules=function(a,b,c){var d=this.rules;a=a.rules;var f,e;e=a["* *"]||0;0!==e?d["* *"]=e:delete d["* *"];f=b+" *";e=a[f]||0;0!==e?d[f]=e:delete d[f];for(var h in c)!1!==c.hasOwnProperty(h)&&(f="* "+h,e=a[f]||0,0!==e?d[f]=
e:delete d[f],f=b+" "+h,e=a[f]||0,0!==e?d[f]=e:delete d[f]);return!0};a.prototype.hasSameRules=function(a,b,c){var d=this.rules;a=a.rules;var f;f="* *";if(d[f]!==a[f])return!1;f=b+" *";if(d[f]!==a[f])return!1;for(var e in c)if(!1!==c.hasOwnProperty(e)){f="* "+e;if(d[f]!==a[f])return!1;f=b+" "+e;if(d[f]!==a[f])return!1}return!0};a.prototype.setCell=function(a,b,c,f){c=d[c];a=a+" "+b;b=this.rules[a];void 0===b&&(b=0);f=b&~(3<<c)|f<<c;if(f===b)return!1;0===f?delete this.rules[a]:this.rules[a]=f;return!0};
a.prototype.unsetCell=function(a,b,c){this.evaluateCellZY(a,b,c);if(0===this.r)return!1;this.setCell(a,b,c,0);return!0};a.prototype.setCellZ=function(a,b,c,d){this.evaluateCellZY(a,b,c);if(this.r===d)return!1;this.setCell(a,b,c,0);this.evaluateCellZY(a,b,c);if(this.r===d)return!0;this.setCell(a,b,c,d);return!0};a.prototype.blockCell=function(a,b,c){return this.setCellZ(a,b,c,1)};a.prototype.allowCell=function(a,b,c){return this.setCellZ(a,b,c,2)};a.prototype.evaluateCell=function(a,b,c){a=this.rules[a+
" "+b];return void 0===a?0:a>>d[c]&3};a.prototype.clearRegisters=function(){this.r=0;this.type=this.y=this.z="";return this};var p=\u00b5Block.URI.domainFromHostname;a.prototype.evaluateCellZ=function(a,b,c){this.type=c;c=d[c];for(var f;;){this.z=a;f=this.rules[a+" "+b];if(void 0!==f&&(f=f>>c&3,0!==f))return this.r=f;a=n(a);if(""===a)break}return this.r=0};a.prototype.evaluateCellZY=function(a,c,d){for(var f=c;"*"!==f;){this.y=f;if(0!==this.evaluateCellZ(a,f,"*"))return this;f=n(f)}"*"===c||"*"===
a||""===a?c=!1:(f=p(a)||a,c=c.slice(0-f.length)!==f?!0:c.length!==f.length&&"."!==c.charAt(c.length-f.length-1));this.y="*";if(c){if("script"===d){if(0!==this.evaluateCellZ(a,"*","3p-script"))return this}else if("sub_frame"===d&&0!==this.evaluateCellZ(a,"*","3p-frame"))return this;if(0!==this.evaluateCellZ(a,"*","3p"))return this}else if("script"===d&&0!==this.evaluateCellZ(a,"*","1p-script"))return this;if(b.hasOwnProperty(d)&&0!==this.evaluateCellZ(a,"*",d)||0!==this.evaluateCellZ(a,"*","*"))return this;
this.type="";return this};a.prototype.mustAllowCellZY=function(a,b,c){return 2===this.evaluateCellZY(a,b,c).r};a.prototype.mustBlockOrAllow=function(){return 1===this.r||2===this.r};a.prototype.mustBlock=function(){return 1===this.r};a.prototype.mustAbort=function(){return 3===this.r};a.prototype.toFilterString=function(){return""===this.type?"":1===this.r?"db:"+this.z+" "+this.y+" "+this.type+" block":2===this.r?"da:"+this.z+" "+this.y+" "+this.type+" allow":3===this.r?"dn:"+this.z+" "+this.y+" "+
this.type+" noop":""};a.prototype.srcHostnameFromRule=function(a){return a.slice(0,a.indexOf(" "))};a.prototype.desHostnameFromRule=function(a){return a.slice(a.indexOf(" ")+1)};a.prototype.toString=function(){var a=[],b,f,e,l,h;for(b in this.rules)if(!1!==this.rules.hasOwnProperty(b))for(f in l=this.srcHostnameFromRule(b),h=this.desHostnameFromRule(b),d)!1!==d.hasOwnProperty(f)&&(e=this.evaluateCell(l,h,f),0!==e&&a.push(punycode.toUnicode(l)+" "+punycode.toUnicode(h)+" "+f+" "+c[e]));return a.join("\n")};
a.prototype.fromString=function(a,b){var c=a.length,f=0,l,h,p,n;for(!0!==b&&this.reset();f<c;)l=a.indexOf("\n",f),0>l&&(l=a.indexOf("\r",f),0>l&&(l=c)),h=a.slice(f,l).trim(),f=l+1,l=h.indexOf("# "),-1!==l&&(h=h.slice(0,l).trim()),""!==h&&(p=h.split(/\s+/),4===p.length&&(h=punycode.toASCII(p[0]),l=punycode.toASCII(p[1]),"*"!==h&&m.test(h)||"*"!==l&&m.test(l)||(n=p[2],!1===d.hasOwnProperty(n)||"*"!==l&&"*"!==n||(p=e[p[3]],"number"!==typeof p||0>p||3<p||this.setCell(h,l,n,p)))))};a.prototype.fromObsoleteSelfie=
function(a){if(""===a)return"";var b={};try{b=JSON.parse(a)}catch(c){}a=b.filters;var d,f;for(f in a)!1!==a.hasOwnProperty(f)&&(b=a[f],d=b&3,1===d?this.setCell(f,"*","inline-script",1):2===d&&this.setCell(f,"*","inline-script",3),d=b>>2&3,1===d?this.setCell(f,"*","1p-script",1):2===d&&this.setCell(f,"*","1p-script",3),d=b>>4&3,1===d?this.setCell(f,"*","3p-script",1):2===d&&this.setCell(f,"*","3p-script",3),d=b>>8&3,1===d?this.setCell(f,"*","3p-frame",1):2===d&&this.setCell(f,"*","3p-frame",3))};a.prototype.toSelfie=
function(){return{magicId:"chmdgxwtetgu",rules:this.rules}};a.prototype.fromSelfie=function(a){this.rules=a.rules};return a}();\u00b5Block.sessionFirewall=new \u00b5Block.Firewall;\u00b5Block.permanentFirewall=new \u00b5Block.Firewall;
\u00b5Block.staticNetFilteringEngine=function(){var a=\u00b5Block,b={stylesheet:16,image:32,object:48,script:64,xmlhttprequest:80,sub_frame:96,other:112,"cosmetic-filtering":208,"inline-script":224,popup:240},d=b.other,c=(1<<(d>>>4))-1,e=/^[0-9a-z][0-9a-z.-]*[0-9a-z]$/,f=/[\/?#]/,h="",m="",n=JSON.stringify,p=JSON.parse,g=parseInt,r=function(a,b){if(b.slice(0-a.length)!==a)return!1;var c=b.charAt(b.length-a.length-1);return"."===c||""===c},k={match:{0:"",index:0},exec:function(a){this.match["0"]=a;
return this.match},test:function(){return!0}},q=function(a,b){if("*"===a)return k;var c=a.replace(/[.+?^${}()|[\]\\]/g,"\\$&").replace(/\*/g,".*");0>b?c="^"+c:0<b&&(c+=c+"$");return new RegExp(c)},l=function(a,b){this.s=a;this.tokenBeg=b};l.prototype.match=function(a,b){return a.substr(b-this.tokenBeg,this.s.length)===this.s};l.fid=l.prototype.fid="a";l.prototype.toString=function(){return this.s};l.prototype.toSelfie=function(){return this.s+"\t"+this.tokenBeg};l.compile=function(a){return a.f+"\t"+
a.tokenBeg};l.fromSelfie=function(a){var b=a.indexOf("\t"),c=a.slice(0,b);a=a.slice(b+1);a=g(a,10);return new l(c,a)};var u=function(a,b,c){this.s=a;this.tokenBeg=b;this.hostname=c};u.prototype.match=function(a,b){return h.slice(-this.hostname.length)===this.hostname&&a.substr(b-this.tokenBeg,this.s.length)===this.s};u.fid=u.prototype.fid="ah";u.prototype.toString=function(){return this.s+"$domain="+this.hostname};u.prototype.toSelfie=function(){return this.s+"\t"+this.tokenBeg+"\t"+this.hostname};
u.compile=function(a,b){return a.f+"\t"+a.tokenBeg+"\t"+b};u.fromSelfie=function(a){a=a.split("\t");return new u(a[0],g(a[1],10),a[2])};var t=function(a){this.s=a};t.prototype.match=function(a,b){return a.substr(b,this.s.length)===this.s};t.fid=t.prototype.fid="0a";t.prototype.toString=function(){return this.s};t.prototype.toSelfie=function(){return this.s};t.compile=function(a){return a.f};t.fromSelfie=function(a){return new t(a)};var w=function(a,b){this.s=a;this.hostname=b};w.prototype.match=function(a,
b){return h.slice(-this.hostname.length)===this.hostname&&a.substr(b,this.s.length)===this.s};w.fid=w.prototype.fid="0ah";w.prototype.toString=function(){return this.s+"$domain="+this.hostname};w.prototype.toSelfie=function(){return this.s+"\t"+this.hostname};w.compile=function(a,b){return a.f+"\t"+b};w.fromSelfie=function(a){var b=a.indexOf("\t");return new w(a.slice(0,b),a.slice(b+1))};var v=function(a){this.s=a};v.prototype.match=function(a,b){return a.substr(b-1,this.s.length)===this.s};v.fid=
v.prototype.fid="1a";v.prototype.toString=function(){return this.s};v.prototype.toSelfie=function(){return this.s};v.compile=function(a){return a.f};v.fromSelfie=function(a){return new v(a)};var x=function(a,b){this.s=a;this.hostname=b};x.prototype.match=function(a,b){return h.slice(-this.hostname.length)===this.hostname&&a.substr(b-1,this.s.length)===this.s};x.fid=x.prototype.fid="1ah";x.prototype.toString=function(){return this.s+"$domain="+this.hostname};x.prototype.toSelfie=function(){return this.s+
"\t"+this.hostname};x.compile=function(a,b){return a.f+"\t"+b};x.fromSelfie=function(a){var b=a.indexOf("\t");return new x(a.slice(0,b),a.slice(b+1))};var y=function(a){this.s=a};y.prototype.match=function(a){return a.slice(0,this.s.length)===this.s};y.fid=y.prototype.fid="|a";y.prototype.toString=function(){return"|"+this.s};y.prototype.toSelfie=function(){return this.s};y.compile=function(a){return a.f};y.fromSelfie=function(a){return new y(a)};var H=function(a,b){this.s=a;this.hostname=b};H.prototype.match=
function(a){return h.slice(-this.hostname.length)===this.hostname&&a.slice(0,this.s.length)===this.s};H.fid=H.prototype.fid="|ah";H.prototype.toString=function(){return"|"+this.s+"$domain="+this.hostname};H.prototype.toSelfie=function(){return this.s+"\t"+this.hostname};H.compile=function(a,b){return a.f+"\t"+b};H.fromSelfie=function(a){var b=a.indexOf("\t");return new H(a.slice(0,b),a.slice(b+1))};var I=function(a){this.s=a};I.prototype.match=function(a){return a.slice(-this.s.length)===this.s};
I.fid=I.prototype.fid="a|";I.prototype.toString=function(){return this.s+"|"};I.prototype.toSelfie=function(){return this.s};I.compile=function(a){return a.f};I.fromSelfie=function(a){return new I(a)};var J=function(a,b){this.s=a;this.hostname=b};J.prototype.match=function(a){return h.slice(-this.hostname.length)===this.hostname&&a.slice(-this.s.length)===this.s};J.fid=J.prototype.fid="a|h";J.prototype.toString=function(){return this.s+"|$domain="+this.hostname};J.prototype.toSelfie=function(){return this.s+
"\t"+this.hostname};J.compile=function(a,b){return a.f+"\t"+b};J.fromSelfie=function(a){var b=a.indexOf("\t");return new J(a.slice(0,b),a.slice(b+1))};var K=function(a){this.s=a};K.prototype.match=function(a,b){if(a.substr(b,this.s.length)!==this.s)return!1;var c=a.indexOf("://");return-1!==c&&!1===f.test(a.slice(c+3,b))};K.fid=K.prototype.fid="||a";K.prototype.toString=function(){return"||"+this.s};K.prototype.toSelfie=function(){return this.s};K.compile=function(a){return a.f};K.fromSelfie=function(a){return new K(a)};
var L=function(a,b){this.s=a;this.hostname=b};L.prototype.match=function(a,b){if(h.slice(-this.hostname.length)!==this.hostname||a.substr(b,this.s.length)!==this.s)return!1;var c=a.indexOf("://");return-1!==c&&!1===f.test(a.slice(c+3,b))};L.fid=L.prototype.fid="||ah";L.prototype.toString=function(){return"||"+this.s};L.prototype.toSelfie=function(){return this.s+"\t"+this.hostname};L.compile=function(a,b){return a.f+"\t"+b};L.fromSelfie=function(a){var b=a.indexOf("\t");return new L(a.slice(0,b),
a.slice(b+1))};var B=function(a,b){this.s=a;this.anchor=b;this.re=null};B.prototype.match=function(a){null===this.re&&(this.re=q(this.s,this.anchor));return this.re.test(a)};B.fid=B.prototype.fid="_";B.prototype.toString=function(){return 0===this.anchor?this.s:0>this.anchor?"|"+this.s:this.s+"|"};B.prototype.toSelfie=function(){return this.s+"\t"+this.anchor};B.compile=function(a){return a.f+"\t"+a.anchor};B.fromSelfie=function(a){var b=a.indexOf("\t");return new B(a.slice(0,b),parseInt(a.slice(b+
1),10))};var D=function(a,b,c){B.call(this,a,b);this.hostname=c};D.prototype=Object.create(B.prototype);D.prototype.constructor=D;D.prototype.match=function(a){return h.slice(-this.hostname.length)!==this.hostname?!1:B.prototype.match.call(this,a)};D.fid=D.prototype.fid="_h";D.prototype.toString=function(){return B.prototype.toString.call(this)+"$domain="+this.hostname};D.prototype.toSelfie=function(){return B.prototype.toSelfie.call(this)+"\t"+this.hostname};D.compile=function(a,b){return B.compile(a)+
"\t"+b};D.fromSelfie=function(a){a=a.split("\t");return new D(a[0],parseInt(a[1],10),a[2])};var E=function(a){this.s=a;this.re=null};E.prototype.match=function(a){null===this.re&&(this.re=q(this.s,0));if(!1===this.re.test(a))return!1;var b=this.re.exec(a),c=a.indexOf("://");return-1!==c&&!1===f.test(a.slice(c+3,b.index))};E.fid=E.prototype.fid="||_";E.prototype.toString=function(){return"||"+this.s};E.prototype.toSelfie=function(){return this.s};E.compile=function(a){return a.f};E.fromSelfie=function(a){return new E(a)};
var F=function(a,b){E.call(this,a);this.hostname=b};F.prototype=Object.create(E.prototype);F.prototype.constructor=F;F.prototype.match=function(a){return h.slice(-this.hostname.length)!==this.hostname?!1:E.prototype.match.call(this,a)};F.fid=F.prototype.fid="||_h";F.prototype.toString=function(){return"||"+this.s+"$domain="+this.hostname};F.prototype.toSelfie=function(){return this.s+"\t"+this.hostname};F.compile=function(a,b){return a.f+"\t"+b};F.fromSelfie=function(a){var b=a.indexOf("\t");return new F(a.slice(0,
b),a.slice(b+1))};var M=function(a){this.re=new RegExp(a)};M.prototype.match=function(a){return this.re.test(a)};M.fid=M.prototype.fid="//";M.prototype.toString=function(){return"/"+this.re.source+"/"};M.prototype.toSelfie=function(){return this.re.source};M.compile=function(a){return a.f};M.fromSelfie=function(a){return new M(a)};var C=function(a,b){this.re=new RegExp(a);this.hostname=b};C.prototype.match=function(a){return h.slice(-this.hostname.length)===this.hostname&&this.re.test(a)};C.fid=C.prototype.fid=
"//h";C.prototype.toString=function(){return"/"+this.re.source+"/$domain="+this.hostname};C.prototype.toSelfie=function(){return this.re.source+"\t"+this.hostname};C.compile=function(a,b){return a.f+"\t"+b};C.fromSelfie=function(a){var b=a.indexOf("\t");return new C(a.slice(0,b),a.slice(b+1))};var z=function(){this.h="";this.dict={};this.count=0};z.prototype.cutoff=250;z.prototype.meltBucket=function(a,b){var c={};if(" "===b.charAt(0))b.trim().split(" ").map(function(a){c[a]=!0});else for(var d=0;d<
b.length;)c[b.substr(d,a)]=!0,d+=a;return c};z.prototype.freezeBucket=function(a){a=Object.keys(a);return a[0].length*a.length<this.cutoff?" "+a.join(" ")+" ":a.sort().join("")};z.prototype.makeKey=function(a){var b=a.length;255<b&&(b=255);var c=b>>>3,d=b>>>2,f=b>>>1;return String.fromCharCode((a.charCodeAt(c)&1)<<14|(a.charCodeAt(d+c)&1)<<12|(a.charCodeAt(f)&1)<<11|(a.charCodeAt(f+c)&1)<<10|(a.charCodeAt(f+d+c)&1)<<8,b)};z.prototype.add=function(a){var b=this.makeKey(a),c=this.dict[b];if(void 0===
c)return c=this.dict[b]={},c[a]=!0,this.count+=1,!0;"string"===typeof c&&(c=this.dict[b]=this.meltBucket(a.length,c));if(c.hasOwnProperty(a))return!1;c[a]=!0;this.count+=1;return!0};z.prototype.freeze=function(){var a=this.dict,b,c;for(c in a)b=a[c],"object"===typeof b&&(a[c]=this.freezeBucket(b))};z.prototype.matchesExactly=function(a){var b=this.makeKey(a),c=this.dict[b];if(void 0===c)return!1;"object"===typeof c&&(c=this.dict[b]=this.freezeBucket(c));if(" "===c.charAt(0))return-1!==c.indexOf(" "+
a+" ");for(var b=a.length,d=0,f=c.length/b+.5|0,k,e;d<f;)if(k=d+f>>1,e=c.substr(b*k,b),a<e)f=k;else if(a>e)d=k+1;else return!0;return!1};z.prototype.match=function(){for(var a,b=m;!1===this.matchesExactly(b);){a=b.indexOf(".");if(-1===a)return this.h="",!1;b=b.slice(a+1)}this.h="||"+b+"^";return this};z.fid=z.prototype.fid="{h}";z.prototype.toString=function(){return this.h};z.prototype.toSelfie=function(){return JSON.stringify({count:this.count,dict:this.dict})};z.fromSelfie=function(a){var b=new z;
a=JSON.parse(a);b.count=a.count;b.dict=a.dict;return b};var G=function(a,b){this.promoted=0;this.vip=16;this.f=null;this.filters=[];void 0!==a&&(this.filters[0]=a,void 0!==b&&(this.filters[1]=b))};G.prototype.add=function(a){this.filters.push(a)};G.prototype.promote=function(a){for(var b=this.filters,c=b.length>>>1;a<c&&!(c>>>=1,c<this.vip););if(!(a<=c)){var c=this.promoted%c,d=b[c];b[c]=b[a];b[a]=d;this.promoted+=1}};G.prototype.match=function(a,b){for(var c=this.filters,d=c.length,f=0;f<d;f++)if(!1!==
c[f].match(a,b))return this.f=c[f],f>=this.vip&&this.promote(f),!0;return!1};G.prototype.fid="[]";G.prototype.toString=function(){return null!==this.f?this.f.toString():""};G.prototype.toSelfie=function(){return this.filters.length.toString()};G.fromSelfie=function(){return new G};var P=function(a){return a.isRegex?M:-1!==a.f.indexOf("*")||"*"===a.token?a.hostnameAnchored?E:B:0>a.anchor?y:0<a.anchor?I:a.hostnameAnchored?K:0===a.tokenBeg?t:1===a.tokenBeg?v:l},R=function(a){return a.isRegex?C:-1!==
a.f.indexOf("*")||"*"===a.token?a.hostnameAnchored?F:D:0>a.anchor?H:0<a.anchor?J:a.hostnameAnchored?L:0===a.tokenBeg?w:1===a.tokenBeg?x:u},N=function(){this.reHasWildcard=/[\^\*]/;this.reHasUppercase=/[A-Z]/;this.reCleanupHostname=/^\|\|[.*]*/;this.reIsolateHostname=/^([^\x00-\x24\x26-\x2C\x2F\x3A-\x5E\x60\x7B-\x7F]+)(.*)/;this.reHasUnicode=/[^\x00-\x7F]/;this.hostnames=[];this.notHostnames=[];this.reset()};N.prototype.toNormalizedType={stylesheet:"stylesheet",image:"image",object:"object","object-subrequest":"object",
script:"script",xmlhttprequest:"xmlhttprequest",subdocument:"sub_frame",other:"other",document:"main_frame",elemhide:"cosmetic-filtering","inline-script":"inline-script",popup:"popup"};N.prototype.reset=function(){this.anchor=this.action=0;this.elemHiding=!1;this.f="";this.firstParty=!1;this.fopts="";this.hostnamePure=this.hostnameAnchored=!1;this.hostnames.length=0;this.notHostnames.length=0;this.thirdParty=this.isRegex=!1;this.token="";this.important=this.types=this.tokenEnd=this.tokenBeg=0;this.unsupported=
!1;return this};N.prototype.parseOptType=function(a,d){var f=1<<(b[this.toNormalizedType[a]]>>>4)-1;d?(0===this.types&&(this.types=c),this.types&=~f):this.types|=f};N.prototype.parseOptParty=function(a){a?this.firstParty=!0:this.thirdParty=!0};N.prototype.parseOptHostnames=function(a){a=a.split("|");for(var b,c=0;c<a.length;c++)b=a[c],"~"===b.charAt(0)?this.notHostnames.push(b.slice(1)):this.hostnames.push(b)};N.prototype.parseOptions=function(a){this.fopts=a;a=a.split(",");for(var b,c,d=0;d<a.length;d++)if(b=
a[d],(c="~"===b.charAt(0))&&(b=b.slice(1)),"third-party"===b)this.parseOptParty(c);else{if("elemhide"===b){if(1===this.action){this.parseOptType("elemhide",!1);this.action=0;continue}this.unsupported=!0;break}if("document"===b){if(0===this.action){this.parseOptType("document",!1);continue}this.unsupported=!0;break}if(this.toNormalizedType.hasOwnProperty(b))this.parseOptType(b,c);else if("domain="===b.slice(0,7))this.parseOptHostnames(b.slice(7));else if("popup"===b)this.parseOptType("popup",c);else if("important"===
b)this.important=2;else{this.unsupported=!0;break}}};N.prototype.parse=function(a){this.reset();if(e.test(a))return this.f=a,this.hostnamePure=this.hostnameAnchored=!0,this;var b=a.indexOf("#");if(-1!==b&&(b=a.charAt(b+1),"#"===b||"@"===b))return console.error("static-net-filtering.js > unexpected cosmetic filters"),this.elemHiding=!0,this;0===a.lastIndexOf("@@",0)&&(this.action=1,a=a.slice(2));b=a.indexOf("$");-1!==b&&(this.parseOptions(a.slice(b+1)),a=a.slice(0,b));if("/"===a.charAt(0)&&"/"===a.slice(-1)&&
2<a.length)return this.isRegex=!0,this.f=a.slice(1,-1),this;if(0===a.lastIndexOf("||",0)&&(this.hostnameAnchored=!0,a=a.replace(this.reCleanupHostname,""),this.reHasUnicode.test(a)&&(b=this.reIsolateHostname.exec(a))&&3===b.length&&(a=punycode.toASCII(b[1])+b[2]),"^"===a.charAt(0)))return this.unsupported=!0,this;"|"===a.charAt(0)&&(this.anchor=-1,a=a.slice(1));"|"===a.slice(-1)&&(this.anchor=1,a=a.slice(0,-1));if(this.reHasWildcard.test(a)){a=a.replace(/\^/g,"*").replace(/\*\*+/g,"*");for(b=0;"*"===
a.charAt(b);)b+=1;a=a.slice(b);if(b=a.length){for(;"*"===a.charAt(b-1);)--b;a=a.slice(0,b)}}""===a&&(a="*");this.hostnamePure=this.hostnameAnchored&&e.test(a);this.f=this.reHasUppercase.test(a)?a.toLowerCase():a;return this};var Q=/^[0-9a-z]+/g,O=/[%0-9a-z]{2,}/g,T={com:!0,http:!0,https:!0,icon:!0,images:!0,img:!0,js:!0,net:!0,news:!0,www:!0};N.prototype.makeToken=function(){if(this.isRegex)this.token="*";else{var a=this.f;if("*"===a)this.token="*";else{var b;if(this.hostnameAnchored&&-1===a.indexOf("*"))Q.lastIndex=
0,(b=Q.exec(a))&&0!==b[0].length&&(this.tokenBeg=b.index,this.tokenEnd=Q.lastIndex,this.token=a.slice(this.tokenBeg,this.tokenEnd));else{a:{for(O.lastIndex=0;b=O.exec(a);)if("*"!==a.charAt(O.lastIndex)&&!T.hasOwnProperty(b[0]))break a;for(O.lastIndex=0;b=O.exec(a);)if("*"!==a.charAt(O.lastIndex))break a;b=null}null===b||0===b[0].length?this.token="*":(this.tokenBeg=b.index,this.tokenEnd=O.lastIndex,this.token=a.slice(this.tokenBeg,this.tokenEnd))}}}};var S=function(){this.beg=0;this.token=""},A=function(){this.reAnyToken=
/[%0-9a-z]+/g;this.tokens=[];this.filterParser=new N;this.reset()};A.prototype.reset=function(){this.frozen=!1;this.duplicateCount=this.blockFilterCount=this.allowFilterCount=this.rejectedCount=this.acceptedCount=this.processedFilterCount=0;this.duplicateBuster={};this.categories=Object.create(null);this.filterParser.reset();this.filterCounts={}};A.prototype.freeze=function(){this.duplicateBuster={};var a=this.categories,b,c;for(c in a)b=a[c]["."],void 0!==b&&b.freeze();this.filterParser.reset();
this.frozen=!0};A.prototype.factories={"[]":G,a:l,ah:u,"0a":t,"0ah":w,"1a":v,"1ah":x,"|a":y,"|ah":H,"a|":I,"a|h":J,"||a":K,"||ah":L,"//":M,"//h":C,"{h}":z,_:B,_h:D,"||_":E,"||_h":F};A.prototype.toSelfie=function(){var a=function(a){var b=[],c,d,f,k,e;for(e in a)if(b.push("k2\t"+n(e)),c=a[e],b.push(c.fid+"\t"+c.toSelfie()),"[]"===c.fid)for(c=c.filters,d=c.length,f=0;f<d;f++)k=c[f],b.push(k.fid+"\t"+k.toSelfie());return b.join("\n")};return{processedFilterCount:this.processedFilterCount,acceptedCount:this.acceptedCount,
rejectedCount:this.rejectedCount,allowFilterCount:this.allowFilterCount,blockFilterCount:this.blockFilterCount,duplicateCount:this.duplicateCount,categories:function(b){var c=[],d;for(d in b)c.push("k1\t"+n(d)),c.push(a(b[d]));return c.join("\n")}(this.categories)}};A.prototype.fromSelfie=function(a){this.frozen=!0;this.processedFilterCount=a.processedFilterCount;this.acceptedCount=a.acceptedCount;this.rejectedCount=a.rejectedCount;this.allowFilterCount=a.allowFilterCount;this.blockFilterCount=a.blockFilterCount;
this.duplicateCount=a.duplicateCount;var b,c,d=this.categories,f=null;a=a.categories;for(var k=a.length,e=0,g,h,l;e<k;)g=a.indexOf("\n",e),0>g&&(g=k),h=a.slice(e,g),e=g+1,g=h.indexOf("\t"),l=h.slice(0,g),"k1"===l?(b=p(h.slice(g+1)),b=d[b]=Object.create(null),f=null):"k2"===l?(c=p(h.slice(g+1)),f=null):(l=this.factories[l],null===f?f=b[c]=l.fromSelfie(h.slice(g+1)):f.add(l.fromSelfie(h.slice(g+1))))};A.prototype.makeCategoryKey=function(a){return a.toString(16)};A.prototype.compile=function(a,b){var c=
a.trim();if(0===c.length)return!1;var d=c.charAt(0);if("["===d||"!"===d)return!1;c=this.filterParser.parse(c);return c.elemHiding||c.unsupported?!1:c.hostnamePure&&this.compileHostnameOnlyFilter(c,b)?!0:!1===this.compileFilter(c,b)?!1:!0};A.prototype.compileHostnameOnlyFilter=function(a,b){if(0===a.hostnames.length&&0===a.notHostnames.length){var c=0;a.firstParty!==a.thirdParty&&(c=a.firstParty?4:8);var c=a.action|a.important|c,d=a.types;if(0===d)return b.push("n\v"+this.makeCategoryKey(c)+"\x0B.\x0B"+
a.f),!0;var f=1;do d&1&&b.push("n\v"+this.makeCategoryKey(c|f<<4)+"\x0B.\x0B"+a.f),f+=1,d>>>=1;while(0!==d);return!0}};A.prototype.compileFilter=function(a,b){a.makeToken();if(""===a.token)return console.error('static-net-filtering.js > FilterContainer.addFilter("%s"): can\'t tokenize',a.f),!1;var c=0;a.firstParty!==a.thirdParty&&(c=a.firstParty?4:8);var d,f=a.hostnames.length,k=a.notHostnames.length;if(0===f&&0===k){d=P(a);if(null===d)return!1;this.compileToAtomicFilter(d,a,c,b);return!0}if(0!==
f)for(;f--;){d=R(a);if(null===d)return!1;this.compileToAtomicFilter(d,a,c,b,a.hostnames[f])}if(0===k)return!0;if(0===f){d=P(a);if(null===d)return!1;this.compileToAtomicFilter(d,a,c,b)}for(a.action^=1;k--;){d=R(a);if(null===d)return!1;0===a.action&&(a.important=2);this.compileToAtomicFilter(d,a,c,b,a.notHostnames[k])}return!0};A.prototype.compileToAtomicFilter=function(a,b,c,d,f){c|=b.action|b.important;var k=b.types;if(0===k)d.push("n\v"+this.makeCategoryKey(c)+"\v"+b.token+"\v"+a.fid+"\v"+a.compile(b,
f));else{var e=1;do k&1&&d.push("n\v"+this.makeCategoryKey(c|e<<4)+"\v"+b.token+"\v"+a.fid+"\v"+a.compile(b,f)),e+=1,k>>>=1;while(0!==k)}};A.prototype.fromCompiledContent=function(a,b){for(var c,d=a.length,f,k,e;b<d;){if("n"!==a.charAt(b))return b;c=a.indexOf("\n",b);-1===c&&(c=d);f=a.slice(b+2,c);k=f.split("\v");b=c+1;this.acceptedCount+=1;c=this.categories[k[0]];void 0===c&&(c=this.categories[k[0]]=Object.create(null));e=c[k[1]];"."===k[1]?(void 0===e&&(e=c["."]=new z),!1===e.add(k[2])&&(this.duplicateCount+=
1)):this.duplicateBuster.hasOwnProperty(f)?this.duplicateCount+=1:(this.duplicateBuster[f]=!0,f=this.factories[k[2]],f=f.fromSelfie(k[3]),void 0===e?c[k[1]]=f:"[]"===e.fid?e.add(f):c[k[1]]=new G(e,f))}return d};A.prototype.tokenize=function(a){for(var b=this.tokens,c=this.reAnyToken,d,f,k=c.lastIndex=0;(d=c.exec(a))&&(f=b[k],void 0===f&&(f=b[k]=new S),f.beg=d.index,f.token=d[0],k+=1,2048!==k););f=b[k];void 0===f&&(f=b[k]=new S);f.token=""};A.prototype.matchTokens=function(a,b){var c=a["."];if(void 0!==
c&&!1!==c.match())return c;for(var d=this.tokens,f,k=0;;){f=d[k++];c=f.token;if(""===c)break;c=a[c];if(void 0!==c&&!1!==c.match(b,f.beg))return c}c=a["*"];return void 0!==c&&!1!==c.match(b)?c:!1};A.prototype.matchStringExactType=function(c,d,f){var k=d.toLowerCase();h=c.pageHostname||"";m=a.URI.hostnameFromURI(d);c=r(c.pageDomain,m)?4:8;f=b[f]||0;if(0===f)return"";d=this.categories;var e=!1,g;this.tokenize(k);if(g=d[this.makeCategoryKey(2|f)])if(e=this.matchTokens(g,k),!1!==e)return"sb:"+e.toString();
if(g=d[this.makeCategoryKey(2|f|c)])if(e=this.matchTokens(g,k),!1!==e)return"sb:"+e.toString();if(g=d[this.makeCategoryKey(0|f)])e=this.matchTokens(g,k);!1===e&&(g=d[this.makeCategoryKey(0|f|c)])&&(e=this.matchTokens(g,k));if(!1===e)return"";if(g=d[this.makeCategoryKey(1|f)])if(g=this.matchTokens(g,k),!1!==g)return"sa:"+g.toString();if(g=d[this.makeCategoryKey(1|f|c)])if(g=this.matchTokens(g,k),!1!==g)return"sa:"+g.toString();return"sb:"+e.toString()};A.prototype.matchString=function(a){var c=b[a.requestType]||
d;if(c>d)return this.matchStringExactType(a,a.requestURL,a.requestType);var f=a.requestURL.toLowerCase();h=a.pageHostname||"";m=a.requestHostname;a=r(a.pageDomain,a.requestHostname)?4:8;var k=this.categories,e;this.tokenize(f);var g=!1;if(e=k[this.makeCategoryKey(2)])if(g=this.matchTokens(e,f),!1!==g)return"sb:"+g.toString()+"$important";if(e=k[this.makeCategoryKey(2|a)])if(g=this.matchTokens(e,f),!1!==g)return"sb:"+g.toString()+"$important";if(e=k[this.makeCategoryKey(2|c)])if(g=this.matchTokens(e,
f),!1!==g)return"sb:"+g.toString()+"$important";if(e=k[this.makeCategoryKey(2|c|a)])if(g=this.matchTokens(e,f),!1!==g)return"sb:"+g.toString()+"$important";!1===g&&(e=k[this.makeCategoryKey(0)])&&(g=this.matchTokens(e,f));!1===g&&(e=k[this.makeCategoryKey(0|a)])&&(g=this.matchTokens(e,f));!1===g&&(e=k[this.makeCategoryKey(0|c)])&&(g=this.matchTokens(e,f));!1===g&&(e=k[this.makeCategoryKey(0|c|a)])&&(g=this.matchTokens(e,f));if(!1===g)return"";if(e=k[this.makeCategoryKey(1)])if(e=this.matchTokens(e,
f),!1!==e)return"sa:"+e.toString();if(e=k[this.makeCategoryKey(1|a)])if(e=this.matchTokens(e,f),!1!==e)return"sa:"+e.toString();if(e=k[this.makeCategoryKey(1|c)])if(e=this.matchTokens(e,f),!1!==e)return"sa:"+e.toString();if(e=k[this.makeCategoryKey(1|c|a)])if(e=this.matchTokens(e,f),!1!==e)return"sa:"+e.toString();return"sb:"+g.toString()};A.prototype.getFilterCount=function(){return this.acceptedCount-this.duplicateCount};return new A}();
\u00b5Block.cosmeticFilteringEngine=function(){var a=\u00b5Block,b=JSON.stringify,d=JSON.parse,c=function(a){this.s=a};c.prototype.retrieve=function(a,b){a===this.s&&b.push(this.s)};c.prototype.fid="#";c.prototype.toSelfie=function(){return this.s};c.fromSelfie=function(a){return new c(a)};var e=function(a){this.s=a};e.prototype.retrieve=function(a,b){a===this.s.slice(0,a.length)&&b.push(this.s)};e.prototype.fid="#+";e.prototype.toSelfie=function(){return this.s};e.fromSelfie=function(a){return new e(a)};
var f=function(a,b){this.f=null;this.filters=[];void 0!==a&&(this.filters[0]=a,void 0!==b&&(this.filters[1]=b))};f.prototype.add=function(a){this.filters.push(a)};f.prototype.retrieve=function(a,b){for(var c=this.filters.length;c--;)this.filters[c].retrieve(a,b)};f.prototype.fid="[]";f.prototype.toSelfie=function(){return this.filters.length.toString()};f.fromSelfie=function(){return new f};var h=function(a,b){this.s=a;this.hostname=b};h.prototype.retrieve=function(a,b){a.slice(-this.hostname.length)===
this.hostname&&b.push(this.s)};h.prototype.fid="h";h.prototype.toSelfie=function(){return b(this.s)+"\t"+this.hostname};h.fromSelfie=function(a){var b=a.indexOf("\t");return new h(d(a.slice(0,b)),a.slice(b+1))};var m=function(a,b){this.s=a;this.entity=b};m.prototype.retrieve=function(a,b){a.slice(-this.entity.length)===this.entity&&b.push(this.s)};m.prototype.fid="e";m.prototype.toSelfie=function(){return b(this.s)+"\t"+this.entity};m.fromSelfie=function(a){var b=a.indexOf("\t");return new m(d(a.slice(0,
b)),a.slice(b+1))};var n=function(){this.suffix=this.prefix="";this.unhide=0;this.hostnames=[];this.invalid=!1;this.cosmetic=!0;this.reParser=/^\s*([^#]*)(##|#@#)(.+)\s*$/};n.prototype.reset=function(){this.suffix=this.prefix="";this.unhide=0;this.hostnames.length=0;this.invalid=!1;this.cosmetic=!0;return this};n.prototype.parse=function(a){this.reset();a=this.reParser.exec(a);if(null===a||4!==a.length)return this.cosmetic=!1,this;this.prefix=a[1];this.suffix=a[3];if(-1!==this.suffix.indexOf("##"))return this.cosmetic=
!1,this;"["===this.suffix.charAt(1)&&'href^="'===this.suffix.slice(2,9)&&(this.suffix=this.suffix.slice(1));this.unhide="@"===a[2].charAt(1)?1:0;""!==this.prefix&&(this.hostnames=this.prefix.split(/\s*,\s*/));return this};var p=function(){this.reset()};p.junkyard=[];p.factory=function(){var a=p.junkyard.pop();return a?a.reset():new p};p.prototype.netLowWaterMark=20;p.prototype.netHighWaterMark=30;p.prototype.reset=function(){this.cosmetic={};this.net={};this.netCount=0;this.lastAccessTime=Date.now();
return this};p.prototype.dispose=function(){this.cosmetic=this.net=null;25>p.junkyard.length&&p.junkyard.push(this)};p.prototype.addCosmetic=function(a){for(var b=this.cosmetic,c=a.length||0;c--;)b[a[c]]=!0};p.prototype.addNet=function(a){"string"===typeof a?this.addNetOne(a,Date.now()):this.addNetMany(a,Date.now());if(!(this.netCount<this.netHighWaterMark)){var b=this.net;a=Object.keys(b).sort(function(a,c){return b[c]-b[a]}).slice(this.netLowWaterMark);for(var c=a.length;c--;)delete b[a[c]]}};p.prototype.addNetOne=
function(a,b){var c=this.net;void 0===c[a]&&(this.netCount+=1);c[a]=b};p.prototype.addNetMany=function(a,b){for(var c=this.net,d=a.length||0,f;d--;)f=a[d],void 0===c[f]&&(this.netCount+=1),c[f]=b};p.prototype.add=function(a,b){this.lastAccessTime=Date.now();"cosmetic"===b?this.addCosmetic(a):this.addNet(a)};p.prototype.remove=function(a){this.lastAccessTime=Date.now();if(void 0===a||"cosmetic"===a)this.cosmetic={};if(void 0===a||"net"===a)this.net={},this.netCount=0};p.prototype.retrieve=function(a,
b){this.lastAccessTime=Date.now();var c="cosmetic"===a?this.cosmetic:this.net,d;for(d in c)c.hasOwnProperty(d)&&b.push(d)};var g=function(a,b,c){var d=b.length,f=d>>1,e=d>>2,g=d>>3,h=(2166136261^b.charCodeAt(0))>>>0,h=h+((h<<1)+(h<<4)+(h<<7)+(h<<8)+(h<<24))>>>0,h=h^b.charCodeAt(g),h=h+((h<<1)+(h<<4)+(h<<7)+(h<<8)+(h<<24)),h=h>>>0,h=h^b.charCodeAt(e),h=h+((h<<1)+(h<<4)+(h<<7)+(h<<8)+(h<<24)),h=h>>>0,h=h^b.charCodeAt(e+g),h=h+((h<<1)+(h<<4)+(h<<7)+(h<<8)+(h<<24)),h=h>>>0,h=h^b.charCodeAt(f),h=h+((h<<
1)+(h<<4)+(h<<7)+(h<<8)+(h<<24)),h=h>>>0,h=h^b.charCodeAt(f+g),h=h+((h<<1)+(h<<4)+(h<<7)+(h<<8)+(h<<24)),h=h>>>0,h=h^b.charCodeAt(f+e),h=h+((h<<1)+(h<<4)+(h<<7)+(h<<8)+(h<<24)),h=h>>>0,h=h^b.charCodeAt(d-1),h=h+((h<<1)+(h<<4)+(h<<7)+(h<<8)+(h<<24)),h=h>>>0,h=h&c;0!==a&&(h|=131072);return h.toString(36)},r=function(){this.domainHashMask=1023;this.genericHashMask=32767;this.type0NoDomainHash="type0NoDomain";this.type1NoDomainHash="type1NoDomain";this.parser=new n;this.selectorCachePruneDelay=3E5;this.selectorCacheAgeMax=
12E5;this.selectorCacheCountMin=10;this.selectorCacheTimer=null;this.reHasUnicode=/[^\x00-\x7F]/;this.punycode=punycode;this.reset()};r.prototype.reset=function(){this.parser.reset();this.\u00b5buri=a.URI;this.frozen=!1;this.duplicateCount=this.acceptedCount=0;this.duplicateBuster={};this.selectorCache={};this.selectorCacheCount=0;this.lowGenericHide={};this.highLowGenericHide={};this.highLowGenericHideCount=0;this.highMediumGenericHide={};this.highMediumGenericHideCount=0;this.highHighGenericHideArray=
[];this.highHighGenericHide="";this.highHighGenericHideCount=0;this.genericDonthide=[];this.hostnameFilters={};this.entityFilters={}};r.prototype.div=document.createElement("div");r.prototype.isValidSelector="function"===typeof r.prototype.div.matches?function(a){try{this.div.matches(a)}catch(b){return console.error("uBlock> invalid cosmetic filter:",a),!1}return!0}:function(){return!0};r.prototype.compile=function(a,b){var c=this.parser.parse(a);if(!1===c.cosmetic)return!1;if(c.invalid)return!0;
var d=c.hostnames,f=d.length;if(0===f)return this.compileGenericSelector(c,b),!0;if(!1===this.reClassOrIdSelector.test(c.suffix)&&!1===this.isValidSelector(c.suffix))return!0;for(var e=!0,g;f--;)g=d[f],"~"!==g.charAt(0)&&(e=!1),".*"===g.slice(-2)?this.compileEntitySelector(g,c,b):this.compileHostnameSelector(g,c,b);e&&this.compileGenericSelector(c,b);return!0};r.prototype.compileGenericSelector=function(a,b){var c=a.suffix;if(a.unhide)this.isValidSelector(c)&&b.push("c\vg1\v"+c);else{var d=c.charAt(0);
"#"===d||"."===d?(d=this.rePlainSelector.exec(c),null!==d&&(d[1]===c?b.push("c\vlg\v"+g(0,d[1],this.genericHashMask)+"\v"+c):this.isValidSelector(c)&&b.push("c\vlg+\v"+g(0,d[1],this.genericHashMask)+"\v"+c))):this.reHighLow.test(c)?this.isValidSelector(c)&&b.push("c\vhlg0\v"+c):(d=this.reHighMedium.exec(c))&&2===d.length?this.isValidSelector(c)&&b.push("c\vhmg0\v"+d[1]+"\v"+c):this.isValidSelector(c)&&b.push("c\vhhg0\v"+c)}};r.prototype.reClassOrIdSelector=/^([#.][\w-]+)$/;r.prototype.rePlainSelector=
/^([#.][\w-]+)/;r.prototype.reHighLow=/^[a-z]*\[(?:alt|title)="[^"]+"\]$/;r.prototype.reHighMedium=/^\[href\^="https?:\/\/([^"]{8})[^"]*"\]$/;r.prototype.compileHostnameSelector=function(a,b,c){var d=b.unhide;"~"===a.charAt(0)&&(a=a.slice(1),d^=1);this.reHasUnicode.test(a)&&(a=this.punycode.toASCII(a));var f=this.\u00b5buri.domainFromHostname(a),d=""===f?0===d?this.type0NoDomainHash:this.type1NoDomainHash:g(d,f,this.domainHashMask);c.push("c\x0Bh\x0B"+d+"\v"+a+"\v"+b.suffix)};r.prototype.compileEntitySelector=
function(a,b,c){a=a.slice(0,-2);c.push("c\x0Be\x0B"+a+"\v"+b.suffix)};r.prototype.fromCompiledContent=function(a,b,d){if(d)return this.skipCompiledContent(a,b);var g;d=a.length;for(var m,p;b<d;){if("c"!==a.charAt(b))return b;g=a.indexOf("\n",b);-1===g&&(g=d);m=a.slice(b+2,g);b=g+1;this.acceptedCount+=1;this.duplicateBuster.hasOwnProperty(m)?this.duplicateCount+=1:(this.duplicateBuster[m]=!0,g=m.split("\v"),"h"===g[0]?(m=new h(g[3],g[2]),p=this.hostnameFilters[g[1]],void 0===p?this.hostnameFilters[g[1]]=
m:p instanceof f?p.add(m):this.hostnameFilters[g[1]]=new f(p,m)):"lg"===g[0]||"lg+"===g[0]?(m="lg"===g[0]?new c(g[2]):new e(g[2]),p=this.lowGenericHide[g[1]],void 0===p?this.lowGenericHide[g[1]]=m:p instanceof f?p.add(m):this.lowGenericHide[g[1]]=new f(p,m)):"e"===g[0]?(p=this.entityFilters[g[1]],void 0===p?this.entityFilters[g[1]]=[g[2]]:p.push(g[2])):"hlg0"===g[0]?(this.highLowGenericHide[g[1]]=!0,this.highLowGenericHideCount+=1):"hmg0"===g[0]?(Array.isArray(this.highMediumGenericHide[g[1]])?this.highMediumGenericHide[g[1]].push(g[2]):
this.highMediumGenericHide[g[1]]=[g[2]],this.highMediumGenericHideCount+=1):"hhg0"===g[0]?(this.highHighGenericHideArray.push(g[1]),this.highHighGenericHideCount+=1):"g1"===g[0]&&this.genericDonthide.push(g[1]))}return d};r.prototype.skipCompiledContent=function(a,b){for(var c,d=a.length;b<d;){if("c"!==a.charAt(b))return b;c=a.indexOf("\n",b);-1===c&&(c=d);b=c+1}return d};r.prototype.freeze=function(){this.duplicateBuster={};""!==this.highHighGenericHide&&this.highHighGenericHideArray.unshift(this.highHighGenericHide);
this.highHighGenericHide=this.highHighGenericHideArray.join(",\n");this.highHighGenericHideArray=[];this.parser.reset();this.frozen=!0};r.prototype.toSelfie=function(){var a=function(a){var c=[],d,f,e,g,h;for(h in a)if(!1!==a.hasOwnProperty(h)&&(c.push("k\t"+b(h)),d=a[h],c.push(d.fid+"\t"+d.toSelfie()),"[]"===d.fid))for(d=d.filters,f=d.length,e=0;e<f;e++)g=d[e],c.push(g.fid+"\t"+g.toSelfie());return c.join("\n")};return{acceptedCount:this.acceptedCount,duplicateCount:this.duplicateCount,hostnameSpecificFilters:a(this.hostnameFilters),
entitySpecificFilters:this.entityFilters,lowGenericHide:a(this.lowGenericHide),highLowGenericHide:this.highLowGenericHide,highLowGenericHideCount:this.highLowGenericHideCount,highMediumGenericHide:this.highMediumGenericHide,highMediumGenericHideCount:this.highMediumGenericHideCount,highHighGenericHide:this.highHighGenericHide,highHighGenericHideCount:this.highHighGenericHideCount,genericDonthide:this.genericDonthide}};r.prototype.fromSelfie=function(a){var b={"[]":f,"#":c,"#+":e,h:h,e:m},g=function(a){for(var c=
{},f,e=null,g=a.length,h=0,k,m,l;h<g;)k=a.indexOf("\n",h),0>k&&(k=g),m=a.slice(h,k),h=k+1,k=m.indexOf("\t"),l=m.slice(0,k),"k"===l?(f=d(m.slice(k+1)),e=null):(l=b[l],null===e?e=c[f]=l.fromSelfie(m.slice(k+1)):e.add(l.fromSelfie(m.slice(k+1))));return c};this.acceptedCount=a.acceptedCount;this.duplicateCount=a.duplicateCount;this.hostnameFilters=g(a.hostnameSpecificFilters);this.entityFilters=a.entitySpecificFilters;this.lowGenericHide=g(a.lowGenericHide);this.highLowGenericHide=a.highLowGenericHide;
this.highLowGenericHideCount=a.highLowGenericHideCount;this.highMediumGenericHide=a.highMediumGenericHide;this.highMediumGenericHideCount=a.highMediumGenericHideCount;this.highHighGenericHide=a.highHighGenericHide;this.highHighGenericHideCount=a.highHighGenericHideCount;this.genericDonthide=a.genericDonthide;this.frozen=!0};r.prototype.triggerSelectorCachePruner=function(){null!==this.selectorCacheTimer||this.selectorCacheCount<=this.selectorCacheCountMin||(this.selectorCacheTimer=setTimeout(this.pruneSelectorCacheAsync.bind(this),
this.selectorCachePruneDelay))};r.prototype.addToSelectorCache=function(a){var b=a.hostname;if("string"===typeof b&&""!==b){var c=a.selectors;if(c){var d=this.selectorCache[b];void 0===d&&(d=this.selectorCache[b]=p.factory(),this.selectorCacheCount+=1,this.triggerSelectorCachePruner());d.add(c,a.type)}}};r.prototype.removeFromSelectorCache=function(a,b){for(var c in this.selectorCache)if(!1!==this.selectorCache.hasOwnProperty(c)){if("*"!==a){if(c.slice(0-a.length)!==a)continue;if(c.length!==a.length&&
"."!==c.charAt(0-a.length-1))continue}this.selectorCache[c].remove(b)}};r.prototype.retrieveFromSelectorCache=function(a,b,c){a=this.selectorCache[a];void 0!==a&&a.retrieve(b,c)};r.prototype.pruneSelectorCacheAsync=function(){this.selectorCacheTimer=null;if(!(this.selectorCacheCount<=this.selectorCacheCountMin)){for(var a=this.selectorCache,b=Object.keys(a).sort(function(b,c){return a[c].lastAccessTime-a[b].lastAccessTime}).slice(this.selectorCacheCountMin),c=Date.now()-this.selectorCacheAgeMax,d,
f,e=b.length;e--;){d=b[e];f=a[d];if(f.lastAccessTime>c)break;f.dispose();delete a[d];--this.selectorCacheCount}this.triggerSelectorCachePruner()}};r.prototype.retrieveGenericSelectors=function(a){if(0!==this.acceptedCount&&a.selectors){var b={hide:[]};a.firstSurvey&&(b.highGenerics={hideLow:this.highLowGenericHide,hideLowCount:this.highLowGenericHideCount,hideMedium:this.highMediumGenericHide,hideMediumCount:this.highMediumGenericHideCount,hideHigh:this.highHighGenericHide,hideHighCount:this.highHighGenericHideCount},
b.donthide=this.genericDonthide);for(var c,d=this.genericHashMask,f=b.hide,e=a.selectors,h=e.length,m;h--;)if(m=e[h])a=g(0,m,d),(c=this.lowGenericHide[a])&&c.retrieve(m,f);return b}};r.prototype.retrieveDomainSelectors=function(b){if(b.locationURL){b=a.URI.hostnameFromURI(b.locationURL);var c=a.URI.domainFromHostname(b)||b,d=c.indexOf("."),d={ready:this.frozen,domain:c,entity:-1===d?c:c.slice(0,d-c.length),skipCosmeticFiltering:0===this.acceptedCount,cosmeticHide:[],cosmeticDonthide:[],netHide:[],
netCollapse:a.userSettings.collapseBlocked},f,e;f=g(0,c,this.domainHashMask);(e=this.hostnameFilters[f])&&e.retrieve(b,d.cosmeticHide);(e=this.hostnameFilters[this.type0NoDomainHash])&&e.retrieve(b,d.cosmeticHide);if(e=this.entityFilters[d.entity])d.cosmeticHide=d.cosmeticHide.concat(e);f=g(1,c,this.domainHashMask);(e=this.hostnameFilters[f])&&e.retrieve(b,d.cosmeticDonthide);(e=this.hostnameFilters[this.type1NoDomainHash])&&e.retrieve(b,d.cosmeticDonthide);this.retrieveFromSelectorCache(b,"cosmetic",
d.cosmeticHide);this.retrieveFromSelectorCache(b,"net",d.netHide);return d}};r.prototype.getFilterCount=function(){return this.acceptedCount-this.duplicateCount};return new r}();
(function(){var a=/[-\/\\^$+?.()|[\]{}]/g,b=/\*/g,d=function(c,d,f){if(-1===f.indexOf("/"))return d.slice(-f.length)===f;if(-1===f.indexOf("*"))return c===f;d=f.replace(a,"\\$&").replace(b,".*");return(new RegExp(d)).test(c)};\u00b5Block.getNetFilteringSwitch=function(a){for(var b=this.netWhitelist,f,h,m=this.URI.hostnameFromURI(a),n=m;;){if(b.hasOwnProperty(n))for(f=b[n],h=f.length;h--;)if(d(a,m,f[h]))return!1;f=n.indexOf(".");if(-1===f)break;n=n.slice(f+1)}return!0};\u00b5Block.toggleNetFilteringSwitch=
function(a,b,f){var h=this.getNetFilteringSwitch(a);void 0===f&&(f=!h);if(f===h)return h;var h=this.netWhitelist,m=a.indexOf("#");a=-1!==m?a.slice(0,m):a;var n=this.URI.hostnameFromURI(a),p=n;b="page"===b?a:n;if(!1===f)return!1===h.hasOwnProperty(p)&&(h[p]=[]),h[p].push(b),this.saveWhitelist(),!0;for(;;){if(h.hasOwnProperty(p)){f=h[p];for(m=f.length;m--;)if(b=f[m],d(a,n,b)){f.splice(m,1);var g=b;-1!==g.indexOf("/")&&-1!==g.indexOf("*")&&h["#"].push("# "+b)}0===f.length&&delete h[p]}m=p.indexOf(".");
if(-1===m)break;p=p.slice(m+1)}this.saveWhitelist();return!0};\u00b5Block.stringFromWhitelist=function(a){var b={},d,h,m;for(m in a)if(!1!==a.hasOwnProperty(m))for(h=a[m],d=h.length;d--;)b[h[d]]=!0;return Object.keys(b).sort(function(a,b){return a.localeCompare(b)}).join("\n")};\u00b5Block.whitelistFromString=function(a){var b={"#":[]},d=/[^a-z0-9.\-\[\]:]/,h=/([a-z0-9\[][a-z0-9.\-:]*[a-z0-9\]])\/(?:[^\x00-\x20\/]|$)[^\x00-\x20]*$/;a=a.split(/[\n\r]+/);for(var m,n,p=0;p<a.length;p++)m=a[p].trim(),
""!==m&&("#"===m.charAt(0)?n="#":-1===m.indexOf("/")?d.test(m)?(n="#",m="# "+m):n=m:(n=h.exec(m))&&2===n.length?n=n[1]:(n="#",m="# "+m),""!==n&&(!1===b.hasOwnProperty(n)&&(b[n]=[]),b[n].push(m)));return b};\u00b5Block.changeUserSettings=function(a,b){if(void 0===a)return this.userSettings;if("string"===typeof a&&""!==a&&void 0!==this.userSettings[a]){if(void 0===b)return this.userSettings[a];this.userSettings[a]=b;switch(a){case "collapseBlocked":!1===b&&this.cosmeticFilteringEngine.removeFromSelectorCache("*",
"net");break;case "contextMenuEnabled":this.contextMenu.toggle(b);break;case "experimentalEnabled":"object"===typeof this.mirrors&&this.mirrors.toggle(!1)}this.saveUserSettings()}};\u00b5Block.elementPickerExec=function(a,b){this.epickerTarget=b;vAPI.tabs.injectScript(a,{file:"js/element-picker.js"})};\u00b5Block.toggleFirewallRule=function(a){0!==a.action?this.sessionFirewall.setCellZ(a.srcHostname,a.desHostname,a.requestType,a.action):this.sessionFirewall.unsetCell(a.srcHostname,a.desHostname,a.requestType);
a.persist&&(0!==a.action?this.permanentFirewall.setCellZ(a.srcHostname,a.desHostname,a.requestType,a.action):this.permanentFirewall.unsetCell(a.srcHostname,a.desHostname,a.requestType,a.action),this.savePermanentFirewallRules());this.cosmeticFilteringEngine.removeFromSelectorCache(a.srcHostname,"net")};\u00b5Block.isBlockResult=function(a){return"string"===typeof a&&"b"===a.charAt(1)};\u00b5Block.isAllowResult=function(a){return"string"!==typeof a||"b"!==a.charAt(1)};\u00b5Block.logCosmeticFilters=
function(){var a={},b=function(b){delete a[b];vAPI.tabs.injectScript(b,{file:"js/cosmetic-logger.js"})};return function(d){a.hasOwnProperty(d)||(a[d]=setTimeout(b.bind(null,d),100))}}()})();
(function(){vAPI.messaging.setup(function(a,b,d){var c=\u00b5Block;if(void 0!=a&&void 0!=a.what){switch(a.what){case "getAssetContent":c.assets.get(a.url,d);return;case "reloadAllFilters":c.reloadAllFilters(d);return}b=b&&b.tab?b.tab.id:0;var e;switch(a.what){case "contextMenuEvent":c.contextMenuClientX=a.clientX;c.contextMenuClientY=a.clientY;break;case "cosmeticFiltersInjected":c.cosmeticFilteringEngine.addToSelectorCache(a);case "cosmeticFiltersActivated":c.logger.isObserved(b)&&"net"!==a.type&&
c.logCosmeticFilters(b);break;case "forceUpdateAssets":c.assetUpdater.force();break;case "getAppData":e={name:vAPI.app.name,version:vAPI.app.version};break;case "getUserSettings":e=c.userSettings;break;case "gotoURL":vAPI.tabs.open(a.details);break;case "reloadTab":!1===vAPI.isBehindTheSceneTabId(a.tabId)&&(vAPI.tabs.reload(a.tabId),a.select&&vAPI.tabs.select&&vAPI.tabs.select(a.tabId));break;case "selectFilterLists":c.selectFilterLists(a.switches);break;case "toggleHostnameSwitch":c.toggleHostnameSwitch(a);
break;case "userSettings":e=c.changeUserSettings(a.name,a.value);break;default:return vAPI.messaging.UNHANDLED}d(e)}})})();
(function(){var a=\u00b5Block,b=function(b,c){var d={},m=a.sessionFirewall;d["/ * *"]=m.evaluateCellZY("*","*","*").toFilterString();d["/ * image"]=m.evaluateCellZY("*","*","image").toFilterString();d["/ * 3p"]=m.evaluateCellZY("*","*","3p").toFilterString();d["/ * inline-script"]=m.evaluateCellZY("*","*","inline-script").toFilterString();d["/ * 1p-script"]=m.evaluateCellZY("*","*","1p-script").toFilterString();d["/ * 3p-script"]=m.evaluateCellZY("*","*","3p-script").toFilterString();d["/ * 3p-frame"]=
m.evaluateCellZY("*","*","3p-frame").toFilterString();if("string"!==typeof b)return d;d[". * *"]=m.evaluateCellZY(b,"*","*").toFilterString();d[". * image"]=m.evaluateCellZY(b,"*","image").toFilterString();d[". * 3p"]=m.evaluateCellZY(b,"*","3p").toFilterString();d[". * inline-script"]=m.evaluateCellZY(b,"*","inline-script").toFilterString();d[". * 1p-script"]=m.evaluateCellZY(b,"*","1p-script").toFilterString();d[". * 3p-script"]=m.evaluateCellZY(b,"*","3p-script").toFilterString();d[". * 3p-frame"]=
m.evaluateCellZY(b,"*","3p-frame").toFilterString();for(var n in c)c.hasOwnProperty(n)&&(d["/ "+n+" *"]=m.evaluateCellZY("*",n,"*").toFilterString(),d[". "+n+" *"]=m.evaluateCellZY(b,n,"*").toFilterString());return d},d=function(d,f){var h=a.tabContextManager.lookup(d),m={advancedUserEnabled:a.userSettings.advancedUserEnabled,appName:vAPI.app.name,appVersion:vAPI.app.version,cosmeticFilteringSwitch:!1,dfEnabled:a.userSettings.dynamicFilteringEnabled,firewallPaneMinimized:a.userSettings.firewallPaneMinimized,
globalAllowedRequestCount:a.localSettings.allowedRequestCount,globalBlockedRequestCount:a.localSettings.blockedRequestCount,netFilteringSwitch:!1,rawURL:h.rawURL,pageURL:h.normalURL,pageHostname:h.rootHostname,pageDomain:h.rootDomain,pageAllowedRequestCount:0,pageBlockedRequestCount:0,notificationCount:extension.notificationCount,pageReplacedAdCount:extension.adreplaceCount,tabId:d,tabTitle:f,extStatus:"off",intentlyDomain:Conf.DOMAIN,notificationUrl:Conf.NOTIFICATIONS_URL,dashboardUrl:Conf.APP_URL,
loginUrl:Conf.LOGIN_URL,settingsUrl:Conf.SETTINGS_URL,tellAFriendUrl:Conf.TELL_A_FRIEND_URL,initializationHelpUrl:Conf.INITIALIZATION_HELP_URL,intentlyEnabled:extension.intentlyEnabled,whiteListed:!1};Conf.USER_DOMAIN_WHITELISTS&&h.normalURL&&0<=Conf.USER_DOMAIN_WHITELISTS.indexOf(Utils.parseUri(h.normalURL).hostname)&&(m.whiteListed=!0);extension.userLoggedIn&&(m.extStatus=extension.intentlyActive&&!extension.intentlyInitializing?"active":"init");var n=a.pageStoreFromTabId(d);if(n){m.pageBlockedRequestCount=
n.perLoadBlockedRequestCount;m.pageAllowedRequestCount=n.perLoadAllowedRequestCount;m.netFilteringSwitch=n.getNetFilteringSwitch();var p=n.hostnameToCountMap,g={},r,k=a.URI.domainFromHostname,q,l,u,t;for(t in p)!1===p.hasOwnProperty(t)||g.hasOwnProperty(t)||(q=k(t)||t,l=p[q]||0,u=l&65535,l=l>>>16&65535,r=!1===g.hasOwnProperty(q)?g[q]={domain:q,blockCount:u,allowCount:l,totalBlockCount:0,totalAllowCount:0}:g[q],l=p[t]||0,u=l&65535,l=l>>>16&65535,r.totalBlockCount+=u,r.totalAllowCount+=l,t!==q&&(g[t]=
{domain:q,blockCount:u,allowCount:l}));m.hostnameDict=g;m.contentLastModified=n.contentLastModified;m.firewallRules=b(h.rootHostname,m.hostnameDict);m.canElementPicker=-1!==h.rootHostname.indexOf(".");m.canRequestLog=c}else m.hostnameDict={},m.firewallRules=b();m.matrixIsDirty=!a.sessionFirewall.hasSameRules(a.permanentFirewall,h.rootHostname,m.hostnameDict);return m},c=!0;vAPI.messaging.listen("popup.js",function(b,f,h){switch(b.what){case "getPopupData":if(b.tabId===vAPI.noTabId){h(d(vAPI.noTabId,
""));return}vAPI.tabs.get(b.tabId,function(a){var b;c=!0;a?0!==a.url.lastIndexOf(vAPI.getURL("devtools.html"),0)?b=a.id:(c=!1,b=(b=a.url.match(/[\?&]tabId=([^&]+)/))&&2===b.length?b[1]:a.id):b="";h(d(b,a?a.title:""))});return;case "toggleIntentlyEnabled":extension.toggleIntentlyEnabled(h);return;case "toggleWhitelistChange":vAPI.tabs.get(b.tabId,function(a){var b=Utils.parseUri(a.url).hostname;0<=Conf.USER_DOMAIN_WHITELISTS.indexOf(b)?extension.removeWhitelist(a):extension.addWhitelist(a);h()});return}var m;
switch(b.what){case "gotoPick":a.contextMenuClientX=-1;a.contextMenuClientY=-1;a.elementPickerExec(b.tabId);b.select&&vAPI.tabs.select&&vAPI.tabs.select(b.tabId);break;case "hasPopupContentChanged":f=a.pageStoreFromTabId(b.tabId);m=(f?f.contentLastModified:0)!==b.contentLastModified;break;case "gotoURL":vAPI.tabs.open(b.details);break;case "saveFirewallRules":a.permanentFirewall.copyRules(a.sessionFirewall,b.srcHostname,b.desHostnames);a.savePermanentFirewallRules();break;case "flushFirewallRules":a.sessionFirewall.copyRules(a.permanentFirewall,
b.srcHostname,b.desHostnames);break;case "toggleFirewallRule":a.toggleFirewallRule(b);m=d(b.tabId);break;case "toggleNetFiltering":if(f=a.pageStoreFromTabId(b.tabId))f.toggleNetFilteringSwitch(b.url,b.scope,b.state),a.updateBadgeAsync(b.tabId);break;default:return vAPI.messaging.UNHANDLED}h(m)})})();
(function(){var a=\u00b5Block;vAPI.messaging.listen("newtab.js",function(b,d,c){switch(b.what){case "getNewTabImage":NewTabController.getTodayImg(function(a,b){"function"===typeof c&&c({imageconfig:b,imgurl:a})});return;case "getNewTabPromo":NewTabController.getPromo(function(a){"function"===typeof c&&c(a)});return;case "setTopSites":NewTabController.setTopSites(b.display,function(a){"function"===typeof c&&c(a)});return;case "setPromoOptIn":NewTabController.setPromoOptIn(b.optin,function(a){"function"===
typeof c&&c(a)});return;case "logNewTabData":NewTabController.logNewTabData(b.logdata,function(a){"function"===typeof c&&c(a)});return;case "setNewTabOptin":NewTabController.setNewTabOptin(b.optin,function(a){"function"===typeof c&&c(a)});return;case "setQuoteLike":NewTabController.setQuoteLike(b.quotelike,b.quoteid,function(a){"function"===typeof c&&c(a)});return;case "getNewTabQuote":NewTabController.getAQuote(function(a){"function"===typeof c&&c(a)});return;case "getTopSites":vAPI.getTopSites(function(a){"function"===
typeof c&&c(a)});return;case "addCustomQuote":NewTabController.createQuote(b.data,function(a){"function"===typeof c&&c(a)});return;case "getLoginStatus":b={};b=extension.userLoggedIn?extension.intentlyActive&&!extension.intentlyInitializing?{loggedIn:!0,inprogress:!1,loginUrl:Conf.LOGIN_URL,apiUrl:Conf.API_URL}:{loggedIn:!0,inprogress:!0}:{loggedIn:!1,inprogress:!1,loginUrl:Conf.LOGIN_URL,apiUrl:Conf.API_URL};"function"===typeof c&&c(b);return;case "getInitData":b={};extension.userLoggedIn?extension.intentlyActive&&
!extension.intentlyInitializing&&(b=-1,1==Conf.SHOW_NEW_TAB_OVERRIDE?b=1:null==Conf.SHOW_NEW_TAB_OVERRIDE&&(b=0),d=-1,1==Conf.SHOW_NEW_TAB_PROMO?d=1:null==Conf.SHOW_NEW_TAB_PROMO&&(d=0),b={loggedIn:!0,appUrl:Conf.APP_URL,intentlyDomain:Conf.DOMAIN,loginUrl:Conf.LOGIN_URL,settingsUrl:Conf.SETTINGS_URL,apiUrl:Conf.API_URL,tellAFriendUrl:Conf.TELL_A_FRIEND_URL,proUrl:Conf.PRO_SIGNUP_URL,enabletopsites:vAPI.topsitesEnabled,showfrequentpages:Conf.SHOW_NEW_TAB_FREQUENT_PAGES,tabOptIn:b,adOptIn:d,quoteSubmissionContestEnd:Conf.QUOTE_SUBMISSION_CONTEST_END,
quoteSubmissionContestRulesUrl:Conf.QUOTE_CONTEST_RULES_URL}):b={loggedIn:!1,loginUrl:Conf.LOGIN_URL,apiUrl:Conf.API_URL};"function"===typeof c&&c(b);return}d&&d.tab&&a.pageStoreFromTabId(d.tab.id);switch(b.what){case "testapp":b={data:"received"};break;default:return vAPI.messaging.UNHANDLED}c(b)})})();var onMessage=function(a,b,d){switch(a.what){case "getOnboardConfig":d({loggedIn:extension.userLoggedIn,proInfoURL:Conf.PRO_INFO_URL,proSignupURL:Conf.PRO_SIGNUP_URL});return}d(void 0)};
vAPI.messaging.listen("onboard.js",onMessage);(function(){var a=\u00b5Block;vAPI.messaging.listen("contentscript-start.js",function(b,d,c){var e,f;d&&d.tab&&(f=a.pageStoreFromTabId(d.tab.id));switch(b.what){case "retrieveDomainCosmeticSelectors":f&&f.getSpecificCosmeticFilteringSwitch()&&(e=a.cosmeticFilteringEngine.retrieveDomainSelectors(b));break;default:return vAPI.messaging.UNHANDLED}c(e)})})();
(function(){var a=\u00b5Block;vAPI.messaging.listen("shareDialog.js",function(b,d,c){d&&d.tab&&a.pageStoreFromTabId(d.tab.id);switch(b.what){case "testapp":b={data:"received"};break;default:return vAPI.messaging.UNHANDLED}c(b)})})();
(function(){var a=\u00b5Block,b={embed:"object",iframe:"sub_frame",img:"image",object:"object"};vAPI.messaging.listen("contentscript-end.js",function(d,c,e){var f;c&&c.tab&&(f=a.pageStoreFromTabId(c.tab.id));switch(d.what){case "retrieveGenericCosmeticSelectors":c={shutdown:!f||!f.getNetFilteringSwitch(),result:null};!c.shutdown&&f.getGenericCosmeticFilteringSwitch()&&(c.result=a.cosmeticFilteringEngine.retrieveGenericSelectors(d));break;case "filterRequests":c={shutdown:!f||!f.getNetFilteringSwitch(),
result:null};if(!c.shutdown){var h=c;var m=d.requests;if(f&&f.getNetFilteringSwitch()&&!1!==a.userSettings.collapseBlocked){var n=a.URI,p=a.isBlockResult;d=f.createContextFromFrameHostname(d.pageHostname);for(var g,r=m.length;r--;)g=m[r],d.requestURL=vAPI.punycodeURL(g.url),d.requestHostname=n.hostnameFromURI(g.url),d.requestType=b[g.tagName],p(f.filterRequest(d))&&(g.collapse=!0)}h.result=m}break;default:return vAPI.messaging.UNHANDLED}e(c)})})();
(function(){var a=\u00b5Block;vAPI.messaging.listen("cosmetic-*.js",function(b,d,c){d=d&&d.tab?d.tab.id:0;switch(b.what){case "logCosmeticFilteringData":if(!1!==a.logger.isObserved(d)){var e={requestURL:b.pageURL,requestHostname:a.URI.hostnameFromURI(b.pageURL),requestType:"dom"};b=b.matchedSelectors;b.sort();for(var f=0;f<b.length;f++)a.logger.writeOne(d,e,"cb:##"+b[f])}break;default:return vAPI.messaging.UNHANDLED}c(void 0)})})();
(function(){var a=\u00b5Block;vAPI.messaging.listen("element-picker.js",function(b,d,c){switch(b.what){case "elementPickerArguments":b=new XMLHttpRequest;b.open("GET","epicker.html",!0);b.overrideMimeType("text/html;charset=utf-8");b.responseType="text";b.onload=function(){this.onload=null;var b={bidi_dir:document.body.getAttribute("dir"),create:vAPI.i18n("pickerCreate"),pick:vAPI.i18n("pickerPick"),quit:vAPI.i18n("pickerQuit"),netFilters:vAPI.i18n("pickerNetFilters"),cosmeticFilters:vAPI.i18n("pickerCosmeticFilters"),
cosmeticFiltersHint:vAPI.i18n("pickerCosmeticFiltersHint")};c({frameContent:this.responseText.replace(/\{\{(\w+)\}\}/g,function(a,c){return b[c]}),target:a.epickerTarget,clientX:a.contextMenuClientX,clientY:a.contextMenuClientY,eprom:a.epickerEprom});a.contextMenuClientX=-1;a.contextMenuClientY=-1};b.send();return}switch(b.what){case "createUserFilter":d&&d.tab&&vAPI.messaging.handleIntentlyMsg(d.tab.id,b.intentlyResponse,function(){});break;case "elementPickerEprom":a.epickerEprom=b;break;default:return vAPI.messaging.UNHANDLED}c(void 0)})})();
(function(){var a=\u00b5Block,b=function(b){var d=a.URI,f,h;for(h in b)!1!==b.hasOwnProperty(h)&&(f=b[h],"string"===typeof f.homeURL&&(f.homeHostname=d.hostnameFromURI(f.homeURL),f.homeDomain=d.domainFromHostname(f.homeHostname)))},d=function(c){var d={autoUpdate:a.userSettings.autoUpdate,available:null,cache:null,cosmetic:a.userSettings.parseAllABPHideFilters,cosmeticFilterCount:a.cosmeticFilteringEngine.getFilterCount(),current:a.remoteBlacklists,manualUpdate:!1,netFilterCount:a.staticNetFilteringEngine.getFilterCount(),
userFiltersPath:a.userFiltersPath},f=function(f){d.cache=f;d.manualUpdate=a.assetUpdater.manualUpdate;d.manualUpdateProgress=a.assetUpdater.manualUpdateProgress;b(d.cache);c(d)};a.getAvailableLists(function(c){d.available=c;b(d.available);a.assets.metadata(f)})};vAPI.messaging.listen("3p-filters.js",function(b,e,f){switch(b.what){case "getLists":return d(f);case "purgeAllCaches":return a.assets.purgeAll(f)}switch(b.what){case "purgeCache":a.assets.purge(b.path);break;default:return vAPI.messaging.UNHANDLED}f(void 0)})})();
(function(){var a=\u00b5Block;vAPI.messaging.listen("1p-filters.js",function(b,d,c){switch(b.what){case "readUserFilters":return a.loadUserFilters(c);case "writeUserFilters":return a.saveUserFilters(b.content,c)}switch(b.what){default:return vAPI.messaging.UNHANDLED}})})();
(function(){var a=\u00b5Block,b=function(){return{permanentRules:a.permanentFirewall.toString(),sessionRules:a.sessionFirewall.toString()}};vAPI.messaging.listen("dyna-rules.js",function(d,c,e){switch(d.what){case "getFirewallRules":d=b();break;case "setSessionFirewallRules":a.cosmeticFilteringEngine.removeFromSelectorCache("*");a.sessionFirewall.fromString(d.rules);d=b();break;case "setPermanentFirewallRules":a.permanentFirewall.fromString(d.rules);a.savePermanentFirewallRules();d=b();break;default:return vAPI.messaging.UNHANDLED}e(d)})})();
(function(){var a=\u00b5Block;vAPI.messaging.listen("whitelist.js",function(b,d,c){var e;switch(b.what){case "getWhitelist":e=a.stringFromWhitelist(a.netWhitelist);break;case "setWhitelist":a.netWhitelist=a.whitelistFromString(b.whitelist);a.saveWhitelist();a.cosmeticFilteringEngine.removeFromSelectorCache("*");break;default:return vAPI.messaging.UNHANDLED}c(e)})})();
(function(){var a=\u00b5Block,b=function(b){var c={},e=Object.keys(a.pageStores),f=e.indexOf(vAPI.noTabId);-1!==f&&(e.splice(f,1),c[vAPI.noTabId]=vAPI.i18n("logBehindTheScene"));if(0===e.length)b(c);else for(var h=e.length,m=vAPI.getURL("devtools.html"),f=function(a){a&&0!==a.url.lastIndexOf(m,0)&&(c[a.id]=a.title);--h;0===h&&b(c)},n=h;n--;)vAPI.tabs.get(e[n],f)};vAPI.messaging.listen("devtools.js",function(a,c,e){switch(a.what){case "getPageDetails":b(e);return}switch(a.what){default:return vAPI.messaging.UNHANDLED}})})();
(function(){var a=\u00b5Block,b=function(b){a.getBytesInUse(function(c){var d=a.restoreBackupSettings;b({storageUsed:c,lastRestoreFile:d.lastRestoreFile,lastRestoreTime:d.lastRestoreTime,lastBackupFile:d.lastBackupFile,lastBackupTime:d.lastBackupTime})})},d=function(c){var d={timeStamp:Date.now(),version:vAPI.app.version,userSettings:a.userSettings,filterLists:{},netWhitelist:a.stringFromWhitelist(a.netWhitelist),dynamicFilteringString:a.permanentFirewall.toString(),userFilters:""},h=function(h){d.filterLists=
h;h=new Date;h=vAPI.i18n("aboutBackupFilename").replace("{{datetime}}",h.toLocaleString()).replace(/ +/g,"_");vAPI.download({url:"data:text/plain;charset=utf-8,"+encodeURIComponent(JSON.stringify(d,null,"  ")),filename:h});a.restoreBackupSettings.lastBackupFile=h;a.restoreBackupSettings.lastBackupTime=Date.now();vAPI.storage.preferences.set(a.restoreBackupSettings);b(c)};a.loadUserFilters(function(b){d.userFilters=b.content;a.extractSelectedFilterLists(h)})},c=function(b){var c=b.userData,d=7,m=function(){--d;
0===d&&vAPI.app.restart()};a.assets.rmrf();vAPI.storage.clear(function(){a.keyvalSetOnePref("version",c.version);\u00b5Block.saveLocalSettings(!0);vAPI.storage.preferences.set(c.userSettings,m);a.keyvalSetOnePref("remoteBlacklists",c.filterLists,m);a.keyvalSetOnePref("netWhitelist",c.netWhitelist||"",m);a.keyvalSetOnePref("dynamicFilteringString",c.dynamicFilteringString||c.userSettings.dynamicFilteringString||"",m);a.keyvalSetOnePref("userFilters",c.userFilters,m);vAPI.storage.preferences.set({lastRestoreFile:b.file||
"",lastRestoreTime:Date.now(),lastBackupFile:"",lastBackupTime:0},m)})};vAPI.messaging.listen("settings.js",function(e,f,h){switch(e.what){case "backupUserData":return d(h);case "getLocalData":return b(h)}switch(e.what){case "restoreUserData":c(e);break;case "resetUserData":vAPI.storage.clear();a.saveLocalSettings(!0);vAPI.app.restart();break;default:return vAPI.messaging.UNHANDLED}h(void 0)})})();
(function(){var a=\u00b5Block;vAPI.messaging.listen("devtool-log.js",function(b,d,c){switch(b.what){case "readLogBuffer":b=a.logger.readAll(b.tabId);break;default:return vAPI.messaging.UNHANDLED}c(b)})})();(function(){vAPI.messaging.listen("subscriber.js",function(a,b,d){switch(a.what){case "subscriberData":a={confirmStr:vAPI.i18n("subscriberConfirm"),externalLists:\u00b5Block.userSettings.externalLists};break;default:return vAPI.messaging.UNHANDLED}d(a)})})();
(function(){vAPI.messaging.listen("document-blocked.js",function(a,b,d){switch(a.what){case "temporarilyWhitelistDocument":\u00b5Block.webRequest.temporarilyWhitelistDocument(a.url);break;default:return vAPI.messaging.UNHANDLED}d(void 0)})})();
(function(){var a=\u00b5Block,b=function(a,b){var c=a.width/a.height;if(navigator.onLine&&200<=a.width&&200<=a.height&&.75<=c&&2>=c&&(extension.loginReplacementReminderCount++,10<=extension.loginReplacementReminderCount)){extension.loginReplacementReminderCount=0;var d,e,g,r,c=0<=b.indexOf("facebook.com")||0<=b.indexOf("yelp.com");d="";e=a.width/a.height;1.5<e?d="h":1.5>e&&(d="w");"w"==d?(e=d=450>a.width?a.width:450,g=d/1.5,r=a.height):"h"==d?(r=g=300>a.height?a.height:300,d=1.5*g,e=a.width):(d=450>
a.width?a.width:450,e=a.width,g=300>a.height?a.height:300,r=a.height);var k=0;d<e&&(k=(e-d)/2);var q=0;g<r&&(q=(r-g)/2);r=c?g:r;c='<div intentlyReplacementID="-1" ';c+='channelResourceID="-1" ';c+='impression="-1" ';c+="visibility: visible; ";c+="height: "+r+"px; ";c+="width: "+e+"px; ";c+='">';c+="<div ";c+='intentlyReplacementParentID="-1" ';c+='style="background-color: transparent; ';c+="height: "+r+"px; ";c+="width: "+e+"px; ";q>Conf.MAXIMUM_REPLACEMENT_VERTICAL_MARGIN&&(q=Conf.MAXIMUM_REPLACEMENT_VERTICAL_MARGIN);
c+="margin-top: "+q+"px; ";c+="margin-bottom: "+q+"px; ";c+="margin-left: "+k+"px; ";c+="margin-right: "+k+"px; ";c+='">';c+='<a href="'+Conf.LOGIN_URL+'" >';c+="<img ";c+='intentlyReplacementParentID="'+a.intentlyID+'" ';c+='style="';c+="width: "+d+"px; ";c+="height: "+g+"px; ";c+='" ';c+='src="'+vAPI.getURL("/img/browsericons/logoutreplacement.png")+'" ';c+="/>";c+="</a>";c+="</div>";c+="</div>";a.channelResourceID="-1";a.containerHeight=r;a.containerWidth=e;a.resourceHeight=g;a.resourceWidth=d;
a.replacementHTML=c;a.replacementDestination=Conf.LOGIN_URL;return a}a.channelResourceID=null;return a},d=function(a,c){if(!extension.userLoggedIn)return b(a,c);var d=null,e=[],p=a.width*a.height,g=0<=c.indexOf("facebook.com")||0<=c.indexOf("yelp.com");intentlyData.channelResources.forEach(function(b){var c=!0,d=!0,g=!0;b.algorithmScore=0;0<b.minWidth&&b.minWidth>a.maxWidth?c=!1:0<b.maxWidth&&b.maxWidth<a.minWidth?c=!1:0<b.minHeight&&b.minHeight>a.maxHeight?c=!1:0<b.maxHeight&&b.maxHeight<a.minHeight&&
(c=!1);-1!=registeredTabData[a.tabID].channelResourceHistory.indexOf(b.id)&&(d=!1);intentlyData.channelResourceHistory[b.id].lastUsedTimestamp>(new Date).getTime()-Conf.MINIMUM_REPLACEMENT_TIME_PERIOD&&(d=!1);b.originalChannelID!=Conf.ADMIN_CHANNEL_ID||considerAdminIntentions||(g=!1);c&&d&&g?e.push(b):intentlyData.channelResourceHistory[b.id].timesSinceLastUse<intentlyData.channelResources.length&&intentlyData.channelResourceHistory[b.id].timesSinceLastUse++});if(0<e.length){for(var r=null,k=[],q=
0;q<e.length;q++){var l=0,u=0<e[q].maxHeight?e[q].maxHeight:Conf.MAX_PIXEL_SIZE,t=0<e[q].maxWidth?e[q].maxWidth:Conf.MAX_PIXEL_SIZE,w=e[q].width/e[q].height,v="",l=a.width/a.height;l>w?v="h":l<w&&(v="w");"w"==v?(e[q].resourceWidth=t>a.width?a.width:t,e[q].containerWidth=e[q].resourceWidth,e[q].resourceHeight=e[q].resourceWidth/w,e[q].containerHeight=a.height):"h"==v?(e[q].resourceHeight=u>a.height?a.height:u,e[q].containerHeight=e[q].resourceHeight,e[q].resourceWidth=e[q].resourceHeight*w,e[q].containerWidth=
a.width):(e[q].resourceWidth=t>a.width?a.width:t,e[q].containerWidth=a.width,e[q].resourceHeight=u>a.height?a.height:u,e[q].containerHeight=a.height);e[q].pixelUtilizationScore=e[q].resourceWidth*e[q].resourceHeight*100/p;e[q].historicalScore=100*intentlyData.channelResourceHistory[e[q].id].timesSinceLastUse/intentlyData.channelResources.length;100<e[q].historicalScore&&(e[q].historicalScore=100);e[q].algorithmScore=e[q].pixelUtilizationScore*Conf.REPLACEMENT_PIXEL_UTILIZATION_WEIGHT+e[q].historicalScore*
Conf.REPLACEMENT_HISTORICAL_USE_WEIGHT;e[q].userID==Conf.USER_ID&&(e[q].algorithmScore*=Conf.REPLACEMENT_AUTHORSHIP_WEIGHT);"1"==e[q].honeymoon&&(l=((new Date).getTime()-(new Date(e[q].honeymoonTimestamp+" UTC")).getTime())/Conf.REPLACEMENT_HONEYMOON_DECAY_PERIOD,1<l&&(l=1),e[q].algorithmScore*=Conf.REPLACEMENT_HONEYMOON_WEIGHT-l*Conf.REPLACEMENT_HONEYMOON_DECAY);"1"==e[q].impression&&(l=((new Date).getTime()-(new Date(e[q].impressionTimestamp+" UTC")).getTime())/Conf.IMPRESSION_WEIGHT_DECAY_PERIOD,
1<l&&(l=1),e[q].algorithmScore*=Conf.IMPRESSION_WEIGHT-l*Conf.IMPRESSION_WEIGHT_DECAY)}for(q=e.length-1;0<=q;q--)(e[q].resourceWidth/a.width<Conf.MINIMUM_REPLACEMENT_WIDTH_UTILIZATION_RATIO||e[q].resourceHeight/a.height<Conf.MINIMUM_REPLACEMENT_HEIGHT_UTILIZATION_RATIO)&&e.splice(q,1);for(q=0;q<e.length;q++)e[q].algorithmScore>r||null==r?(r=e[q].algorithmScore,k=[q]):e[q].algorithmScore==r&&k.push(q);if(0<k.length){d=k[Math.floor(Math.random()*k.length)];for(q=0;q<e.length;q++)e[q]!=d&&intentlyData.channelResourceHistory[e[q].id].timesSinceLastUse<
intentlyData.channelResources.length&&intentlyData.channelResourceHistory[e[q].id].timesSinceLastUse++;intentlyData.channelResourceHistory[e[d].id].timesSinceLastUse=0;intentlyData.channelResourceHistory[e[d].id].lastUsedTimestamp=(new Date).getTime();d=e[d]}}a.channelResourceID=null;d&&("1"==d.userID&&(Utils.log("Admin intention selected, no more for a while..."),considerAdminIntentions=!1),d.impression=d.impression?"1"==d.impression?!0:!1:-1,q=d.containerWidth,p=d.resourceWidth,r=d.containerHeight,
k=d.resourceHeight,t=0,p<q&&(t=(q-p)/2),w=0,k<r&&(w=(r-k)/2),u=0,u=g?k:r,l="<div "+('intentlyReplacementID="'+a.intentlyID+'" '),l+='channelResourceID="'+d.id+'" ',l+='impression="'+d.impression+'" ',l+='style="'+a.replacementStyles,l+="visibility: visible; ",l+="height: "+u+"px; ",l+="width: "+q+"px; ",l+='">',l+="<div ",l+='intentlyReplacementParentID="'+a.intentlyID+'" ',l+='style="background-color: transparent; ',l+="height: "+(g?k:r)+"px; ",l+="width: "+q+"px; ",w>Conf.MAXIMUM_REPLACEMENT_VERTICAL_MARGIN&&
(w=Conf.MAXIMUM_REPLACEMENT_VERTICAL_MARGIN),l+="margin-top: "+w+"px; ",l+="margin-bottom: "+w+"px; ",l+="margin-left: "+t+"px; ",l+="margin-right: "+t+"px; ",l+='">',l+="<img ",l+='intentlyReplacementParentID="'+a.intentlyID+'" ',l+='style="',l+="width: "+p+"px; ",l+="height: "+k+"px; ",l+='" ',l+='src="https://'+Conf.CDN_DOMAIN+"/full/"+d.cdnFileName+'" ',l+="/>",l+="<div ",l+='intentlyReplacementParentID="'+a.intentlyID+'" ',l+='class="intentlyImpressionOverlay" ',l+='destination="'+Conf.API_URL+
Conf.INTENTIONCLICK_LOG_PATH+"/"+d.id+'" ',l+='style="position: absolute; ',l+="width: "+p+"px; ",l+="height: "+k+"px; ",l+="margin-top: -"+k+"px; ",l+='cursor: pointer;" ',l+=">",g="square",250<=u&&250<=q&&(g="horizontal"),u="layout-"+g+"-thumbsup",t="layout-"+g+"-thumbsdown",w="layout-"+g+"-fb",v="layout-"+g+"-share",l+="<div ",l+='id="thumbsUpImpressionButton-'+a.intentlyID+'" ',l+='intentlyReplacementParentID="'+a.intentlyID+'" ',l+='channelResourceID="'+d.id+'" ',l+='impressionValue="1" ',l+=
'activeSrc="'+vAPI.getURL("/img/browsericons/thumbsUp-lg.png")+'" ',l+='inactiveSrc="'+vAPI.getURL("/img/browsericons/thumbsUp-active.png")+'" ',l+='activeClass="intentlyImpressionButton" ',l+='inactiveClass="" ',!0===d.impression?(l+='style="background-image:url('+vAPI.getURL("/img/browsericons/thumbsUp-active.png")+')"',l+="impressionState=active ",l+='class="'+u+'"'):(l+='class="intentlyImpressionButton '+u+'" ',l+='style="background-image:url('+vAPI.getURL("/img/browsericons/thumbsUp-lg.png")+
')"',l+="impressionState=inactive "),l+=">&nbsp;</div>","square"!==g&&(l+='<div class="layout-horizontal-thumbsup-text" ',l+='id="thumbsUptextImpressionButton-'+a.intentlyID+'" ',l+='data-target-id="thumbsUpImpressionButton-'+a.intentlyID+'" > Show this image more often </div>'),l+="<div ",l+='id="shareIntentionButton-'+a.intentlyID+'" ',l+='class="intentlyShareButton '+v+'" ',l+='intentlyReplacementParentID="'+a.intentlyID+'" ',l+='channelResourceID="'+d.id+'" ',l+='data-imgURL="https://'+Conf.CDN_DOMAIN+
"/full/"+d.cdnFileName+'" ',l+='style="background-image:url('+vAPI.getURL("/img/browsericons/share-lg.png")+')"',l+=">&nbsp;</div>",l+="<div ",l+='id="thumbsDownImpressionButton-'+a.intentlyID+'" ',l+='intentlyReplacementParentID="'+a.intentlyID+'" ',l+='channelResourceID="'+d.id+'" ',l+='impressionValue="0" ',l+='activeSrc="'+vAPI.getURL("/img/browsericons/thumbsDown-lg.png")+'" ',l+='inactiveSrc="'+vAPI.getURL("/img/browsericons/thumbsDown-active.png")+'" ',l+='activeClass="intentlyImpressionButton" ',
l+='inactiveClass="" ',!1===d.impression?(l+='style="background-image:url('+vAPI.getURL("/img/browsericons/thumbsDown-active.png")+')"',l+="impressionState=active ",l+='class="'+t+'" '):(l+='class="intentlyImpressionButton '+t+'" ',l+='style="background-image:url('+vAPI.getURL("/img/browsericons/thumbsDown-lg.png")+')"',l+="impressionState=inactive "),l+=">&nbsp;</div>",l+="<div ",l+='id="facebookShareIntentionButton-'+a.intentlyID+'" ',l+='class="intentlyFacebookShareButton '+w+'" ',l+='intentlyReplacementParentID="'+
a.intentlyID+'" ',l+='channelResourceID="'+d.id+'" ',l+='style="background-image:url('+vAPI.getURL("/img/browsericons/facebook-lg.png")+')"',l+=">&nbsp;</div>",l+="</div>",l+="</div>",l+="</div>",a.channelResourceID=d.id,a.containerHeight=r,a.containerWidth=q,a.resourceHeight=k,a.resourceWidth=p,a.replacementHTML=l,a.replacementResourceData=d.base64,a.replacementDestination=d.destination);return a},c=function(a,b,c){a&&b&&(0===a.indexOf("data:image")?alert("Sorry, this image is data-encoded and cannot be imported from this page."):
(Utils.log("opening intention review page for image URL "+a),a="?imageURL="+encodeURIComponent(a)+"&pageURL="+encodeURIComponent(b)+"&description="+encodeURIComponent(c),vAPI.tabs.open({url:Conf.CHANNEL_RESOURCE_REVIEW_URL+a})))},e=function(b,e,m){if(e){var n=e.pageURL;if("loadconfig"!=e.messageType||1!=a.getNetFilteringSwitch(n)||1!=extension.intentlyEnabled&&0!=extension.intentlyActive)if("identifiedads"==e.messageType&&0<e.identifiedAds.length){activeReplacementOperations[b]={};activeReplacementOperations[b].id=
replacementOperationCounter;replacementOperationCounter++;activeReplacementOperations[b].identifiedAds=e.identifiedAds;Utils.log(activeReplacementOperations[b].identifiedAds.length+" ads identified on tab id "+b+" ("+n+").");(new Date).getTime()>=registeredTabData[b].registrationTimestamp+Conf.TAB_REPLACEMENT_HISTORY_EXPIRATION&&(Utils.log("clearing stale resource replacement history for tab id "+b+" ("+n+")."),registeredTabData[b].channelResourceHistory=[]);var g=[];activeReplacementOperations[b].identifiedAds.forEach(function(a){a.tabID=
b;a=d(a,e.pageURL);a.channelResourceID?registeredTabData[b].channelResourceHistory.push(a.channelResourceID):Utils.log("hiding ad",a);g.push(a)});p={messageType:"instruction",instruction:"replaceads",adReplacements:g};Utils.log("sending replaceads instruction to tab id "+b+" ("+n+")");activeReplacementOperations[b].replaceAdsBegin=(new Date).getTime();m(p)}else if("response"==e.messageType)if("adsreplaced"==e.response&&activeReplacementOperations[b]){if(activeReplacementOperations[b].replaceAdsEnd=
(new Date).getTime(),activeReplacementOperations[b].replaceAdsDuration=(activeReplacementOperations[b].replaceAdsEnd-activeReplacementOperations[b].replaceAdsBegin)/1E3,activeReplacementOperations[b].replacedAds=e.replacedAds,activeReplacementOperations[b].replacedAds&&0<activeReplacementOperations[b].replacedAds.length){extension.pushAdReplaceCount(activeReplacementOperations[b].replacedAds.length,function(){});Utils.log(activeReplacementOperations[b].replacedAds.length+" ads replaced on tab id "+
b+" ("+n+") in "+activeReplacementOperations[b].replaceAdsDuration+" seconds.");Utils.log(activeReplacementOperations[b].replacedAds);var r=activeReplacementOperations[b].id;replacementOperationLog[r]=activeReplacementOperations[b];delete activeReplacementOperations[b];var k=0,q=[];replacementOperationLog[r].replacedAds.forEach(function(a){a.timestamp==k&&a.timestamp++;var b={};b.channelResourceID=a.channelResourceID;b.adHeight=parseInt(a.height);b.adWidth=parseInt(a.width);b.resourceHeight=parseInt(a.resourceHeight);
b.resourceWidth=parseInt(a.resourceWidth);b.timestamp=a.timestamp;q.push(b);k=a.timestamp});Utils.log("logging "+q.length+" replaced ads from tab id "+b+" ("+n+")");replacementOperationLog[r].logReplacedAdsBegin=(new Date).getTime();extension.ajax({method:"POST",url:Conf.API_URL+Conf.REPLACEMENT_LOG_PATH,data:JSON.stringify(q),success:function(a,c,d){a&&!0===a.success&&a.data&&replacementOperationLog[r]&&a.data==replacementOperationLog[r].replacedAds.length?(replacementOperationLog[r].logReplacedAdsEnd=
(new Date).getTime(),replacementOperationLog[r].logReplacedAdsDuration=(replacementOperationLog[r].logReplacedAdsEnd-replacementOperationLog[r].logReplacedAdsBegin)/1E3,Utils.log(q.length+" replaced ads logged from tab id "+b+" ("+n+") in "+replacementOperationLog[r].logReplacedAdsDuration+" seconds.")):Utils.log("something went wrong with logging...");delete replacementOperationLog[r]}})}}else"lastrightclickadidentified"==e.response?e.lastRightClickAd?(Utils.log("reporting identified ad to API:"),
extension.ajax({method:"POST",url:Conf.API_URL+Conf.REPORT_AD_PATH,data:JSON.stringify(e.lastRightClickAd),success:function(a,b,c){!0===a.success?(a={type:"basic",title:"Intently Ad Identified",message:"Thank you for your help in making the Internet a more fulfilling place! The ad has been successfully reported to the Intently system for verification.",alert:"Thank you for your help in making the Internet a more fulfilling place! The ad has been successfully reported to the Intently system for verification.",
iconUrl:"img/browsericons/intentlyLogo128.png"},issueAlert("intentlyAdIdentifySuccess",a)):(a={type:"basic",title:"Intently Ad Identification Error",message:"Whoops! Something unexpected happened while reporting the identified ad to the Intently system. This error has been recorded and will be reviewed by the Intently technical team.",alert:"Whoops! Something unexpected happened while reporting the identified ad to the Intently system. This error has been recorded and will be reviewed by the Intently technical team.",
iconUrl:"img/browsericons/intentlyLogo128.png"},issueAlert("intentlyAdIdentifyFailure",a))}})):(Utils.log("ad could not be identified or has already been identified."),m={type:"basic",title:"Intently Ad Not Identified",message:"Either the ad could not be identified or has already been identified.",alert:"Either the ad could not be identified or has already been identified.",iconUrl:"img/browsericons/intentlyLogo128.png"},issueAlert("intentlyAdIdentifyFailure",m)):"lastrightclickintentionidentified"==
e.response&&c(e.lastRightClickIntentionURL,e.lastRightClickIntentionPageURL,e.lastRightClickIntentionDescription);else if("useraction"==e.messageType)if("impressionbuttonclicked"==e.action){if(e.impressionButtonClickData)for(Utils.log("logging impression button click:"),e.impressionButtonClickData.userID=Conf.USER_ID,m="0"===e.impressionButtonClickData.impression?Conf.CHANNEL_RESOURCE_DISLIKE_PATH:Conf.CHANNEL_RESOURCE_LIKE_PATH,m+="/"+e.impressionButtonClickData.channelResourceID,extension.ajax({method:"POST",
url:Conf.API_URL+m,data:JSON.stringify(e.impressionButtonClickData),success:function(a,b,c){!0===a.success?a.data&&1===a.data.length?Utils.log("channelresourceuserimpression logged with id "+a.data[0]):Utils.log("channelresourceuserimpression updated"):Utils.log("failed to log channelresourceuserimpressions")}}),m=0;m<intentlyData.channelResources.length;m++)intentlyData.channelResources[m].id==e.impressionButtonClickData.channelResourceID&&("0"===e.impressionButtonClickData.impression?intentlyData.channelResources.splice(m,
1):intentlyData.channelResources[m].impression="1")}else if("sharebuttonclicked"==e.action){Utils.log("opening share window for channelResourceID "+e.shareButtonClickData.channelResourceID);p="[]";intentlyData.connections&&null!=intentlyData.connections&&void 0!=intentlyData.connections&&(p=JSON.stringify(intentlyData.connections));var l;l="<script>"+('intentlyShareDialog.intention = { "id": "'+e.shareButtonClickData.channelResourceID+'", "imgURL": "'+e.shareButtonClickData.imgURL+'"};');l+='intentlyShareDialog.cdnRoot = "https://'+
Conf.CDN_DOMAIN+'/";';l+='intentlyShareDialog.appURL = "https://www.'+Conf.DOMAIN+'/";';l=l+("intentlyShareDialog.friends = "+p+";")+("intentlyShareDialog.apiBase = '"+Conf.API_URL+"';");l+='intentlyShareDialog.closeiconurl = "'+vAPI.getURL("shareDialog/close.png")+'";';l+='intentlyShareDialog.defaultFriendIconURL = "'+vAPI.getURL("shareDialog/intentlyAvatar.png")+'";';l+='intentlyShareDialog.closehovericonurl = "'+vAPI.getURL("shareDialog/close-hover.png")+'";';l+='intentlyShareDialog.searchiconurl = "'+
vAPI.getURL("shareDialog/search.png")+'";';l+="$(document).ready(function() { intentlyShareDialog.init(); });";l+="\x3c/script>";p={messageType:"instruction",instruction:"opensharemodal",shareurl:Conf.CHANNEL_RESOURCE_SHARE_URL+"/"+e.shareButtonClickData.channelResourceID,resourceID:e.shareButtonClickData.channelResourceID,frameurl:vAPI.getURL("/shareDialog/shareDialog.html"),framedoc:'<html lang="en"><head> <meta charset="UTF-8"> <title>Intently Share Dialog</title>'+extension.framedata.cssShareDialog+
extension.framedata.jsJquery+'</head><body><input id="transmitter"  type="text" style="visibility:hidden" /> <div id="intentlySharedCard"> <div id="intentlyShareClose"></div><div id="intentlyShareHeader">Share Image</div><div id="intentlyShareImage"></div><div id="intentlyShareSearchBar"> <input id="intentlyShareSearch" class="app-popup-text-search intentlyShareSearchEmailHidden" type="text" placeholder="Name or Email"/> <div id="intentlyShareInvite" class="intentlyShareInviteHidden hidden" ></div></div><div id="intentlyShareFriendsList"> </div><div id="intentlyShareFacebookTrigger"> <div class="intentlyFriendIcon intentlyFacebook"> </div><div class="intentlyUserTitle"> Share Via Facebook </div></div></div>'+
extension.framedata.jsShareDialog+l+"</body></html>",connections:p};Utils.log("sending Shareclickdata to  to tab id "+b+" ("+n+")");m(p)}else"emailinvite"==e.action?(Utils.log("sending emailinvite"),extension.ajax({method:"POST",data:JSON.stringify(e.data),url:Conf.API_URL+"invites/emailinvite/"+e.data.channelResourceID,success:function(a,b,c){issueAlert("sentemails",{type:"basic",title:"Email Image",message:a.message,alert:a.message,iconUrl:"img/browsericons/intentlyLogo128.png"})}})):"openurl"==
e.action?vAPI.tabs.open({url:e.data.url}):"sharechannelresource"==e.action?(Utils.log("sending share Channel resource "),extension.ajax({method:"POST",data:JSON.stringify(e.data),url:Conf.API_URL+"connections/sharechannelresource/"+e.imageid+"/"+e.friendid,success:function(a,b,c){issueAlert("sentemails",{type:"basic",title:"Share Image",message:a.message,alert:a.message,iconUrl:"img/browsericons/intentlyLogo128.png"})}})):"intendbuttonclicked"==e.action?(Utils.log("Got messageData.action intendbuttonclicked "),
m({messageType:"instruction",instruction:"hideintend"}),c(e.intendButtonClickData.imageURL,e.intendButtonClickData.pageURL,e.intendButtonClickData.description)):"facebooksharebuttonclicked"==e.action&&(Utils.log("opening facebook share window for channelResourceID "+e.facebookShareButtonClickData.channelResourceID),"Safari"==Conf.BROWSER_NAME?vAPI.tabs.open({url:Conf.CHANNEL_RESOURCE_FACEBOOK_SHARE_URL+"/"+e.facebookShareButtonClickData.channelResourceID}):(m=window.screen.width/2-310,p=window.screen.height/
2-350,window.open(Conf.CHANNEL_RESOURCE_FACEBOOK_SHARE_URL+"/"+e.facebookShareButtonClickData.channelResourceID,"sharer","status=no,height=600,width=600,resizable=yes,left="+m+",top="+p+",screenX="+m+",screenY="+p+",toolbar=no,menubar=no,scrollbars=no,location=no,directories=no")));else"usernotification"==e.messageType?(Utils.log("issuing user notification."),m={type:"basic",title:e.title,message:e.message,alert:e.message,iconUrl:"img/browsericons/intentlyLogo128.png"},issueAlert("addIntentionFailure",
m)):"contentscripterror"==e.messageType?(Utils.log("Error received"),Utils.log(e),processError("content",e.error,e.details)):"adblockerdetected"!=e.messageType||intentlyData.adBlockerNotificationIssued||(intentlyData.adBlockerNotificationIssued=!0,Utils.log("issuing ad blocker detection notification."),m={type:"basic",title:"Another Ad Blocker Detected",message:"Intently has detected another ad blocker installed on your browser. In order for intently to operate, please disable other ad blockers.",
alert:"Intently has detected another ad blocker installed on your browser. In order for intently to operate, please disable other ad blockers.",iconUrl:"img/browsericons/intentlyLogo128.png"},issueAlert("adblockerdetected",m));else{var p=extension.getConfig(n);null!=p&&(void 0!=registeredTabData[b]&&delete registeredTabData[b],registeredTabData[b]={registrationTimestamp:(new Date).getTime(),channelResourceHistory:[]},m(p))}}};vAPI.messaging.handleIntentlyMsg=function(a,b,c){return e(a,b,c)};vAPI.messaging.listen("intently-content.js",
function(a,b,c){switch(a.what){case "intently":b&&b.tab?e(b.tab.id,a,c):console.log("Error tab id is empty",b);break;default:return vAPI.messaging.UNHANDLED}})})();
(function(){vAPI.messaging.listen("intently-client.js",function(a,b,d){switch(a.what){case "intently":b&&b.tab?"login"==a.action?(a={data:a.data,url:Conf.API_LOGIN_URL},extension.login(a)):"logout"==a.action?(a={data:a.data,url:Conf.API_LOGOUT_URL},extension.logout(a)):"refresh_client_data"==a.action&&OnRefreshCookies(d):console.log("Error tab id is empty",b);break;default:return vAPI.messaging.UNHANDLED}})})();
var quickProfiler=function(){var a=window.performance||Date;"undefined"===typeof a.now&&(a.now=a.webkitNow);var b=0,d=0,c=0,e=a.now(),f="";return{reset:function(){c=d=b=0},start:function(b){f=b||"";c=a.now()},stop:function(h){void 0===h&&(h=1E4);var m=a.now();d+=1;b+=m-c;m-e>=h&&(console.log("µBlock> %s: %s ms (%d samples)",f,(0<d?b/d:0).toFixed(3),d),e=m)}}}();"use strict";
\u00b5Block.getBytesInUse=function(a){"function"!==typeof a&&(a=this.noopFunc);vAPI.storage.getBytesInUse(null,function(b){\u00b5Block.storageUsed=b;a(b)})};\u00b5Block.keyvalSetOnePref=function(a,b,d){var c={};c[a]=b;vAPI.storage.preferences.set(c,d||this.noopFunc)};\u00b5Block.saveLocalSettings=function(a){a&&(this.localSettingsModifyTime=Date.now());this.localSettingsModifyTime<=this.localSettingsSaveTime||(this.localSettingsSaveTime=Date.now(),vAPI.storage.preferences.set(this.localSettings))};
\u00b5Block.asyncJobs.add("autoSaveLocalSettings",null,\u00b5Block.saveLocalSettings.bind(\u00b5Block),24E4,!0);\u00b5Block.saveUserSettings=function(){vAPI.storage.preferences.set(this.userSettings)};\u00b5Block.savePermanentFirewallRules=function(){this.keyvalSetOnePref("dynamicFilteringString",this.permanentFirewall.toString())};\u00b5Block.saveWhitelist=function(){var a={netWhitelist:this.stringFromWhitelist(this.netWhitelist)};vAPI.storage.preferences.set(a);this.netWhitelistModifyTime=Date.now()};
\u00b5Block.extractSelectedFilterLists=function(a){var b=this;this.assets.get("assets/ublock/filter-lists.json",function(d){var c;try{c=JSON.parse(d.content)}catch(h){c={}}d=JSON.parse(JSON.stringify(b.remoteBlacklists));var e,f;for(f in d)!1!==d.hasOwnProperty(f)&&(e=f.replace(/^assets\/thirdparties\//,""),e=!1===c.hasOwnProperty(e)||!0===c[e].off,!0===d[f].off&&d[f].off===e&&delete d[f]);a(d)})};
\u00b5Block.saveUserFilters=function(a,b){vAPI.storage.preferences.set({userFilters:a});this.assets.put(this.userFiltersPath,a,b)};\u00b5Block.loadUserFilters=function(a){return this.assets.get(this.userFiltersPath,a)};
\u00b5Block.appendUserFilters=function(a){if(0!==a.length){var b=this,d=function(){var c=b.compileFilters(a),d=b.staticNetFilteringEngine,f=b.cosmeticFilteringEngine,h=d.acceptedCount+f.acceptedCount,m=d.duplicateCount+f.duplicateCount;b.applyCompiledFilters(c);c=b.remoteBlacklists[b.userFiltersPath];h=d.acceptedCount+f.acceptedCount-h;d=h-(d.duplicateCount+f.duplicateCount-m);c.entryCount+=h;c.entryUsedCount+=d;vAPI.storage.preferences.set({remoteBlacklists:b.remoteBlacklists});b.staticNetFilteringEngine.freeze();
b.cosmeticFilteringEngine.freeze()};this.loadUserFilters(function(c){b.saveUserFilters(c.content.trim()+"\n\n"+a.trim(),d)})}};
\u00b5Block.getAvailableLists=function(a){var b={},d={},c=function(a){!1===/^https?:/.test(a)&&(a="assets/thirdparties/"+a);return a},e=function(c){var e=\u00b5Block;c=c.remoteBlacklists;for(var f=Object.keys(c),h,m,l,n;h=f.pop();)l=c[h],n=!0===l.off,d.hasOwnProperty(h)&&(e.purgeFilterList(h),h=d[h],n&&c.hasOwnProperty(h)&&(n=!0===c[h].off)),m=b[h],void 0===m?e.purgeFilterList(h):(m.off=n,e.assets.setHomeURL(h,m.homeURL),void 0!==l.entryCount&&(m.entryCount=l.entryCount),void 0!==l.entryUsedCount&&
(m.entryUsedCount=l.entryUsedCount),""===m.title&&"string"===typeof l.title&&""!==l.title&&(m.title=l.title));a(b)},f,h=this.permanentLists;for(f in h)!1!==h.hasOwnProperty(f)&&(b[f]=h[f]);for(var m=this.userSettings.externalLists.split("\n"),n=0;n<m.length;n++)f=m[n].trim(),h=f.charAt(0),""!==f&&"!"!==h&&"#"!==h&&(/[^0-9A-Za-z!*'();:@&=+$,\/?%#\[\]_.~-]/.test(f)||(b[f]={title:"",group:"custom",external:!0}));this.assets.get("assets/ublock/filter-lists.json",function(a){var g,f;try{f=JSON.parse(a.content)}catch(h){f=
{}}for(g in f)!1!==f.hasOwnProperty(g)&&(a=f[g],g=c(g),"string"===typeof a.oldLocation&&(a.oldLocation=c(a.oldLocation),d[a.oldLocation]=g),b[g]=a);vAPI.storage.preferences.get({remoteBlacklists:b},e)})};\u00b5Block.createShortUniqueId=function(a){a=YaMD5.hashStr(a);return a.slice(0,4)+a.slice(-4)};\u00b5Block.createShortUniqueId.idLength=8;
\u00b5Block.loadFilterLists=function(a){var b=this,d=0;"function"!==typeof a&&(a=this.noopFunc);b.assets.remoteFetchBarrier+=1;var c=function(){--b.assets.remoteFetchBarrier;b.staticNetFilteringEngine.freeze();b.cosmeticFilteringEngine.freeze();vAPI.storage.preferences.set({remoteBlacklists:b.remoteBlacklists});vAPI.messaging.broadcast({what:"allFilterListsReloaded"});a();b.toSelfieAsync()},e=function(a){var e=a.path,m=b.staticNetFilteringEngine,n=b.cosmeticFilteringEngine,p=m.acceptedCount+n.acceptedCount,
g=m.duplicateCount+n.duplicateCount;b.applyCompiledFilters(a.content);b.remoteBlacklists.hasOwnProperty(e)&&(a=b.remoteBlacklists[e],a.entryCount=m.acceptedCount+n.acceptedCount-p,a.entryUsedCount=a.entryCount-(m.duplicateCount+n.duplicateCount-g));--d;0===d&&c()};this.getAvailableLists(function(a){b.remoteBlacklists=a;b.cosmeticFilteringEngine.reset();b.staticNetFilteringEngine.reset();b.destroySelfie();var h=[],m;for(m in a)!1!==a.hasOwnProperty(m)&&(a[m].off||h.push(m));d=h.length;if(0===d)c();
else for(a=h.length;a--;)b.getCompiledFilterList(h[a],e)})};\u00b5Block.getCompiledFilterListPath=function(a){return"cache://compiled-filter-list:"+this.createShortUniqueId(a)};
\u00b5Block.getCompiledFilterList=function(a,b){var d=this.getCompiledFilterListPath(a),c=this,e=function(e){if(""!==e.content){var h=c.remoteBlacklists[a];if(h&&""===h.title){var m=e.content.slice(0,1024).match(/(?:^|\n)!\s*Title:([^\n]+)/i);null!==m&&(h.title=m[1].trim())}e.content=c.compileFilters(e.content);c.assets.put(d,e.content)}b(e)};this.assets.get(d,function(d){""===d.content?c.assets.get(a,e):(d.path=a,b(d))})};\u00b5Block.purgeCompiledFilterList=function(a){this.assets.purge(this.getCompiledFilterListPath(a))};
\u00b5Block.purgeFilterList=function(a){this.purgeCompiledFilterList(a);this.assets.purge(a)};
\u00b5Block.compileFilters=function(a){for(var b=a.length,d=[],c=this.staticNetFilteringEngine,e=this.cosmeticFilteringEngine,f=/\s/,h=/^[\d:f]/,m=/\s+(?:broadcasthost|local|localhost|localhost\.localdomain)(?=\s|$)/,n=/^(?:0\.0\.0\.0|127\.0\.0\.1|::1|fe80::1%lo0)/,p=0,g,r,k;p<b;)if(g=a.indexOf("\n",p),-1===g&&(g=a.indexOf("\r",p),-1===g&&(g=b)),r=a.slice(p,g).trim(),p=g+1,0!==r.length&&(g=r.charAt(0),"!"!==g&&"["!==g&&!e.compile(r,d)&&"#"!==g)){k=r.indexOf("#");-1!==k&&f.test(r.charAt(k-1))&&(r=
r.slice(0,k).trim());if(h.test(g)){if(m.test(r))continue;r=r.replace(n,"").trim()}0!==r.length&&c.compile(r,d)}return d.join("\n")};\u00b5Block.applyCompiledFilters=function(a){for(var b=!this.userSettings.parseAllABPHideFilters,d=this.staticNetFilteringEngine,c=this.cosmeticFilteringEngine,e=0,f=a.length;e<f;)e=c.fromCompiledContent(a,e,b),e=d.fromCompiledContent(a,e)};
\u00b5Block.selectFilterLists=function(a){a=a||{};for(var b=this.remoteBlacklists,d,c,e=a.length;e--;)d=a[e],c=!0===d.off,d=d.location,!1===b.hasOwnProperty(d)?!0!==c&&(b[d]={off:c}):b[d].off!==c&&(b[d].off=c);vAPI.storage.preferences.set({remoteBlacklists:b})};\u00b5Block.reloadAllFilters=function(){var a=this;this.assets.autoUpdate=!1;this.loadFilterLists(function(){a.assets.autoUpdate=a.userSettings.autoUpdate})};
\u00b5Block.loadPublicSuffixList=function(a){var b=this,d=b.pslPath;"function"!==typeof a&&(a=this.noopFunc);var c=function(c){""!==c.content&&(publicSuffixList.parse(c.content,punycode.toASCII),b.assets.put("cache://compiled-publicsuffixlist",JSON.stringify(publicSuffixList.toSelfie())));a()};this.assets.get("cache://compiled-publicsuffixlist",function(e){""===e.content?b.assets.get(d,c):(publicSuffixList.fromSelfie(JSON.parse(e.content)),a())})};
\u00b5Block.toSelfie=function(){var a={magic:this.systemSettings.selfieMagic,publicSuffixList:publicSuffixList.toSelfie(),filterLists:this.remoteBlacklists,staticNetFilteringEngine:this.staticNetFilteringEngine.toSelfie(),cosmeticFilteringEngine:this.cosmeticFilteringEngine.toSelfie()};vAPI.storage.set({selfie:a})};\u00b5Block.toSelfieAsync=function(a){"number"!==typeof a&&(a=this.selfieAfter);this.asyncJobs.add("toSelfie",null,this.toSelfie.bind(this),a,!1)};
\u00b5Block.destroySelfie=function(){vAPI.storage.remove("selfie");this.asyncJobs.remove("toSelfie")};\u00b5Block.updateStartHandler=function(a){var b=this;this.getAvailableLists(function(d){var c={},e;for(e in d)!1!==d.hasOwnProperty(e)&&(d[e].off||(c[e]=!0));c[b.pslPath]=!0;c["assets/ublock/mirror-candidates.txt"]=!0;a(c)})};
\u00b5Block.assetUpdatedHandler=function(a){var b=a.path||"";!1!==this.remoteBlacklists.hasOwnProperty(b)&&(this.remoteBlacklists[b].off||this.assets.put(this.getCompiledFilterListPath(b),this.compileFilters(a.content)))};
\u00b5Block.updateCompleteHandler=function(a){var b=this,d=a.updatedCount;b.assets.remoteFetchBarrier+=1;var c=function(){--b.assets.remoteFetchBarrier},e=function(){0!==d?b.loadFilterLists(c):c()};a.hasOwnProperty("assets/ublock/mirror-candidates.txt");a.hasOwnProperty(this.pslPath)?(this.loadPublicSuffixList(e),--d):e()};
\u00b5Block.assetCacheRemovedHandler=function(){var a=!1;return function(b){if(!a){a=!0;for(var d=b.length,c;d--;)c=b[d],this.remoteBlacklists.hasOwnProperty(c)?this.purgeCompiledFilterList(c):c===this.pslPath&&this.assets.purge("cache://compiled-publicsuffixlist");this.destroySelfie();a=!1}}}();
\u00b5Block.logger=function(){var a=function(a,b){this.init(a,b)},b=[];a.prototype.init=function(a,b){this.tstamp=Date.now();this.url=a.requestURL;this.hostname=a.requestHostname;this.type=a.requestType;this.result=b;return this};a.prototype.dispose=function(){this.url=this.hostname=this.type=this.result="";100>b.length&&b.push(this)};var d=function(){this.lastReadTime=0;this.size=50;this.buffer=Array(this.size);this.writePtr=this.readPtr=0};d.prototype.dispose=function(){for(var b,c=this.buffer.length;c--;)b=
this.buffer[c],b instanceof a&&b.dispose();return this.buffer=null};d.prototype.writeOne=function(c,d){var e=this.buffer[this.writePtr];if(!1===e instanceof a){var e=this.buffer,f=this.writePtr,g;g=(g=b.pop())?g.init(c,d):new a(c,d);e[f]=g}else e.init(c,d);this.writePtr+=1;this.writePtr===this.size&&(this.writePtr=0);this.writePtr===this.readPtr&&(e=this.buffer.slice(0,this.writePtr),f=Math.ceil(1.5*this.size),this.size+=e.length,this.size<f?(this.buffer=this.buffer.concat(e,Array(f-this.size)),this.writePtr=
this.size):(this.buffer=this.buffer.concat(e),this.writePtr=0),this.size=this.buffer.length)};d.prototype.readAll=function(){var a;a=this.readPtr<this.writePtr?this.buffer.slice(this.readPtr,this.writePtr):this.writePtr<this.readPtr?this.buffer.slice(this.readPtr).concat(this.buffer.slice(0,this.writePtr)):[];this.readPtr=this.writePtr;this.lastReadTime=Date.now();return a};var c={},e=function(){var a,b=Date.now()-3E4,d;for(d in c)!1!==c.hasOwnProperty(d)&&(a=c[d],a.lastReadTime<b&&(a.dispose(),delete c[d]));
setTimeout(e,f)},f=12E4;setTimeout(e,f);return{writeOne:function(a,b,d){!1!==c.hasOwnProperty(a)&&c[a].writeOne(b,d)},readAll:function(a){!1===c.hasOwnProperty(a)&&(c[a]=new d);return c[a].readAll()},isObserved:function(a){return c.hasOwnProperty(a)}}}();
\u00b5Block.PageStore=function(){var a=\u00b5Block,b=[],d=function(a,b){this.init(a,b)};d.prototype.init=function(a,b){this.result=a;this.type=b;this.time=Date.now()};d.prototype.dispose=function(){this.type=this.result="";200>b.length&&b.push(this)};d.factory=function(a,c){var e=b.pop();void 0===e?e=new d(a,c):e.init(a,c);return e};var c=[],e=function(){this.init()};e.factory=function(){var a=c.pop();void 0===a?a=new e:a.init();return a};e.prototype.init=function(){this.urls={};this.count=0;this.shelfLife=
6E4;this.timer=null;this.boundPruneAsyncCallback=this.pruneAsyncCallback.bind(this)};e.prototype.dispose=function(){this.empty();this.boundPruneAsyncCallback=null;10>c.length&&c.push(this);return null};e.prototype.add=function(a,b){var c=a.requestURL,e=a.requestType,f=this.urls[c];void 0!==f?(f.result=b,f.type=e,f.time=Date.now()):(this.urls[c]=d.factory(b,e),0===this.count&&this.pruneAsync(),this.count+=1)};e.prototype.empty=function(){for(var a in this.urls)!1!==this.urls.hasOwnProperty(a)&&this.urls[a].dispose();
this.urls={};this.count=0;null!==this.timer&&(clearTimeout(this.timer),this.timer=null)};e.prototype.compareEntries=function(a,b){return this.urls[b].time-this.urls[a].time};e.prototype.prune=function(){for(var a=Object.keys(this.urls).sort(this.compareEntries.bind(this)),b=Date.now()-this.shelfLife,c,d,e=a.length;e--;){c=a[e];d=this.urls[c];if(d.time>b)break;d.dispose();delete this.urls[c]}this.count-=a.length-e-1;0<this.count&&this.pruneAsync()};e.prototype.pruneAsync=function(){null===this.timer&&
(this.timer=setTimeout(this.boundPruneAsyncCallback,2*this.shelfLife))};e.prototype.pruneAsyncCallback=function(){this.timer=null;this.prune()};e.prototype.lookup=function(a){return this.urls[a.requestType+" "+a.requestURL]};var f=[],h=function(a,b){this.init(a,b)};h.factory=function(a,b){var c=f.pop();void 0===c?c=new h(a,b):c.init(a,b);return c};h.prototype.init=function(b,c){var d=a.URI;this.pageURL=c;this.pageHostname=d.hostnameFromURI(c);this.pageDomain=d.domainFromHostname(this.pageHostname)||
this.pageHostname;return this};h.prototype.dispose=function(){this.pageHostname=this.pageDomain="";50>f.length&&f.push(this);return null};var m=[],n=function(a){this.init(a)};n.factory=function(a){var b=m.pop();void 0===b?b=new n(a):b.init(a);return b};n.prototype.init=function(b){var c=a.tabContextManager.lookup(b);this.tabId=b;this.tabHostname=c.rootHostname;this.hostnameToCountMap={};this.contentLastModified=0;this.frames={};this.netFiltering=!0;this.perLoadAllowedRequestCount=this.perLoadBlockedRequestCount=
this.netFilteringReadTime=0;this.netFilteringCache=e.factory();b=this.createContextFromPage();this.skipCosmeticFiltering="b"===a.staticNetFilteringEngine.matchStringExactType(b,c.normalURL,"cosmetic-filtering").charAt(1);return this};n.prototype.reuse=function(b){a.tabContextManager.lookup(this.tabId).rootHostname!==this.tabHostname&&(b="");if("tabUpdated"===b)return this.netFilteringReadTime=0,this;this.disposeFrameStores();this.netFilteringCache=this.netFilteringCache.dispose();this.init(this.tabId);
return this};n.prototype.dispose=function(){this.hostnameToCountMap=null;this.disposeFrameStores();this.netFilteringCache=this.netFilteringCache.dispose();10>m.length&&m.push(this);return null};n.prototype.disposeFrameStores=function(){var a=this.frames,b;for(b in a)a.hasOwnProperty(b)&&a[b].dispose();this.frames={}};n.prototype.getFrame=function(a){return this.frames[a]||null};n.prototype.setFrame=function(a,b){var c=this.frames[a];c instanceof h?c.init(this.rootHostname,b):this.frames[a]=h.factory(this.rootHostname,
b)};n.prototype.createContextFromPage=function(){var b=new a.tabContextManager.createContext(this.tabId);b.pageHostname=b.rootHostname;b.pageDomain=b.rootDomain;return b};n.prototype.createContextFromFrameId=function(b){var c=new a.tabContextManager.createContext(this.tabId);this.frames.hasOwnProperty(b)?(b=this.frames[b],c.pageHostname=b.pageHostname,c.pageDomain=b.pageDomain):(c.pageHostname=c.rootHostname,c.pageDomain=c.rootDomain);return c};n.prototype.createContextFromFrameHostname=function(b){var c=
new a.tabContextManager.createContext(this.tabId);c.pageHostname=b;c.pageDomain=a.URI.domainFromHostname(b)||b;return c};n.prototype.getNetFilteringSwitch=function(){var b=a.tabContextManager.lookup(this.tabId);if(this.netFilteringReadTime>a.netWhitelistModifyTime&&void 0!=b&&void 0!=b.modifyTime&&this.netFilteringReadTime>b.modifyTime)return this.netFiltering;(this.netFiltering=a.getNetFilteringSwitch(b.normalURL))&&b.rawURL!==b.normalURL&&(this.netFiltering=a.getNetFilteringSwitch(b.rawURL));this.netFilteringReadTime=
Date.now();return this.netFiltering};n.prototype.getSpecificCosmeticFilteringSwitch=function(){if(!1===this.getNetFilteringSwitch())return!1;var b=a.tabContextManager.lookup(this.tabId);return!1===a.userSettings.advancedUserEnabled||!1===a.sessionFirewall.mustAllowCellZY(b.rootHostname,b.rootHostname,"*")};n.prototype.getGenericCosmeticFilteringSwitch=function(){return this.skipCosmeticFiltering?!1:this.getSpecificCosmeticFilteringSwitch()};n.prototype.toggleNetFilteringSwitch=function(b,c,d){a.toggleNetFilteringSwitch(b,
c,d);this.netFilteringCache.empty()};n.prototype.filterRequest=function(a){if(!1===this.getNetFilteringSwitch())return"";var b={};b.tabId=this.tabId;b.url=a.requestURL;b.type=a.requestType;b.rootHostname=a.rootHostname;b.requestHostname=a.requestHostname;b.requestDomain=a.requestDomain;return extension.handlebackgroundrequest(b)};n.prototype.filterRequestNoCache=function(a){if(!1===this.getNetFilteringSwitch())return"";var b={};b.tabId=this.tabId;b.url=a.requestURL;b.type=a.requestType;b.rootHostname=
a.rootHostname;b.requestHostname=a.requestHostname;b.requestDomain=a.requestDomain;return extension.handlebackgroundrequest(b)};n.prototype.logRequest=function(b,c){var d=b.requestHostname;""===d&&(d=b.rootHostname);var e=Date.now();!1===this.hostnameToCountMap.hasOwnProperty(d)&&(this.hostnameToCountMap[d]=0,this.contentLastModified=e);var f=c.charAt(1);""===f||"a"===f?(this.hostnameToCountMap[d]+=65536,this.perLoadAllowedRequestCount++,a.localSettings.allowedRequestCount++):(this.hostnameToCountMap[d]+=
1,this.perLoadBlockedRequestCount++,a.localSettings.blockedRequestCount++);a.localSettingsModifyTime=e};return{factory:n.factory}}();
(function(){var a=\u00b5Block;a.normalizePageURL=function(a,b){if(vAPI.isBehindTheSceneTabId(a))return"http://behind-the-scene/";var d=this.URI.set(b),h=d.scheme;if("https"===h||"http"===h)return d.normalizedURI();var m=h+"-scheme";""!==d.hostname?m=d.hostname+"."+m:"about"===h&&""!==d.path&&(m=d.path+"."+m);return"http://"+m+"/"};a.tabContextManager=function(){var b=Object.create(null),d="",f=0,h=function(a){this.tabId=a.toString();this.stack=[];this.rawURL=this.normalURL=this.rootHostname=this.rootDomain=
"";this.onTimerCallback=this.onTabCallback=this.timer=null;b[a]=this};h.prototype.destroy=function(){vAPI.isBehindTheSceneTabId(this.tabId)||(null!==this.timer&&(clearTimeout(this.timer),this.timer=null),delete b[this.tabId])};h.prototype.onTab=function(a){a?this.timer=setTimeout(this.onTimerCallback,6E5):this.destroy()};h.prototype.onTimer=function(){this.timer=null;vAPI.isBehindTheSceneTabId(this.tabId)||vAPI.tabs.get(this.tabId,this.onTabCallback)};h.prototype.autodestroy=function(){vAPI.isBehindTheSceneTabId(this.tabId)||
(this.onTabCallback=this.onTab.bind(this),this.onTimerCallback=this.onTimer.bind(this),this.timer=setTimeout(this.onTimerCallback,6E5))};h.prototype.update=function(){0===this.stack.length?this.rawURL=this.normalURL=this.rootHostname=this.rootDomain="":(this.rawURL=this.stack[this.stack.length-1],this.normalURL=a.normalizePageURL(this.tabId,this.rawURL),this.rootHostname=a.URI.hostnameFromURI(this.normalURL),this.rootDomain=a.URI.domainFromHostname(this.rootHostname))};h.prototype.push=function(a){if(!vAPI.isBehindTheSceneTabId(this.tabId)){var b=
this.stack.length;if(0===b||this.stack[b-1]!==a)this.stack.push(a),this.update()}};h.prototype.unpush=function(a){vAPI.isBehindTheSceneTabId(this.tabId)||1===this.stack.length||(a=this.stack.indexOf(a),-1!==a&&(this.stack.splice(a,1),0===this.stack.length?this.destroy():a===this.stack.length&&this.update()))};h.prototype.commit=function(a){vAPI.isBehindTheSceneTabId(this.tabId)||(this.stack=[a],this.update())};var m=function(a,m){var k=b[a];void 0===k&&(k=new h(a),k.autodestroy());k.push(m);d=m;f=
Date.now();return k},n=function(a,h){var k;k=void 0!==h?m(a,h):b[a];if(void 0!==k)return k;""!==d&&f+500<Date.now()&&(d="");return""!==d?m(a,d):b[vAPI.noTabId]};(function(){var b=new h(vAPI.noTabId);b.stack.push("");b.rawURL="";b.normalURL=a.normalizePageURL(b.tabId);b.rootHostname=a.URI.hostnameFromURI(b.normalURL);b.rootDomain=a.URI.domainFromHostname(b.rootHostname)})();var p=function(a){a=n(a);this.rootHostname=a.rootHostname;this.rootDomain=a.rootDomain;this.pageHostname=this.pageDomain=this.requestURL=
this.requestHostname=this.requestDomain=""};return{push:m,unpush:function(a,d){var e=b[a];void 0!==e&&e.unpush(d)},commit:function(a,d){var e=b[a];void 0===e?e=m(a,d):e.commit(d);return e},lookup:n,destroy:function(a){a=b[a];void 0!==a&&a.destroy()},exists:function(a){return void 0!==b[a]},createContext:function(a){return new p(a)}}}();vAPI.tabs.onNavigation=function(b){if(0===b.frameId){var d=a.tabContextManager.commit(b.tabId,b.url),f=a.bindTabToPageStats(b.tabId,"afterNavigate");extension.updateBrowserActionFor({id:b.tabId,
url:b.url});f&&0===d.rawURL.lastIndexOf("http",0)&&(f.hostnameToCountMap[d.rootHostname]=0)}};vAPI.tabs.onNewTab=function(a){extension.userLoggedIn||!0!==Conf.SHOW_NEW_TAB_OVERRIDE?extension.intentlyActive&&extension.intentlyEnabled&&(null==Conf.SHOW_NEW_TAB_OVERRIDE||1==Conf.SHOW_NEW_TAB_OVERRIDE)&&vAPI.tabs.replace(a.id,vAPI.getURL("/newtab/newtab.html")):vAPI.tabs.replace(a.id,vAPI.getURL("/newtab/newtab-logout.html"))};vAPI.tabs.onUpdated=function(b,d,f){f.url&&""!==f.url&&d.url&&(a.tabContextManager.commit(b,
d.url),a.bindTabToPageStats(b,"tabUpdated"))};vAPI.tabs.onClosed=function(b){0>b||a.unbindTabFromPageStats(b)};vAPI.tabs.onPopup=function(b){var d=a.tabContextManager.lookup(b.openerTabId),f="";d.tabId===b.openerTabId&&(f=d.normalURL);if(""!==f){var d=a.URI,h=d.hostnameFromURI(f),m=d.domainFromHostname(h),d=b.targetURL,h={pageHostname:h,pageDomain:m,rootHostname:h,rootDomain:m,requestURL:d,requestHostname:a.URI.hostnameFromURI(d),requestType:"popup"},m="";""===m&&a.getNetFilteringSwitch(f)&&a.getNetFilteringSwitch(d)&&
(m=a.staticNetFilteringEngine.matchStringExactType(h,d,"popup"));(f=a.pageStoreFromTabId(b.openerTabId))&&f.logRequest(h,m);a.logger.writeOne(b.openerTabId,h,m);if(!a.isAllowResult(m))return a.userSettings.showIconBadge&&a.updateBadgeAsync(b.openerTabId),"preempt"!==b.targetTabId&&(a.unbindTabFromPageStats(b.targetTabId),vAPI.tabs.remove(b.targetTabId)),!0}};vAPI.tabs.registerListeners();a.bindTabToPageStats=function(b,d){if(!1===a.tabContextManager.exists(b))return this.unbindTabFromPageStats(b),
null;var f=this.pageStores[b];if(!f)return this.pageStores[b]=this.PageStore.factory(b);if("beforeRequest"===d)return f;f.reuse(d);return f};a.unbindTabFromPageStats=function(a){var b=this.pageStores[a];void 0!==b&&(b.dispose(),delete this.pageStores[a])};a.pageStoreFromTabId=function(a){return this.pageStores[a]||null};a.pageStores[vAPI.noTabId]=a.PageStore.factory(vAPI.noTabId);var b=0,d=function(){var c=vAPI.tabs,e=Object.keys(a.pageStores).sort(),f=function(b){c.get(b,function(c){c||a.unbindTabFromPageStats(b)})};
b>=e.length&&(b=0);for(var h,m=Math.min(b+10,e.length),n=b;n<m;n++)h=e[n],vAPI.isBehindTheSceneTabId(h)||f(h);b=m;setTimeout(d,9E5)};setTimeout(d,9E5)})();
\u00b5Block.webRequest=function(){var a=function(a){var d=\u00b5Block,c=d.pageStoreFromTabId(vAPI.noTabId);if(c){var e=c.createContextFromPage();e.requestURL=a.url;e.requestHostname=a.hostname;e.requestType=a.type;a="";d.userSettings.advancedUserEnabled&&(a=c.filterRequestNoCache(e));c.logRequest(e,a);d.logger.writeOne(vAPI.noTabId,e,a);if(!d.isAllowResult(a))return{cancel:!0}}};vAPI.net.onBeforeRequest={urls:["http://*/*","https://*/*"],types:"main_frame sub_frame stylesheet script image object xmlhttprequest other".split(" "),
extra:["blocking"],callback:function(b){var d=b.type;if("main_frame"===d){var c=b.tabId,d=b.url,e=\u00b5Block;e.tabContextManager.push(c,d);b=b.hostname;var f=e.URI.domainFromHostname(b);b={rootHostname:b,rootDomain:f,pageHostname:b,pageDomain:f,requestURL:d,requestHostname:b,requestType:"main_frame"};(d=e.bindTabToPageStats(c,"beforeRequest"))&&d.logRequest(b,"");e.logger.writeOne(c,b,"")}else{c=b.tabId;if(vAPI.isBehindTheSceneTabId(c))return a(b);e=\u00b5Block;f=e.pageStoreFromTabId(c);if(!f){f=
e.tabContextManager.lookup(c);if(vAPI.isBehindTheSceneTabId(f.tabId))return a(b);vAPI.tabs.onNavigation({tabId:c,frameId:0,url:f.rawURL});f=e.pageStoreFromTabId(c)}var h="sub_frame"===d,m=h?b.parentFrameId:b.frameId,m=f.createContextFromFrameId(m),n=b.url;m.requestURL=n;m.requestHostname=b.hostname;m.requestType=d;d=f.filterRequest(m);f.logRequest(m,d);e.logger.writeOne(c,m,d);if(e.isAllowResult(d))m=b.frameId,0<m&&(h?f.setFrame(m,n):null===f.getFrame(m)&&f.setFrame(m,n));else return e.userSettings.showIconBadge&&
e.updateBadgeAsync(c),{cancel:!0}}}};vAPI.net.onHeadersReceived={urls:["http://*/*","https://*/*"],types:["main_frame","sub_frame"],extra:["blocking","responseHeaders"],callback:function(a){var d=a.tabId;if(!vAPI.isBehindTheSceneTabId(d)){if("main_frame"===a.type){var d=a.tabId,c=a.url,e=a.hostname,f=\u00b5Block,h;b:{h=a.responseHeaders;for(var m=h.length;m--;)if("content-type"===h[m].name.toLowerCase()){h=h[m].value.trim();break b}h=""}0===h.lastIndexOf("application/x-",0)?f.tabContextManager.unpush(d,
c):f.tabContextManager.push(d,c);(h=f.pageStoreFromTabId(d))||(h=f.bindTabToPageStats(d,"beforeRequest"));m=h.createContextFromPage();m.requestURL=c;m.requestHostname=e;m.requestType="inline-script";c=h.filterRequestNoCache(m);h.logRequest(m,c);f.logger.writeOne(d,m,c);f.isAllowResult(c)?a=void 0:(f.updateBadgeAsync(d),a.responseHeaders.push({name:"Content-Security-Policy",value:"script-src 'unsafe-eval' *"}),a={responseHeaders:a.responseHeaders});return a}f=\u00b5Block;if(c=f.pageStoreFromTabId(d))if(e=
c.createContextFromFrameId(a.parentFrameId),e.requestURL=a.url,e.requestHostname=a.hostname,e.requestType="inline-script",h=c.filterRequestNoCache(e),c.logRequest(e,h),f.logger.writeOne(d,e,h),!f.isAllowResult(h))return f.updateBadgeAsync(d),a.responseHeaders.push({name:"Content-Security-Policy",value:"script-src 'unsafe-eval' *"}),{responseHeaders:a.responseHeaders}}}};vAPI.net.registerListeners();return{}}();"use strict";
\u00b5Block.contextMenu=function(){var a=\u00b5Block;return{toggle:function(a){},onContextMenuClicked:function(b,d){console.log("details.menuItemId ",b);"blockElement"===b.menuItemId&&void 0!==d&&!1!==/^https?:\/\//.test(d.url)&&a.elementPickerExec(d.id)}}}();
\u00b5Block.mirrors=function(){var a={bytesInUseMax:5242880,ttl:18144E5,bytesInUse:0,tryCount:0,hitCount:0},b=function(){},d=Object.create(null),c=null,e={magicId:"yawqboypxuhs",urlKeyToHashMap:{}},f={},h={},m=!1,n=function(a){this.accessTime=Date.now();this.hash=a},p=function(a){this.createTime=Date.now();this.dataURL=a},g=function(a,c,d){"function"!==typeof c&&(c=b);"function"!==typeof d&&(d=c);var e=new XMLHttpRequest;e.open("get",a,!0);e.timeout=1E4;e.onload=c;e.onerror=d;e.ontimeout=d;e.responseType=
"arraybuffer";e.send()},r=function(){for(var a=new Uint8Array(64),b=64;b--;)a[b]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(b);return a}(),k=function(a){if("http"!==a.slice(0,4))return"";var b=a.indexOf("://");if(-1===b)return"";a=a.slice(b+3);b=a.indexOf("/");if(-1===b)return"";b=d[a.slice(0,b)];if(void 0===b)return"";for(var c=b.length,e;c--;)if(e=b[c].exec(a),null!==e)return 1===e.length?a:e[1];return""},q=function(a){return"string"===typeof a&&f.hasOwnProperty(a)},
l=function(a){return"mirrors_item_"+a},u=function(b){if(!(a.bytesInUse<b)){var c=e.urlKeyToHashMap,d=f,g,h,k,m,n={};for(g in c)!1!==c.hasOwnProperty(g)&&(k=c[g],h=k.hash,!1===n.hasOwnProperty(h)?n[h]={urlKeys:[g],accessTime:k.accessTime}:(m=n[h],m.urlKeys.push(g),m.accessTime=Math.max(m.accessTime,k.accessTime)));k=Object.keys(n).sort(function(a,b){return n[b].accessTime-n[a].accessTime});for(var p=[],q=k.length;q--;){h=k[q];m=n[h];g=d[h];delete d[h];p.push(l(h));for(a.bytesInUse-=g.dataURL.length;g=
m.urlKeys.pop();)delete c[g];if(a.bytesInUse<b)break}0!==p.length&&(vAPI.storage.remove(p),w())}},t=function(){c=null;vAPI.storage.set({mirrors_metadata:e})},w=function(){null!==c&&clearTimeout(c);t()},v=function(b){var c=k(b);"string"===typeof c&&e.urlKeyToHashMap.hasOwnProperty(c)||h.hasOwnProperty(c)||(h[c]=!0,g(b,function(){delete h[c];this.onload=this.onerror=null;if(200===this.status){var b;b=this.getResponseHeader("Content-Type");var d=b.indexOf(";"),g=-1===d?b.trim():b.slice(0,d).trim();b=
-1===d?"":b.slice(d+1).trim();b=""!==b?g+";"+b:"text"===g.slice(0,4)||/^application\/[a-z-]+script$/.test(g)?g+";charset=utf-8":g;d=new Uint8Array(this.response);g=new YaMD5;g.appendAsciiStr(b);g.appendByteArray(d);g=g.end();e.urlKeyToHashMap[c]=new n(g);w();if(!q(g)){var k=null;try{for(var m,t=[],v=3*Math.floor(d.length/3),y,x,C,z=0;z<v;z+=3)y=d[z],x=d[z+1],C=d[z+2],t.push(String.fromCharCode(r[y>>>2],r[(y&3)<<4|x>>>4],r[(x&15)<<2|C>>>6],r[C&63]));var G=d.length-v;1<G?(y=d[z],x=d[z+1],t.push(String.fromCharCode(r[y>>>
2],r[(y&3)<<4|x>>>4],r[(x&15)<<2],61))):0!==G&&(y=d[z],t.push(String.fromCharCode(r[y>>>2],r[(y&3)<<4],61,61)));m=t.join("");k="data:"+b+";base64,"+m}catch(P){}null!==k&&(v=k,q(g)||(m=f[g]=new p(v),a.bytesInUse+=v.length,v={},v[l(g)]=m,vAPI.storage.set(v),a.bytesInUse>=a.bytesInUseMax+1048576&&u(a.bytesInUseMax)))}}},function(){delete h[c];this.onload=this.onerror=null}))},x=function(){if(!m){m=!0;var b=function(b,c){var d=l(c);vAPI.storage.get(d,function(g){vAPI.lastError()||!1===g.hasOwnProperty(d)?
(delete e.urlKeyToHashMap[b],vAPI.storage.remove(d)):(g=f[c]=g[d],a.bytesInUse+=g.dataURL.length)})};vAPI.storage.get({mirrors_metadata:e},function(a){var c=e.urlKeyToHashMap=a.mirrors_metadata.urlKeyToHashMap;a="yawqboypxuhs"!==a.mirrors_metadata.magicId;var d=[],f,g;for(g in c)!1!==c.hasOwnProperty(g)&&(f=c[g].hash,a?(d.push(l(f)),delete e.urlKeyToHashMap[g]):b(g,f));0!==d.length&&(vAPI.storage.remove(d),w())});\u00b5Block.assets.get("assets/ublock/mirror-candidates.txt",function(a){if(""!==a.content){a=
a.content;for(var b=a.length,c=0,e,f,g="";c<b;)e=a.indexOf("\n",c),-1===e&&(e=a.indexOf("\r",c),-1===e&&(e=b)),f=a.slice(c,e),c=e+1,"#"!==f.charAt(0)&&(" "!==f.charAt(0)?g=f.trim():""!==g&&(e=new RegExp(f.trim()),void 0===d[g]&&(d[g]=[]),d[g].push(e)))}})}};a.toggle=function(b){b&&!0!==m?x():!0!==b&&m&&(u(0),e.urlKeyToHashMap={},f={},a.bytesInUse=0,a.hitCount=0,m=!1)};a.toURL=function(b,d,g){if("font"===d)return"";a.tryCount+=1;d=k(b);if(""===d)return"";if(!1===("string"===typeof d&&e.urlKeyToHashMap.hasOwnProperty(d)))return!0===
g&&v(b),"";b="";g=e.urlKeyToHashMap[d];q(g.hash)?(b=f[g.hash].dataURL,g.accessTime=Date.now(),a.hitCount+=1):delete e.urlKeyToHashMap[d];null===c&&(c=setTimeout(t,6E4));return b};a.pruneToSize=u;return a}();var Utils={ELEMENT_TYPES:{NONE:0,script:1,image:2,background:4,stylesheet:8,object:16,subdocument:32,object_subrequest:64,media:128,other:256,xmlhttprequest:512,document:1024,elemhide:2048,popup:4096,DEFAULTTYPES:1023}};
Utils.ELEMENT_TYPES.fromOnBeforeRequestType=function(a){switch(a){case "main_frame":return Utils.ELEMENT_TYPES.document;case "sub_frame":return Utils.ELEMENT_TYPES.subdocument;case "other":return Utils.ELEMENT_TYPES.other;default:return Utils.ELEMENT_TYPES[a]}};Utils.FILTER_OPTIONS={NONE:0,THIRDPARTY:1,MATCHCASE:2,FIRSTPARTY:4};Utils.guid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0;return("x"==a?b:b&3|8).toString(16)})};
Utils.setDefault=function(a,b,d){void 0===a[b]&&(a[b]=d);return a[b]};Utils.parseUri=function(a){a=/^(([^:]+(?::|$))(?:(?:\w+:)?\/\/)?(?:[^:@\/]*(?::[^:@\/]*)?@)?(([^:\/?#]*)(?::(\d*))?))((?:[^?#\/]*\/)*[^?#]*)(\?[^#]*)?(\#.*)?/.exec(a);for(var b="href origin protocol host hostname port pathname search hash".split(" "),d={},c=0;a&&c<b.length;c++)d[b[c]]=a[c]||"";return d};Utils.parseUri.secondLevelDomainOnly=function(a,b){return(a.match(/([^\.]+\.(?:co\.)?[^\.]+)\.?$/)||[a,a])[b?0:1].toLowerCase()};
Utils.UserAgentDetect={init:function(){var a=this.findMatchingData(this.dataBrowser);a?(this.browserName=a.identity,a=a.versionSearch||a.identity,this.browserVersion=this.searchBrowserVersion(navigator.userAgent,a)||this.searchBrowserVersion(navigator.appVersion,a)||"Unknown"):this.browserVersion=this.browserName="Unknown";(a=this.findMatchingData(this.dataOS))?(this.osName=a.identity,0<=this.osName.indexOf("Windows")?(this.osVersion=/Windows (.*)/.exec(this.osName)[1],this.osName="Windows"):this.osVersion=
this.searchOSVersion(navigator.userAgent,a.versionSearch)||this.searchOSVersion(navigator.appVersion,a.versionSearch)||"Unknown"):this.osVersion=this.osName="Unknown"},findMatchingData:function(a){var b,d,c;for(b=0;b<a.length;b++){var e=a[b].regex;d=a[b].string;c=a[b].prop;if(d){if(e.test(d))return a[b]}else if(c)return a[b]}},searchBrowserVersion:function(a,b){var d=a.indexOf(b);if(-1!==d)return parseFloat(a.substring(d+b.length+1))},searchOSVersion:function(a,b){if(!b)return"";var d=b.exec(a);return d&&
1<d.length?(d.splice(0,1),d.join(".")):d},dataBrowser:[{string:navigator.userAgent,regex:/Chrome/,identity:"Chrome"},{string:navigator.userAgent,regex:/OmniWeb/,versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,regex:/Apple/,identity:"Safari",versionSearch:"Version"},{string:navigator.vendor,regex:/iCab/,identity:"iCab"},{string:navigator.vendor,regex:/KDE/,identity:"Konqueror"},{string:navigator.userAgent,regex:/Firefox/,identity:"Firefox"},{string:navigator.vendor,regex:/Camino/,
identity:"Camino"},{string:navigator.userAgent,regex:/Netscape/,identity:"Netscape"},{string:navigator.userAgent,regex:/MSIE/,identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,regex:/Gecko/,identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,regex:/Mozilla/,identity:"Netscape",versionSearch:"Mozilla"}],dataOS:[{string:navigator.userAgent,regex:/Win16/,identity:"Windows 3.11",versionSearch:/Windows (.*)/},{string:navigator.userAgent,regex:/(Windows 95|Win95|Windows_95)/,
identity:"Windows 95",versionSearch:/Windows (.*)/},{string:navigator.userAgent,regex:/(Win 9x 4.90|Windows ME)/,identity:"Windows ME",versionSearch:/Windows (.*)/},{string:navigator.userAgent,regex:/(Windows 98|Win98)/,identity:"Windows 98",versionSearch:/Windows (.*)/},{string:navigator.userAgent,regex:/Windows CE/,identity:"Windows CE",versionSearch:/Windows (.*)/},{string:navigator.userAgent,regex:/(Windows NT 5.0|Windows 2000)/,identity:"Windows 2000",versionSearch:/Windows (.*)/},{string:navigator.userAgent,
regex:/(Windows NT 5.1|Windows XP)/,identity:"Windows XP",versionSearch:/Windows (.*)/},{string:navigator.userAgent,regex:/Windows NT 5.2/,identity:"Windows Server 2003",versionSearch:/Windows (.*)/},{string:navigator.userAgent,regex:/Windows NT 6.0/,identity:"Windows Vista",versionSearch:/Windows (.*)/},{string:navigator.userAgent,regex:/(Windows 7|Windows NT 6.1)/,identity:"Windows 7",versionSearch:/Windows (.*)/},{string:navigator.userAgent,regex:/(Windows 8.1|Windows NT 6.3)/,identity:"Windows 8.1",
versionSearch:/Windows (.*)/},{string:navigator.userAgent,regex:/(Windows 8|Windows NT 6.2)/,identity:"Windows 8",versionSearch:/Windows (.*)/},{string:navigator.userAgent,regex:/(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/,identity:"Windows NT 4.0",versionSearch:/Windows (.*)/},{string:navigator.userAgent,regex:/Android/,identity:"Android",versionSearch:/Android ([\.\_\d]+)/},{string:navigator.userAgent,regex:/OpenBSD/,identity:"Open BSD"},{string:navigator.userAgent,regex:/SunOS/,identity:"Sun OS"},
{string:navigator.userAgent,regex:/(Linux|X11)/,identity:"Linux"},{string:navigator.userAgent,regex:/(iPhone|iPad|iPod)/,identity:"iOS",versionSearch:/OS (\d+)_(\d+)_?(\d+)?/},{string:navigator.userAgent,regex:/Mac OS X/,identity:"Mac OS X",versionSearch:/Mac OS X (\d+)_(\d+)_?(\d+)?/},{string:navigator.userAgent,regex:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/,identity:"Mac OS"},{string:navigator.userAgent,regex:/QNX/,identity:"QNX"},{string:navigator.userAgent,regex:/UNIX/,identity:"UNIX"},{string:navigator.userAgent,
regex:/BeOS/,identity:"BeOS"},{string:navigator.userAgent,regex:/OS\/2/,identity:"OS/2"},{string:navigator.userAgent,regex:/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver)/,identity:"Search Bot"}]};var Conf={API_VERSION:"latest"},userAgentDetect=Utils.UserAgentDetect;userAgentDetect.init();Conf.BROWSER_NAME=userAgentDetect.browserName;Conf.BROWSER_VERSION=userAgentDetect.browserVersion;Conf.OS_NAME=userAgentDetect.osName;Conf.OS_VERSION=userAgentDetect.osVersion;
Utils.logerror=function(a){try{console.error(a)}catch(b){}};Conf.DOMAIN=".intently.com";Conf.CONFIG_URL="https://api"+Conf.DOMAIN+"/"+Conf.API_VERSION+"/account/extensionconfig";Conf.APP_URL="https://www"+Conf.DOMAIN+"/";Conf.LOGIN_URL=Conf.APP_URL+"login";Conf.MODE="prod";Conf.DEBUG=!1;Conf.INTEND_BUTTON_BASE64="iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAACXBIWXMAAAsSAAALEgHS3X78AAAKT2lDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVNnVFPpFj333vRCS4iAlEtvUhUIIFJCi4AUkSYqIQkQSoghodkVUcERRUUEG8igiAOOjoCMFVEsDIoK2AfkIaKOg6OIisr74Xuja9a89+bN/rXXPues852zzwfACAyWSDNRNYAMqUIeEeCDx8TG4eQuQIEKJHAAEAizZCFz/SMBAPh+PDwrIsAHvgABeNMLCADATZvAMByH/w/qQplcAYCEAcB0kThLCIAUAEB6jkKmAEBGAYCdmCZTAKAEAGDLY2LjAFAtAGAnf+bTAICd+Jl7AQBblCEVAaCRACATZYhEAGg7AKzPVopFAFgwABRmS8Q5ANgtADBJV2ZIALC3AMDOEAuyAAgMADBRiIUpAAR7AGDIIyN4AISZABRG8lc88SuuEOcqAAB4mbI8uSQ5RYFbCC1xB1dXLh4ozkkXKxQ2YQJhmkAuwnmZGTKBNA/g88wAAKCRFRHgg/P9eM4Ors7ONo62Dl8t6r8G/yJiYuP+5c+rcEAAAOF0ftH+LC+zGoA7BoBt/qIl7gRoXgugdfeLZrIPQLUAoOnaV/Nw+H48PEWhkLnZ2eXk5NhKxEJbYcpXff5nwl/AV/1s+X48/Pf14L7iJIEyXYFHBPjgwsz0TKUcz5IJhGLc5o9H/LcL//wd0yLESWK5WCoU41EScY5EmozzMqUiiUKSKcUl0v9k4t8s+wM+3zUAsGo+AXuRLahdYwP2SycQWHTA4vcAAPK7b8HUKAgDgGiD4c93/+8//UegJQCAZkmScQAAXkQkLlTKsz/HCAAARKCBKrBBG/TBGCzABhzBBdzBC/xgNoRCJMTCQhBCCmSAHHJgKayCQiiGzbAdKmAv1EAdNMBRaIaTcA4uwlW4Dj1wD/phCJ7BKLyBCQRByAgTYSHaiAFiilgjjggXmYX4IcFIBBKLJCDJiBRRIkuRNUgxUopUIFVIHfI9cgI5h1xGupE7yAAygvyGvEcxlIGyUT3UDLVDuag3GoRGogvQZHQxmo8WoJvQcrQaPYw2oefQq2gP2o8+Q8cwwOgYBzPEbDAuxsNCsTgsCZNjy7EirAyrxhqwVqwDu4n1Y8+xdwQSgUXACTYEd0IgYR5BSFhMWE7YSKggHCQ0EdoJNwkDhFHCJyKTqEu0JroR+cQYYjIxh1hILCPWEo8TLxB7iEPENyQSiUMyJ7mQAkmxpFTSEtJG0m5SI+ksqZs0SBojk8naZGuyBzmULCAryIXkneTD5DPkG+Qh8lsKnWJAcaT4U+IoUspqShnlEOU05QZlmDJBVaOaUt2ooVQRNY9aQq2htlKvUYeoEzR1mjnNgxZJS6WtopXTGmgXaPdpr+h0uhHdlR5Ol9BX0svpR+iX6AP0dwwNhhWDx4hnKBmbGAcYZxl3GK+YTKYZ04sZx1QwNzHrmOeZD5lvVVgqtip8FZHKCpVKlSaVGyovVKmqpqreqgtV81XLVI+pXlN9rkZVM1PjqQnUlqtVqp1Q61MbU2epO6iHqmeob1Q/pH5Z/YkGWcNMw09DpFGgsV/jvMYgC2MZs3gsIWsNq4Z1gTXEJrHN2Xx2KruY/R27iz2qqaE5QzNKM1ezUvOUZj8H45hx+Jx0TgnnKKeX836K3hTvKeIpG6Y0TLkxZVxrqpaXllirSKtRq0frvTau7aedpr1Fu1n7gQ5Bx0onXCdHZ4/OBZ3nU9lT3acKpxZNPTr1ri6qa6UbobtEd79up+6Ynr5egJ5Mb6feeb3n+hx9L/1U/W36p/VHDFgGswwkBtsMzhg8xTVxbzwdL8fb8VFDXcNAQ6VhlWGX4YSRudE8o9VGjUYPjGnGXOMk423GbcajJgYmISZLTepN7ppSTbmmKaY7TDtMx83MzaLN1pk1mz0x1zLnm+eb15vft2BaeFostqi2uGVJsuRaplnutrxuhVo5WaVYVVpds0atna0l1rutu6cRp7lOk06rntZnw7Dxtsm2qbcZsOXYBtuutm22fWFnYhdnt8Wuw+6TvZN9un2N/T0HDYfZDqsdWh1+c7RyFDpWOt6azpzuP33F9JbpL2dYzxDP2DPjthPLKcRpnVOb00dnF2e5c4PziIuJS4LLLpc+Lpsbxt3IveRKdPVxXeF60vWdm7Obwu2o26/uNu5p7ofcn8w0nymeWTNz0MPIQ+BR5dE/C5+VMGvfrH5PQ0+BZ7XnIy9jL5FXrdewt6V3qvdh7xc+9j5yn+M+4zw33jLeWV/MN8C3yLfLT8Nvnl+F30N/I/9k/3r/0QCngCUBZwOJgUGBWwL7+Hp8Ib+OPzrbZfay2e1BjKC5QRVBj4KtguXBrSFoyOyQrSH355jOkc5pDoVQfujW0Adh5mGLw34MJ4WHhVeGP45wiFga0TGXNXfR3ENz30T6RJZE3ptnMU85ry1KNSo+qi5qPNo3ujS6P8YuZlnM1VidWElsSxw5LiquNm5svt/87fOH4p3iC+N7F5gvyF1weaHOwvSFpxapLhIsOpZATIhOOJTwQRAqqBaMJfITdyWOCnnCHcJnIi/RNtGI2ENcKh5O8kgqTXqS7JG8NXkkxTOlLOW5hCepkLxMDUzdmzqeFpp2IG0yPTq9MYOSkZBxQqohTZO2Z+pn5mZ2y6xlhbL+xW6Lty8elQfJa7OQrAVZLQq2QqboVFoo1yoHsmdlV2a/zYnKOZarnivN7cyzytuQN5zvn//tEsIS4ZK2pYZLVy0dWOa9rGo5sjxxedsK4xUFK4ZWBqw8uIq2Km3VT6vtV5eufr0mek1rgV7ByoLBtQFr6wtVCuWFfevc1+1dT1gvWd+1YfqGnRs+FYmKrhTbF5cVf9go3HjlG4dvyr+Z3JS0qavEuWTPZtJm6ebeLZ5bDpaql+aXDm4N2dq0Dd9WtO319kXbL5fNKNu7g7ZDuaO/PLi8ZafJzs07P1SkVPRU+lQ27tLdtWHX+G7R7ht7vPY07NXbW7z3/T7JvttVAVVN1WbVZftJ+7P3P66Jqun4lvttXa1ObXHtxwPSA/0HIw6217nU1R3SPVRSj9Yr60cOxx++/p3vdy0NNg1VjZzG4iNwRHnk6fcJ3/ceDTradox7rOEH0x92HWcdL2pCmvKaRptTmvtbYlu6T8w+0dbq3nr8R9sfD5w0PFl5SvNUyWna6YLTk2fyz4ydlZ19fi753GDborZ752PO32oPb++6EHTh0kX/i+c7vDvOXPK4dPKy2+UTV7hXmq86X23qdOo8/pPTT8e7nLuarrlca7nuer21e2b36RueN87d9L158Rb/1tWeOT3dvfN6b/fF9/XfFt1+cif9zsu72Xcn7q28T7xf9EDtQdlD3YfVP1v+3Njv3H9qwHeg89HcR/cGhYPP/pH1jw9DBY+Zj8uGDYbrnjg+OTniP3L96fynQ89kzyaeF/6i/suuFxYvfvjV69fO0ZjRoZfyl5O/bXyl/erA6xmv28bCxh6+yXgzMV70VvvtwXfcdx3vo98PT+R8IH8o/2j5sfVT0Kf7kxmTk/8EA5jz/GMzLdsAAAAgY0hSTQAAeiUAAICDAAD5/wAAgOkAAHUwAADqYAAAOpgAABdvkl/FRgAABztJREFUeNqEk9lTm+cVxt8/ou1tpxcxocXFrDIYG4wLxgYbbIbdyCwCLYBBAiQWIxACBAi028S9aJplxpPYTi56kUzdycQ1mz59+/dJIoknbROTNk4mrsf10iXP6QW0nul6ceY858zznN/MO/OyZsHDmvhp1qWEWH/6FWbjFplJ9rPunTXWq0Zyzemo3ZqO3DQnoylLMrZr0SO7lmQ0bU1Hb5rTUXuvGsq1fX6NdW77WOdtLxv46Bqz7URZ98YSM20tM/avAGvcx0zS0kvmj9Z+bk1Fn9nSMbKmYmRORsmsRciiR8mqR8iajlHfzlWyJmPP+37309c61ucPdLzv+T+A5FXWp0YuWNJXvuxLxciSipElGYFFjcCqh2HTIzBpYZi0IKx6FBYtAlsyTDY9RrZPrj6wapH2fv3KfwFIQda/c63fdm+NLKkYmbUwLHoE5mQEZj2CvmQMJi2Ian4aVfwEOtQV9CWvwKxHYFbDsKavUN+9Ner/eG3Qloq9ADTxM6whMcV61FBT38dr1K2HyKQGYFJD6NFD6NVD6NXD6FKDaFX9uP7FB/jlVwJsyRguKMvo1cPo0cLoUYLo0UNk/eQqWVLRVtP6IuvZXGbMqPpZu7J8oGcn+sikh6hLCaBbD6FbC6FLD8Kkh2HSQjidcOPab34BIgIR4c3PfoUT3DhM6p63Ww+hSw3CpAepR4887hQCGUZ1hbEuLcx6U7Gfdaci1KEGqEsLolMLolML7HU1gG4tgDplDrPiq/jzoyd49IeHcHJrqFE9eOEPokMLolMJoEsPU1cq/JpRDzLWLV472KH7nxjVVTKqq7iorsCorsKoBbA3r6JDWUWj5kPZlhOn3r6EkzcGUCd4YEpHYNz3X1RXcVFbhVFZhVENkDHpf9orvJLNjGpgpC0VoAvKEtrVZbSqfrSpfrQpK7ig+tGm7O3MOzH07kTRpq2gfSeI9vQqWpVlXFD8ez51Ba3qEtq0ZRjVZVxIrpJRDbhYs7p4q0X3U5OyiFZ1ES3qElqURbTKPrSqy6gRPKgVPfj04X3Qt3vv/+nTL1HFu1HNz6BV8aNZWUKzvIRm1YcWZQktig9tup8a1aV3WIPsSzUpPmpUfGhSfGhUFtC0rxskHxrUJVSL02h5dxL3v/o9iAjc5zqOxV04I8+iQfGhcT/XqPjQKPvQoPjQoCxSg+JLs3ppfve8vEDn5Hmcl+dRLy+gXp5DvTyPc/I8GuQFnJY9OHjXjMQDHUSEGzu3cXjLgbOKF/WyD/XSHOplL+rlhf0b8zgvL9B5eX6X1Une3TrJS7WSF3WSF2dFL2olL2rlWdTKXpyT5nAsMY5m2YfHz/4EIsKc/gbyNvtRp8yjTl5AnbyfEedwVp7FWWkWddIc1creXVYtzabOSB46I82gRvKgRvCgRpxBteTBGcmDWsmL3O0hdIgroG8BIoJZiyJry4ZaybuXET2oljw4/Y8bogdnJA/VSLNpVilOvXNK8VAV78ZJYQpVohtVwjROiW5UCW5Uix5kbFhgSkX3Ptnzv6FdWEI2N4TT4sy+373XJTdOCjM4JbpxSpmhKnnqXVYhzDgrFTdVJKZQIVzGT4TLqBCmUCFe/mcd2DBj+t6bICI8efgIJzcmkMs7cFJ0o0KYRIU4iQp+L18pXkYlfxkV6jRViDMuVin4DpZLE09OCBNUnphEOT+B48IEyvkJnBAnUJJwImPdjJu//QBEhDv3eXz3dhMOi05UCm4cFydQLoyjXJhEubCnj4uTVC6NP62ML2WzMm2alSWnXy0TJ6g07sRRYQzHeBeO8eMo5ceRzw3hpV93Q/36HogI2rPPcP2LD1ElTCF7awBl/DhKuTGUCmMoFcZRwo3hmDRBZdrU66XyFGNHFCc7khg9UCKOPS4RnVTMOVHMO3GEd+Eo50JBwoEfrJtwPXUb9Pg5/vjNN3hbfB/Z6zbkCkMo4ZwoTrhQIrhwhHPiCO+kEsH1pIgfyyyWXYwV3LGygjsWZkiMthQpY3Q4MUwGbgSGxAgMiVEU807ki6N4+b1utNxw4ehbFnznvSYUCCMo4V0wJIZxmBuBIT4CQ2KEipVxOsw72/PWHSxvw8FY4d0+VnjXxvI3HKwgPjZYpLjIkBimfM6O/MQwCjkHirhRHOQv4Xt3jfh+vAcGxYmixCjy43bkxx0o2LbDkBghg+QkgzI+XCi6WP6Gg+VvDr8AFGyOsLz1EZabGDTm8aMP8gQ75cXtlLs9hJz4IPI5BwrEURSKI8iL23Foewi5nB25CTvl8XbKE0e+ztka6jQIo8wgjf1nQOHmGMvYvsgyNswZedzo64cSQ3/JERyUzQ9RdnyIsuOD9OOtwT3N2ylHcNAhfuivudLoGxkblsyXPrzIiqSx/w3IjHeyzA0Ly9l0sh/F+/Mzub7hLO7SrSxuIJ3FDexmxQd2s7iB9EH+0q1Mrm/4h1u2ghzRyV7etLEDdzr/DfD3AQCIsIneyCtUkwAAAABJRU5ErkJggg==";
Conf.ADMIN_INTENTION_TIMER=3E5;Conf.NOTIFICATION_CHECK_TIME=3E4;Conf.INITIALIZATION_BACKOFF_TIMER=15E3;Utils.log=function(){};function DomainSet(a){if(void 0===a[DomainSet.ALL])throw Error("DomainSet: data[DomainSet.ALL] is undefined.");this.has=a}DomainSet.ALL="";DomainSet._parentDomainOf=function(a){return a.replace(/^.+?(?:\.|$)/,"")};DomainSet.domainAndParents=function(a){var b={};a=a.split(".");for(var d=a[a.length-1],c=a.length-1;0<=c;c--)b[d]=1,0<c&&(d=a[c-1]+"."+d);return b};
DomainSet.prototype={clone:function(){return new DomainSet(JSON.parse(JSON.stringify(this.has)))},full:function(){for(var a in this.has)if(!this.has[a])return!1;return!0},subtract:function(a){this._apply(function(a,d){return a&&!d},a)},_apply:function(a,b){for(var d in b.has)this.has[d]=this._computedHas(d);for(d in this.has)this.has[d]=a(this.has[d],b._computedHas(d));var c={};c[DomainSet.ALL]=this.has[DomainSet.ALL];for(d in this.has)this.has[d]!==this._computedHas(DomainSet._parentDomainOf(d))&&
(c[d]=this.has[d]);this.has=c},_computedHas:function(a){return void 0!==this.has[a]?this.has[a]:this._computedHas(DomainSet._parentDomainOf(a))}};function FifoCache(a){this._size=Math.max(a,0);this._cacheKeys=[];this._cache={}}FifoCache.prototype={set:function(a,b){var d=a in this._cache;this._cache[a]=b;d||(this._cacheKeys.push(a),this._cacheKeys.length>this._size&&(delete this._cache[this._cacheKeys[0]],this._cacheKeys.shift()))},get:function(a){return this._cache[a]}};
var FilterNormalizer={normalizeList:function(a,b){for(var d=[],c=0,e=0;e<a.length;e++)try{var f=FilterNormalizer.normalizeLine(a[e]);f?d.push(f):!1!==f?c++:b&&d.push(a[e])}catch(h){c++}return d},normalizeLine:function(a){a=a.replace(/\r$/,"").trim();if(Filter.isComment(a))return!1;var b=PatternFilter.fromText(a),d=b._allowedElementTypes&(Utils.ELEMENT_TYPES.document|Utils.ELEMENT_TYPES.elemhide);if(!Filter.isWhitelistFilter(a)&&d)throw"$document and $elemhide may only be used on whitelist filters";
FilterNormalizer.verifyDomains(b._domains);FilterNormalizer._checkForObjectProperty(a);return a},_ensureExcluded:function(a,b){var d=a,c=new SelectorFilter(d),e=b.filter(function(a){return c._domains._computedHas(a)});0<e.length&&(e="~"+e.join(",~"),"#"!=d[0]&&(e+=","),d=e+d);return d},_checkForObjectProperty:function(a){if(a in Object)throw"Filter causes problems in the code";},verifyDomains:function(a){for(var b in a.has)if(b!==DomainSet.ALL){if(0==/^([a-z0-9\-_\u00DF-\u00F6\u00F8-\uFFFFFF]+\.)*[a-z0-9\u00DF-\u00F6\u00F8-\uFFFFFF]+\.?$/i.test(b))throw Error("Invalid domain: "+
b);FilterNormalizer._checkForObjectProperty(b)}}};function FilterSet(){this.items={global:[]};this.exclude={}}FilterSet.fromFilters=function(a){var b=new FilterSet,d;for(d in a){var c=a[d],e;for(e in c._domains.has)c._domains.has[e]?Utils.setDefault(b.items,e===DomainSet.ALL?"global":e,[]).push(c):e!==DomainSet.ALL&&(Utils.setDefault(b.exclude,e,{})[c.id]=!0)}return b};
FilterSet.prototype={_viewFor:function(a){var b=new FilterSet;b.items.global=this.items.global;for(var d in DomainSet.domainAndParents(a))this.items[d]&&(b.items[d]=this.items[d]),this.exclude[d]&&(b.exclude[d]=this.exclude[d]);return b},matches:function(a,b,d,c){d=this._viewFor(d);for(var e in d.items)for(var f=d.items[e],h=0;h<f.length;h++){var m=f[h];if(m.matches(a,b,c)){var n=!1,p;for(p in d.exclude)if(d.exclude[p][m.id]){n=!0;break}if(!n)return m}}return null}};
var BlockingFilterSet=function(a,b,d){this.pattern=a;this.whitelist=b;this.whitelistDomains=d;this._matchCache={}};BlockingFilterSet.checkThirdParty=function(a,b){var d=Utils.parseUri.secondLevelDomainOnly(a,!1),c=Utils.parseUri.secondLevelDomainOnly(b,!1);return d!==c};
BlockingFilterSet.prototype={matches:function(a,b,d,c){var e=Utils.parseUri(a).hostname,e=BlockingFilterSet.checkThirdParty(e,d),f=a+" "+b+" "+e;if(f in this._matchCache)return this._matchCache[f];var h=this.whitelist.matches(a,b,d,e);if(h)return Utils.log(d+": whitelist rule"+h._rule+"exempts url"+a),this._matchCache[f]=c?h._text:!1,this._matchCache[f];if(h=this.pattern.matches(a,b,d,e))return Utils.log(d+": matched"+h._rule+"to url"+a),this._matchCache[f]=c?h._text:!0,this._matchCache[f];this._matchCache[f]=
!1;return this._matchCache[f]},isWhitelisted:function(a,b){if(!a)return!0;a=a.replace(/\#.*$/,"");b||(b=Utils.ELEMENT_TYPES.document);var d=Utils.parseUri(a).hostname;return 0<=this.whitelistDomains.indexOf(d)?!0:this.whitelist.matches(a,b,d,!1)}};var Filter=function(){this.id=++Filter._lastId};Filter._lastId=0;Filter._cache={};Filter.fromText=function(a){var b=Filter._cache;a in b||(b[a]=PatternFilter.fromText(a));return b[a]};Filter.isWhitelistFilter=function(a){return/^\@\@/.test(a)};
Filter.isComment=function(a){return 0===a.length||"!"===a[0]||/^\[adblock/i.test(a)||/^\(adblock/i.test(a)};Filter._toDomainSet=function(a,b){var d=a.split(b),c={};c[DomainSet.ALL]=!0;if(""==d)return new DomainSet(c);for(var e=0;e<d.length;e++){var f=d[e];"~"==f[0]?c[f.substring(1)]=!1:(c[f]=!0,c[DomainSet.ALL]=!1)}return new DomainSet(c)};var PatternFilter=function(){Filter.call(this)};
PatternFilter.fromData=function(a){var b=new PatternFilter;b._rule=new RegExp(a[0]);b._allowedElementTypes=a[1];b._options=a[2];a={};a[DomainSet.ALL]=!0;b._domains=new DomainSet(a);return b};PatternFilter.fromText=function(a){a=PatternFilter._parseRule(a);var b=new PatternFilter;b._domains=Filter._toDomainSet(a.domainText,"|");b._allowedElementTypes=a.allowedElementTypes;b._options=a.options;b._rule=a.rule;b._key=a.key;return b};
PatternFilter._parseRule=function(a){var b={domainText:"",options:Utils.FILTER_OPTIONS.NONE},d=a.match(/\$~?[\w\-]+(?:=[^,\s]+)?(?:,~?[\w\-]+(?:=[^,\s]+)?)*$/),c;if(d)e=d[0].substring(1).toLowerCase().split(","),a=a.replace(d[0],"");else var e=[];for(d=0;d<e.length;d++){var f=e[d];if(/^domain\=/.test(f))b.domainText=f.substring(7);else{var h="~"==f[0];h&&(f=f.substring(1));f=f.replace(/\-/,"_");"object_subrequest"==f&&(f="object");"background"==f&&(f="image");if(f in Utils.ELEMENT_TYPES)h?(void 0===
c&&(c=Utils.ELEMENT_TYPES.DEFAULTTYPES),c&=~Utils.ELEMENT_TYPES[f]):(void 0===c&&(c=Utils.ELEMENT_TYPES.NONE),c|=Utils.ELEMENT_TYPES[f]);else if("third_party"===f)b.options|=h?Utils.FILTER_OPTIONS.FIRSTPARTY:Utils.FILTER_OPTIONS.THIRDPARTY;else if("match_case"===f)b.options|=Utils.FILTER_OPTIONS.MATCHCASE;else if("collapse"!==f)throw"Unknown option in filter "+f;}}b.allowedElementTypes=void 0===c?Utils.ELEMENT_TYPES.DEFAULTTYPES:c;Filter.isWhitelistFilter(a)&&(a=a.substring(2));c=b.options&Utils.FILTER_OPTIONS.MATCHCASE?
"":"i";if(/^\/.+\/$/.test(a))return b.rule=a.substr(1,a.length-2),b.rule=new RegExp(b.rule,c),b;if(e=a.match(/\w{5,}/))b.key=new RegExp(e,c);a=a.replace(/\*\*+/g,"*");a=a.replace(/([^a-zA-Z0-9_\|\^\*])/g,"\\$1");a=a.replace(/\^/g,"[^\\-\\.\\%a-zA-Z0-9_]");a=a.replace(/\*/g,".*");a=a.replace(/^\|\|/,"^[^\\/]+\\:\\/\\/([^\\/]+\\.)?");a=a.replace(/^\|/,"^");a=a.replace(/\|$/,"$");a=a.replace(/\|/g,"\\|");a=a.replace(/^\.\*/,"");a=a.replace(/\.\*$/,"");b.rule=new RegExp(a,c);return b};
PatternFilter.prototype={__proto__:Filter.prototype,matches:function(a,b,d){return!(b&this._allowedElementTypes)||this._options&Utils.FILTER_OPTIONS.THIRDPARTY&&!d||this._options&Utils.FILTER_OPTIONS.FIRSTPARTY&&d||this._key&&!this._key.test(a)?!1:this._rule.test(a)}};
var INTENTLY_LOGOUT_DEBUG=[],REINITIALIZATION_TIMESTAMP=0,INTENTLY_DEACTIVATION_DEBUG={},intentlyData={},registeredTabPorts={},registeredTabData={},registeredFramePorts={},replacementOperationCounter=1,activeReplacementOperations={},replacementOperationLog={},notificationsOpen=!1,lastAlertId=null,considerAdminIntentions=!0,considerAdminIntentionsTimer=null,disconnectedReinitializationTimer=null;vAPI.hasOwnProperty("toolbarButton")||(vAPI.toolbarButton={});
vAPI.toolbarButton.events={listeners:[],onClick:function(a){vAPI.toolbarButton.events.listeners.push(a)},handleClick:function(a){for(var b=0;b<vAPI.toolbarButton.events.listeners.length;b++)vAPI.toolbarButton.events.listeners[b](a)},remove:function(a){for(var b=0,b=0;b<vAPI.toolbarButton.events.listeners.length&&a!=vAPI.toolbarButton.events.listeners[b];b++);b<vAPI.toolbarButton.events.listeners.length&&vAPI.toolbarButton.events.listeners.splice(b,1)}};
vAPI.hasOwnProperty("tabWatcher")||(vAPI.tabWatcher={});
vAPI.tabWatcher.events={activatelisteners:[],onActivate:function(a){vAPI.tabWatcher.events.activatelisteners.push(a)},handleActivate:function(a){for(var b=0;b<vAPI.tabWatcher.events.activatelisteners.length;b++)vAPI.tabWatcher.events.activatelisteners[b](a)},remove:function(a){for(var b=0,b=0;b<vAPI.tabWatcher.events.activatelisteners.length&&a!=vAPI.tabWatcher.events.activatelisteners[b];b++);b<vAPI.tabWatcher.events.activatelisteners.length&&vAPI.tabWatcher.events.activatelisteners.splice(b,1)}};
Conf.EXTENSION_VERSION=chrome.runtime.getManifest().version;chrome.browserAction.onClicked.addListener(vAPI.toolbarButton.events.handleClick);chrome.tabs.onActivated.addListener(function(a){vAPI.tabs.get(a.tabId,function(a){vAPI.tabWatcher.events.handleActivate(a)})});vAPI.tabs.toChromiumTabId=function(a){"string"===typeof a&&(a=parseInt(a,10));return"number"!==typeof a||isNaN(a)||-1===a?0:a};var getLocationOrigin=function(a){var b=a.split("/");2<=b.length&&(a=b[0]+"//"+b[2]+"/");return a};
vAPI.topsitesEnabled=!0;vAPI.getTopSites=function(a){var b=[];chrome.topSites.get(function(d){d.forEach(function(a){var d=getLocationOrigin(a.url);a.imgURL="https://www.google.com/webpagethumbnail?c=63&d="+d+"&r=4&s=148:94";b.push(a)});a(b)})};vAPI.setInterval=function(a,b){window.setInterval(a,b)};
var issueAlert=function(a,b,d){28<=Utils.UserAgentDetect.browserVersion?chrome.notifications.clear(a,function(c){delete b.alert;chrome.notifications.create(a,b,function(a){"function"===typeof d&&d(a)})}):(alert(b.alert),"function"===typeof d&&d(null))},checkRefreshCookies=function(){chrome.cookies.getAll({domain:Conf.DOMAIN,path:"/",name:"refresh_client_data"},function(a){a&&0<a.length&&a.forEach(function(a){a.domain==Conf.DOMAIN&&"1"==a.value&&(Utils.log("refresh cookie found! refreshing data from api"),
chrome.cookies.set({url:"https://api"+Conf.DOMAIN+"/",domain:a.domain,path:"/",name:"refresh_client_data",value:"0"},function(a){extension.intentlyInitializing||(extension.intentlyInitializing=!0,initApiData(function(){Utils.log("cookie data refresh complete");extension.intentlyActive||extension.initIntentlyExtension();extension.intentlyInitializing=!1;extension.updateBrowserAction()}))}))})});chrome.cookies.getAll({domain:Conf.DOMAIN,path:"/",name:"refresh_notification_count"},function(a){a&&0<a.length&&
a.forEach(function(a){a.domain!=Conf.DOMAIN&&a.domain!="."+Conf.DOMAIN||"1"!=a.value||(Utils.log("refresh cookie found! refreshing notification count"),chrome.cookies.set({url:"https://api"+Conf.DOMAIN+"/",domain:a.domain,path:"/",name:"refresh_notification_count",value:"0"},function(a){extension.checkNotifications()}))})})},\u00b5b=\u00b5Block,extension={userLoggedIn:!0,intentlyActive:!1,intentlyInitializing:!1,notificationCount:0,adreplaceCount:0,loginReplacementReminderCount:0,intentlyEnabled:!0,
framedata:{jsShareDialog:"",jsJquery:"",cssShareDialog:"",connections:[],retrieve:function(){extension.rawAjax({url:vAPI.getURL("/shareDialog/shareDialog.js")},function(a){extension.framedata.jsShareDialog="<script>"+a+"\x3c/script>"});extension.rawAjax({url:vAPI.getURL("/shareDialog/jquery-3.0.0.min.js")},function(a){extension.framedata.jsJquery="<script>"+a+"\x3c/script>"});extension.rawAjax({url:vAPI.getURL("/shareDialog/dialog.css")},function(a){extension.framedata.cssShareDialog="<style>"+a+
"</style>"});this.connections=intentlyData.connections||[]}},isWhiteListed:function(a){return 0<=Conf.USER_DOMAIN_WHITELISTS.indexOf(a)},isIntentlyEnabled:function(){return extension.intentlyEnabled},intentlyContextMenus:{mnuIntentlyContext:null,handleReportAd:function(a,b){void 0!==b&&vAPI.tabs.injectScript(b.id,{code:"\t\t\t\tvar getLastRightClickInfoMessageData = {\t\t\t\t\t\t\tmessageType : 'instruction',\t\t\t\t\t\t\tinstruction : 'identifylastrightclickad',\t\t\t\t\t\t\turl:document.URL\t\t\t\t\t\t};\t\t\t\t  backgroundPort.onMessage(getLastRightClickInfoMessageData);"},
null)},handleWhitelistChange:function(a,b){var d=Utils.parseUri(b.url).hostname;extension.isWhiteListed(d)?extension.removeWhitelist(b):extension.addWhitelist(b)},handleAddIntentions:function(a,b){void 0!==b&&vAPI.tabs.injectScript(b.id,{code:"\t\t\t\tvar getLastRightClickInfoMessageData = {\t\t\t\t\t\t\tmessageType : 'instruction',\t\t\t\t\t\t\tinstruction : 'identifylastrightclickintention',\t\t\t\t\t\t\turl:document.URL\t\t\t\t\t\t};\t\t\t\t  intentlyContent.backgroundPort.onMessage(getLastRightClickInfoMessageData);"},
null)},updateContext:function(a){if(null!==\u00b5b.pageStoreFromTabId(a)){var b=\u00b5b.tabContextManager.lookup(a);extension.intentlyContextMenus.refresh({id:a,url:b.normalURL})}},refresh:function(a){vAPI.contextMenu.removeAll();if(extension.intentlyActive&&extension.intentlyEnabled&&(!a.url||0!=a.url.indexOf("about"))){a=Utils.parseUri(a.url).hostname;var b=extension.isWhiteListed(a);vAPI.contextMenu.create({id:"mnuIntentlyContext",title:"Intently",isParent:!0,contexts:"page editable frame link image video".split(" "),
documentUrlPatterns:["https://*/*","http://*/*"]});vAPI.contextMenu.create({id:"mnuIntentions",title:"Add to Intentions",parentId:"mnuIntentlyContext",contexts:["image"],documentUrlPatterns:["https://*/*","http://*/*"]},extension.intentlyContextMenus.handleAddIntentions);var d="Add "+a+" to Whitelist";b&&(d="Remove "+a+" from Whitelist");vAPI.contextMenu.create({id:"mnuChangeWhitelist",title:d,parentId:"mnuIntentlyContext",contexts:["page"],documentUrlPatterns:["https://*/*","http://*/*"]},extension.intentlyContextMenus.handleWhitelistChange);
b||vAPI.contextMenu.create({id:"blockElement",title:"Report Ad",parentId:"mnuIntentlyContext",contexts:"page editable frame link image video".split(" "),documentUrlPatterns:["https://*/*","http://*/*"]},\u00b5Block.contextMenu.onContextMenuClicked)}}},handlebrowserAction:function(){var a=extension.hasIntentlyTab(),b={active:!0};null!=a?(b.url=a,b.select=!0):b.url=extension.userLoggedIn?0<extension.notificationCount?Conf.NOTIFICATIONS_URL:Conf.APP_URL:Conf.LOGIN_URL;vAPI.tabs.open(b)},hasIntentlyTab:function(){for(var a=
\u00b5Block,b=Object.keys(a.pageStores),d=null,c=0;c<b.length;c++)if(0<=\u00b5Block.pageStores[b[c]].tabHostname.indexOf(Conf.DOMAIN)){d=a.tabContextManager.lookup(b[c]).normalURL;break}return d},handlebackgroundrequest:function(a){var b=!1;if(!extension.intentlyEnabled)return"";var d=Utils.ELEMENT_TYPES.fromOnBeforeRequestType(a.type),c=a.rootHostname;if(intentlyData.adBlockingRules){if(d==Utils.ELEMENT_TYPES.object||d==Utils.ELEMENT_TYPES.media||d==Utils.ELEMENT_TYPES.xmlhttprequest||d==Utils.ELEMENT_TYPES.subdocument||
d==Utils.ELEMENT_TYPES.other&&-1==c.indexOf("espn.go.com")&&-1==c.indexOf("cnn.com")&&-1==c.indexOf("cbsnews.com"))b=intentlyData.adBlockingRules.matches(a.url,d,c)}else Utils.log("Adblocking rules not avalable in cache to replace ");b&&"www.hulu.com"===c&&/ads\.hulu\.com/.test(a.url)&&(b=!1);b&&Utils.log("blocking sb:||"+a.requestHostname);return 0==b?"":"sb:||"+a.requestHostname},checkNotifications:function(){extension.userLoggedIn&&extension.ajax({url:Conf.API_URL+Conf.NOTIFICATION_COUNT_PATH,
success:function(a,b,d){b=0;a&&!0===a.success&&(b=parseInt(a.data));extension.notificationCount!=b&&(extension.notificationCount=b,vAPI.tabs.get(null,function(a){a&&extension.updateBadge(a)}))}})},updateBadge:function(a){Utils.log("updating badge",a);var b=a.id;if(!vAPI.isBehindTheSceneTabId(b)){var d=Utils.parseUri(a.url).hostname;a="off";var c="You are not logged in to Intently! Click the button to log in.";Utils.log("checking logging in",extension.userLoggedIn);var e="";extension.userLoggedIn&&
(extension.intentlyActive&&!extension.intentlyInitializing?(a="active",c=vAPI.app.name+" v"+vAPI.app.version,extension.isWhiteListed(d)?(a="whitelist",c=vAPI.app.name+" v"+vAPI.app.version+" (Whitelisted)"):extension.intentlyEnabled||(a="whitelist",c=vAPI.app.name+" v"+vAPI.app.version+" (Disabled)"),0<extension.notificationCount&&(e=extension.notificationCount+"",c="You have Intently notifications! Click here to open the Intently Dashboard and view your notifications.")):(c=vAPI.app.name+" v"+vAPI.app.version+
" (Initializing)",a="init"));d={};d.status=a;d.badge=e;d.label=c;vAPI.setIntentlyIcon(b,d);Utils.log("Set Intently icon completed",d)}},addWhitelist:function(a){if(void 0!=a){var b=Utils.parseUri(a.url).hostname,d=a.id;Utils.log("Adding whitelist record for domain "+b);extension.ajax({method:"POST",url:Conf.API_URL+Conf.DOMAIN_WHITELIST_ADD_PATH,data:JSON.stringify({domain:b}),success:function(c,e,f){c.success?(Conf.USER_DOMAIN_WHITELISTS.push(b),c=\u00b5Block,(e=c.pageStoreFromTabId(d))?(e.toggleNetFilteringSwitch(b,
"page",!1),Utils.log("Updating badge"),c.updateBadgeAsync(d)):Utils.log("No Page store"),extension.intentlyContextMenus.refresh(a),c={type:"basic",title:"Whitelist Added",message:"Successfully added "+b+" to your whitelist. You will need to refresh any open pages for the new whitelisting to take effect.",alert:"Successfully added "+b+" to your whitelist. You will need to refresh any open pages for the new whitelisting to take effect.",iconUrl:"img/browsericons/intentlyLogo128.png"},issueAlert("addWhitelistSuccess",
c)):(c={type:"basic",title:"Whitelist Error",message:"Whoops! Something unexpected happened while adding "+b+" to your whitelist. Please try again, or contact our support team at admin@intently.com.",alert:"Whoops! Something unexpected happened while adding "+b+" to your whitelist. Please try again, or contact our support team at admin@intently.com.",iconUrl:"img/browsericons/intentlyLogo128.png"},issueAlert("AddWhitelistSuccess",c))}});extension.whiteListProcessing=!1}},removeWhitelist:function(a){if(void 0!=
a){var b=Utils.parseUri(a.url).hostname,d=a.id;Utils.log("Removing whitelist record for domain "+b);var c=null;Conf.USER_DOMAIN_WHITELISTS.forEach(function(a){b==a&&(c=a)});c?extension.ajax({method:"POST",url:Conf.API_URL+Conf.DOMAIN_WHITELIST_REMOVE_PATH,data:JSON.stringify({domain:c}),success:function(e,f,h){if(e.success){Conf.USER_DOMAIN_WHITELISTS.splice(Conf.USER_DOMAIN_WHITELISTS.indexOf(c),1);if(e=\u00b5b.pageStoreFromTabId(d))e.toggleNetFilteringSwitch(b,"page",!0),Utils.log("Updating badge"),
\u00b5b.updateBadgeAsync(d);extension.intentlyContextMenus.refresh(a);e={type:"basic",title:"Whitelist Removed",message:"Successfully removed "+b+" from your whitelist. You will need to refresh any open pages for the new whitelisting to take effect.",alert:"Successfully removed "+b+" from your whitelist. You will need to refresh any open pages for the new whitelisting to take effect.",iconUrl:"img/browsericons/intentlyLogo128.png"};issueAlert("removeWhitelistSuccess",e)}else e={type:"basic",title:"Whitelist Error",
message:"Whoops! Something unexpected happened while removing "+b+" from your whitelist. Please try again, or contact our support team at admin@intently.com.",alert:"Whoops! Something unexpected happened while removing "+b+" from your whitelist. Please try again, or contact our support team at admin@intently.com.",iconUrl:"img/browsericons/intentlyLogo128.png"},issueAlert("removeWhitelistFailure",e)}}):issueAlert("removeWhitelistFailure",{type:"basic",title:"Whitelist Error",message:"Whoops! Something unexpected happened while removing "+
b+" from your whitelist. Please try again, or contact our support team at admin@intently.com.",alert:"Whoops! Something unexpected happened while removing "+b+" from your whitelist. Please try again, or contact our support team at admin@intently.com.",iconUrl:"img/browsericons/intentlyLogo128.png"});extension.whiteListProcessing=!1}},updateBrowserAction:function(){vAPI.tabs.get(null,function(a){a?(extension.intentlyContextMenus.refresh(a),extension.updateBadge(a)):Utils.log("Unable to found tab current page")})},
updateBrowserActionFor:function(a){extension.intentlyContextMenus.refresh(a);extension.updateBadge(a)},handleInstall:function(){},handleAfterInstall:function(){var a={active:!0};a.url=vAPI.getURL("/popup/html/firstpage.html");a.select=!0;vAPI.tabs.open(a)},toggleIntentlyEnabled:function(a){var b=extension.intentlyEnabled;vAPI.storage.set({intentlyEnabled:!b},function(){extension.intentlyEnabled=!b;var d={type:"basic",title:"Intently Disabled",message:"Intently is now DISABLED. You may need to refresh any open pages for this to take effect.",
alert:"Intently is now DISABLED. You may need to refresh any open pages for this to take effect.",iconUrl:"img/browsericons/intentlyLogo128.png"};extension.intentlyEnabled&&(d={type:"basic",title:"Intently Enabled",message:"Intently is now ENABLED. You may need to refresh any open pages for this to take effect.",alert:"Intently is now ENABLED. You may need to refresh any open pages for this to take effect.",iconUrl:"img/browsericons/intentlyLogo128.png"});issueAlert("intentlyEnabledSuccess",d);a(extension.intentlyEnabled)})},
pushAdReplaceCount:function(a,b){vAPI.storage.set({adreplaceCount:extension.adreplaceCount+a},function(){extension.adreplaceCount+=a;b(extension.adreplaceCount)})},init:function(){extension.intentlyInitializing=!0;vAPI.storage.get(null,function(a){var b=vAPI.app.version,d=a.intentlyExistingVersion||"0.0.0.0";extension.intentlyEnabled=a.intentlyEnabled||!0;extension.adreplaceCount=a.adreplaceCount||0;b!==d&&vAPI.storage.set({intentlyExistingVersion:b},extension.handleAfterInstall)});Utils.log("Initializing Intently");
vAPI.tabs.get(null,function(a){a&&extension.updateBadge(a)});vAPI.toolbarButton.events.onClick(function(a){extension.handlebrowserAction()});considerAdminIntentionsTimer=setInterval(function(){considerAdminIntentions=!0;Utils.log("Admin intentions are now candidates.")},Conf.ADMIN_INTENTION_TIMER);initApiData(function(a){extension.initIntentlyExtension();extension.intentlyInitializing=!1;vAPI.onLoadAllCompleted();extension.checkNotifications();NewTabController.init()});setInterval(checkRefreshCookies,
5E3);checkRefreshCookies();vAPI.tabWatcher.events.onActivate(function(a){extension.updateBrowserAction()});setInterval(extension.checkNotifications,Conf.NOTIFICATION_CHECK_TIME)},initIntentlyExtension:function(){Utils.log("Initializing extension");intentlyData.adBlockerNotificationIssued=!1;extension.intentlyActive=!0;extension.updateBrowserAction()},getConfig:function(a){if((a=a.match(/^https?\:\/\/([^\/?#]+)(?:[\/?#]|$)/i))&&1<a.length){a=a[1].replace("www.","");var b=[],d=[],c=[],e=[],b={};intentlyData.adReplacementRules&&
(intentlyData.adReplacementRules["*"].identifiers||(intentlyData.adReplacementRules["*"].identifiers=[]),intentlyData.adReplacementRules["*"].nestedIdentifiers||(intentlyData.adReplacementRules["*"].nestedIdentifiers=[]),intentlyData.adReplacementRules["*"].exceptions||(intentlyData.adReplacementRules["*"].exceptions=[]),intentlyData.adReplacementRules["*"].hideOverrides||(intentlyData.adReplacementRules["*"].hideOverrides=[]),b=intentlyData.adReplacementRules[a]&&intentlyData.adReplacementRules[a].identifiers?
intentlyData.adReplacementRules[a].identifiers:[],d=intentlyData.adReplacementRules[a]&&intentlyData.adReplacementRules[a].nestedIdentifiers?intentlyData.adReplacementRules[a].nestedIdentifiers:[],c=intentlyData.adReplacementRules[a]&&intentlyData.adReplacementRules[a].exceptions?intentlyData.adReplacementRules[a].exceptions:[],e=intentlyData.adReplacementRules[a]&&intentlyData.adReplacementRules[a].hideOverrides?intentlyData.adReplacementRules[a].hideOverrides:[],b={identifiers:intentlyData.adReplacementRules["*"].identifiers.concat(b),
nestedIdentifiers:intentlyData.adReplacementRules["*"].nestedIdentifiers.concat(d),exceptions:intentlyData.adReplacementRules["*"].exceptions.concat(c),hideOverrides:intentlyData.adReplacementRules["*"].hideOverrides.concat(e)});return{messageType:"config",config:Conf,intentlyActive:extension.intentlyActive,adDefinitions:b,showIntendButton:Conf.SHOW_INTEND_BUTTON}}return null},beginReinitializationProcess:function(a,b){0===REINITIALIZATION_TIMESTAMP&&(REINITIALIZATION_TIMESTAMP=Date.now(),Utils.log("adding deactivation debug entry at "+
REINITIALIZATION_TIMESTAMP),INTENTLY_DEACTIVATION_DEBUG[REINITIALIZATION_TIMESTAMP]={xhr:a,settings:b,reinitializationTries:0});disconnectedReinitializationTimer||(Utils.log("internet disconnection detected, beginning re-initialization timer"),disconnectedReinitializationTimer=setInterval(function(){Utils.log("re-initializing to check for internet connectivity");extension.intentlyInitializing=!0;Utils.log("incrementing deactivation debug entry at "+REINITIALIZATION_TIMESTAMP);INTENTLY_DEACTIVATION_DEBUG[REINITIALIZATION_TIMESTAMP].reinitializationTries++;
initApiData(function(){Utils.log("api data initialization complete");extension.initIntentlyExtension();extension.intentlyInitializing=!1})},Conf.INITIALIZATION_BACKOFF_TIMER))},genericAjaxComplete:function(a,b){if(!0!==a.skipGlobalCompleteHandler)if(200==b.status){if(disconnectedReinitializationTimer&&(REINITIALIZATION_TIMESTAMP=0,clearInterval(disconnectedReinitializationTimer),disconnectedReinitializationTimer=null),b.json){var d=b.json;!1===d.success?(Utils.log("api error:"),Utils.log(a),Utils.log(b),
d.message&&0<=d.message.indexOf("Not Logged In")&&(INTENTLY_LOGOUT_DEBUG.push({xhr:b,settings:a}),Utils.log("confirming user is no longer authenticated"),extension.ajax({url:Conf.CONFIG_URL,skipGlobalCompleteHandler:!0,success:function(a,b,d){200==d.status&&d.json&&d.json.success||(Utils.log("user is confirmed as not authenticated"),extension.intentlyActive=!1,extension.userLoggedIn=!1,extension.updateBrowserAction(),issueAlert("notLoggedIn",{type:"basic",title:"Intently Login",message:"You are currently not logged in to the Intently service. Intently cannot operate without being logged in. Click on the Intently icon to the right of your address bar to login.",
alert:"You are currently not logged in to the Intently service. Intently cannot operate without being logged in. Click on the Intently icon to the right of your address bar to login.",iconUrl:"img/browsericons/intentlyLogo128.png"}))}}))):(extension.userLoggedIn=!0,extension.intentlyActive||extension.intentlyInitializing||disconnectedReinitializationTimer||(Utils.log("user logged in but extension deactivated, re-initializing"),extension.intentlyInitializing=!0,initApiData(function(){Utils.log("api data initialization complete");
extension.initIntentlyExtension();extension.intentlyInitializing=!1})))}}else Utils.log("ajax status error:"),Utils.log(b),Utils.log(a),extension.intentlyActive=!1,extension.intentlyInitializing=!1,extension.userLoggedIn=!1,extension.updateBrowserAction(),extension.beginReinitializationProcess(b,a)},ajaxcomplete:function(a,b){try{b.responseJSON=JSON.parse(b.responseText),b.json=JSON.parse(b.responseText)}catch(d){Utils.log("Unable to parse as JSOn "+d)}extension.genericAjaxComplete(a,b);"function"===
typeof a.success&&(null!==b.json?a.success(b.json,b.status,b):a.success(b.responseText,b.status,b))},rawAjax:function(a,b){var d=new XMLHttpRequest;d.open("GET",a.url);d.addEventListener("load",function(){b(d.responseText)},!1);d.addEventListener("error",function(a){Utils.log("Error~~~");b(void 0)},!1);d.send(null)},binaryAjax:function(a,b){var d=new XMLHttpRequest;d.open("GET",a.url,!0);d.responseType="arraybuffer";d.addEventListener("load",function(){var a=d.response;a?b(a):b(void 0)},!1);d.addEventListener("error",
function(a){Utils.log("Error~~~");b(void 0)},!1);d.send(null)},ajax:function(a){var b="GET";void 0!==a.method&&(b=a.method.toUpperCase());var d=null;void 0!==a.data&&(d=a.data);if("GET"==b){var c=new XMLHttpRequest;c.open("GET",a.url);c.withCredentials="true";c.addEventListener("load",function(){extension.ajaxcomplete(a,c)},!1);c.addEventListener("error",function(b){extension.ajaxcomplete(a,c);Utils.log("Error~~~");Utils.log(b)},!1);c.send(null)}else c=new XMLHttpRequest,c.open("POST",a.url),c.withCredentials=
"true",c.addEventListener("load",function(){extension.ajaxcomplete(a,c)},!1),c.addEventListener("error",function(b){extension.ajaxcomplete(a,c);Utils.logerror(b)},!1),a.contentType&&c.setRequestHeader("Content-type",a.contentType),c.send(d)},login:function(a){var b=(new Fingerprint({screen_resolution:!0,canvas:!0,ie_activex:!0})).get();Cookies.set("bfp",b,{secure:!0,domain:Conf.DOMAIN,expires:new Date(2016,0,1)});extension.ajax({method:"POST",url:a.url,skipGlobalCompleteHandler:!0,data:a.data,contentType:"application/x-www-form-urlencoded",
success:function(a,b,e){Utils.log("logged in completed",a);a&&1==a.success?(Utils.log("Succesfully logged in , Initiate Login on global page"),extension.intentlyInitializing=!0,initApiData(function(){Utils.log("cookie data refresh complete");extension.intentlyActive||extension.initIntentlyExtension();extension.intentlyInitializing=!1;extension.updateBrowserAction()})):Utils.log("Invalid logged in ")}})},logout:function(a){Utils.log("logged out being started , Initiate Logout on global page");Utils.log(a);
extension.ajax({method:"POST",url:a.url,skipGlobalCompleteHandler:!0,data:"",success:function(a,d,c){Utils.log("logged out completed",a);a&&1==a.success?(Utils.log("Succesfully logged out , Initiate Logout on global page"),extension.intentlyInitializing=!0,initApiData(function(){Utils.log("cookie data refresh complete");extension.intentlyActive||extension.initIntentlyExtension();extension.intentlyInitializing=!1;extension.updateBrowserAction()})):Utils.log("Invalid logged out ")}})}},Formatter={isObjectEmpty:function(a){for(var b in a)if(a.hasOwnProperty(b))return!1;
return!0},pad:function(a,b,d){a+="";return a.length>=b?a:Array(b-a.length+1).join(d||"0")+a},getTodayAsYYYMMDD:function(){var a=new Date,b=Conf.NEW_DATE_OFFSET|144E5,b=a.getTime()-b;a.setTime(b);return a.getFullYear()+"-"+Formatter.pad(a.getMonth()+1,2)+"-"+Formatter.pad(a.getDate(),2)},getTomorrowAsYYYMMDD:function(){var a=new Date((new Date).getTime()+864E5),b=Conf.NEW_DATE_OFFSET|144E5,b=a.getTime()-b;a.setTime(b);return a.getFullYear()+"-"+Formatter.pad(a.getMonth()+1,2)+"-"+Formatter.pad(a.getDate(),
2)}},NewTabController={imageCache:{},quoteCache:{},quoteCacheLimit:3,init:function(){NewTabController.initImageCache(function(){NewTabController.updateImageCache()});NewTabController.initQuoteCache(function(){NewTabController.updateQuoteCache()})},getAsImage:function(a){return"data:image/png;base64,"+base64ArrayBuffer(a)},initQuoteCache:function(a){vAPI.storage.get("quoteCache",function(b){NewTabController.quoteCache=b.quoteCache||{};"function"===typeof a&&a()})},initImageCache:function(a){vAPI.storage.get("imageCache",
function(b){NewTabController.imageCache=b.imageCache||{};"function"===typeof a&&a()})},isValidQuote:function(a){return!a||!a.shown},updateQuoteCache:function(a){var b=[];NewTabController.quoteCache&&NewTabController.quoteCache.quotes&&(b=NewTabController.quoteCache.quotes);NewTabController.quoteCache.quotes=b;NewTabController.saveQuoteCache();for(var d=!1,b=b.length-1;b<NewTabController.quoteCacheLimit;b++)NewTabController.downloadQuote(function(b){NewTabController.quoteCache.quotes.push(b);NewTabController.saveQuoteCache();
d||(d=!0,"function"===typeof a&&a())})},updateImageCache:function(a){var b={},d=Formatter.getTodayAsYYYMMDD(),c=Formatter.getTomorrowAsYYYMMDD();b[d]=NewTabController.imageCache[d];b[c]=NewTabController.imageCache[c];b[d]&&b[d].response||NewTabController.getImgForDate(d,function(b,c){c&&(NewTabController.imageCache[b]||(NewTabController.imageCache[b]={}),NewTabController.imageCache[b].image=c.image,NewTabController.imageCache[b].response=c.response,NewTabController.saveImageCache());"function"==typeof a&&
a()});b[c]&&b[c].response||NewTabController.getImgForDate(c,function(a,b){b&&(NewTabController.imageCache[a]||(NewTabController.imageCache[a]={}),NewTabController.imageCache[a].image=b.image,NewTabController.imageCache[a].response=b.response,NewTabController.saveImageCache())});NewTabController.imageCache=b;NewTabController.saveImageCache()},saveQuoteCache:function(a){vAPI.storage.set({quoteCache:NewTabController.quoteCache})},saveImageCache:function(a){vAPI.storage.set({imageCache:NewTabController.imageCache})},
getImgForDate:function(a,b){extension.ajax({url:Conf.API_URL+"newtab/background/"+a,success:function(d,c,e){if(d&&!0===d.success&&d.data&&0<d.data.length){var f=d.data[0];extension.binaryAjax({url:"https://"+Conf.CDN_DOMAIN+"/original/"+f.cdnFileName},function(c){if(c){var d={};d.image=NewTabController.getAsImage(c);d.response=f;"function"===typeof b&&b(a,d)}else"function"===typeof b&&b(a,null)})}else"function"===typeof b&&b(a,null)},error:function(){"function"===typeof b&&b(a,null,null)}})},getTodayImg:function(a){var b=
Formatter.getTodayAsYYYMMDD(),d=NewTabController.imageCache[b];d&&d.response?"function"===typeof a&&a(d.image,d.response):NewTabController.getImgForDate(b,function(b,d){d?(NewTabController.imageCache[b]={},NewTabController.imageCache[b].image=d.image,NewTabController.imageCache[b].response=d.response,"function"===typeof a&&a(d,imgResponseObject)):"function"===typeof a&&a(d.image,d.response)})},getPromo:function(a){extension.ajax({url:Conf.API_URL+"newtab/tip",success:function(b,d,c){b&&!0===b.success&&
b.data?"function"===typeof a&&a(b):"function"===typeof a&&a(null)},error:function(){"function"===typeof a&&a(null)}})},setQuoteLike:function(a,b,d){var c="dislike/";a&&(c="like/");var e={status:0,description:"success"};extension.ajax({url:Conf.API_URL+"quotes/"+c+b,method:"POST",data:JSON.stringify({}),success:function(c,h,m){if(c&&c.success)for(c=NewTabController.quoteCache.quotes.length-1;0<=c;c--)h=NewTabController.quoteCache.quotes[c],h.id==b&&(a?h.impression="1":NewTabController.quoteCache.quotes.splice(c,
1));else e.status=-2,e.description=c.message;"function"===typeof d&&d(e)},error:function(){e.status=-1;e.description="Invalid response";"function"===typeof d&&d(e)}})},setNewTabOptin:function(a,b){var d="optout";a&&(d="optin");var c={status:0,description:"success"};Conf.SHOW_NEW_TAB_OVERRIDE==a?"function"===typeof b&&b(c):extension.ajax({url:Conf.API_URL+"newtab/"+d,method:"POST",data:JSON.stringify({}),success:function(d,f,h){d&&d.success?Conf.SHOW_NEW_TAB_OVERRIDE=a:(c.status=-2,c.description=d.message);
"function"===typeof b&&b(c)},error:function(){c.status=-1;c.description="Invalid response";b(c)}})},logNewTabData:function(a,b){var d={status:0,description:"success"};extension.ajax({url:Conf.API_URL+Conf.NEW_TAB_OVERRIDE_LOG_PATH,method:"POST",data:JSON.stringify(a),success:function(a,e,f){a&&a.success||(d.status=-2,d.description=a.message);"function"===typeof b&&b(d)},error:function(){d.status=-1;d.description="Invalid response";"function"===typeof b&&b(d)}})},setTopSites:function(a,b){var d={status:0,
description:"success"};if(Conf.SHOW_NEW_TAB_FREQUENT_PAGES==a)"function"===typeof b&&b(d);else{var c=0;a&&(c=1);extension.ajax({url:Conf.API_URL+"newtab/frequentpages/"+c,method:"POST",data:JSON.stringify({}),success:function(c,f,h){c&&c.success?Conf.SHOW_NEW_TAB_FREQUENT_PAGES=a:(d.status=-2,d.description=c.message);"function"===typeof b&&b(d)},error:function(){d.status=-1;d.description="Invalid response";"function"===typeof b&&b(d)}})}},getAQuote:function(a){if(NewTabController.quoteCache&&NewTabController.quoteCache.quotes){var b=
NewTabController.quoteCache.quotes.shift();"function"===typeof a&&a(b);NewTabController.updateQuoteCache()}else NewTabController.updateQuoteCache(function(){var b=NewTabController.quoteCache.quotes.shift();"function"===typeof a&&a(b);NewTabController.updateQuoteCache()});NewTabController.downloadQuote(function(b){"function"===typeof a&&a(b)})},downloadQuote:function(a){extension.ajax({url:Conf.API_URL+"newtab/quote",success:function(b,d,c){b&&!0===b.success?"function"===typeof a&&a(b.data):"function"===
typeof a&&a(null)}})},createQuote:function(a,b){var d={status:0,description:"success"};extension.ajax({url:Conf.API_URL+"quotes/add",method:"POST",data:JSON.stringify(a),success:function(a,e,f){a&&a.success?(d.description=a.message,d.quoteID=a.data):(d.status=-2,d.description=a.message,d.paymentRequest=a.paymentRequest);"function"===typeof b&&b(d)},error:function(){d.status=-1;d.description="Invalid response";"function"===typeof b&&b(d)}})}},initApiData=function(a){Utils.log("initializing data");
var b={timestamp:(new Date).getTime(),operatingSystemName:Conf.OS_NAME,operatingSystemVersion:Conf.OS_VERSION,browserName:Conf.BROWSER_NAME,browserVersion:Conf.BROWSER_VERSION,extensionVersion:Conf.EXTENSION_VERSION,language:navigator.language,screenWidth:window.screen.width,screenHeight:window.screen.height,latitude:-1,longitude:-1,geolocationDuration:-1,numOwnedChannels:-1,numSubscribedChannels:-1,numSubscribedChannelResources:-1,numHoneymoonResources:-1,numChannelResourcesMissing:-1,numChannelResourcesRetrieved:-1,
channelResourcesRetrievalDuration:-1,numChannelResourcesPurged:-1,adDefinitionsRefreshed:0,adDefinitionsDuration:-1,adDefinitionsStorageDuration:-1,localStorageSize:-1,initDuration:-1};intentlyData.channelResourceHistory||(intentlyData.channelResourceHistory={});var d=function(c){b.numChannelResourcesPurged=c;var d=function(c){c&&(b.adDefinitionsDuration=c.retrievalEnd-c.retrievalStart,b.adDefinitionsStorageDuration=c.storageEnd-c.storageStart);Utils.log("caching ad definitions to memory");vAPI.storage.get("adReplacementRules",
function(c){intentlyData.adReplacementRules=c.adReplacementRules;vAPI.storage.get("adBlockingRules",function(b){var c={},d={},e;for(e in b.adBlockingRules)b=Filter.fromText(e),Filter.isWhitelistFilter(e)?d[b.id]=b:c[b.id]=b;e=Filter.fromText("@@||www"+Conf.DOMAIN);d[e.id]=e;e=Filter.fromText("@@||api"+Conf.DOMAIN);d[e.id]=e;intentlyData.adBlockingRules=new BlockingFilterSet(FilterSet.fromFilters(c),FilterSet.fromFilters(d),Conf.USER_DOMAIN_WHITELISTS);"function"===typeof a&&a()});Utils.log("getting local storage size");
var d=!1;vAPI.storage.getBytesInUse(null,function(a){function c(){d||(d=!0,b.initDuration=(new Date).getTime()-b.timestamp,Utils.log("storing extension initialization stats"),extension.ajax({method:"POST",data:JSON.stringify(b),url:Conf.API_URL+"eventlog/extensioninitialized",success:function(a,b,c){Utils.log("initialization stats stored");extension.updateBrowserAction()}}))}function e(){Utils.log("WARN Geo position ERROR(-1): Unable to retrieve position ");clearTimeout(f);c()}Utils.log(a+" bytes used in local storage");
b.localStorageSize=a;var f;Utils.log("determining geoposition");var h=(new Date).getTime();navigator.geolocation?(f=setTimeout(e,5E3),navigator.geolocation.getCurrentPosition(function(a){clearTimeout(f);b.geolocationDuration=(new Date).getTime()-h;Utils.log("geoposition determined");b.latitude=a.coords.latitude;b.longitude=a.coords.longitude;clearTimeout(f);c()},function(a){clearTimeout(f);e()},{timeout:4E3})):c()})})};adDefinitionsExpired(function(a){a?(b.adDefinitionsRefreshed=1,refreshAdDefinitionData(d)):
(Utils.log("ad definitions are up to date"),d())})};extension.ajax({url:Conf.CONFIG_URL,success:function(a,e,f){if("string"!==typeof a)if(a&&a.success){a=a.data;for(var h in a)Conf[h]=a[h];var m=0;Conf.REMOTE_DATA_INIT_INFO.forEach(function(a){delete intentlyData[a.propertyName];intentlyData[a.propertyName]=[];extension.ajax({url:Conf.API_URL+a.url,success:function(c,e,f){if((c=f.json)&&c.success){if(intentlyData[a.propertyName]=c.data,m++,m==Conf.REMOTE_DATA_INIT_INFO.length){b.numOwnedChannels=
intentlyData.ownedChannels.length;b.numSubscribedChannels=intentlyData.subscribedChannels.length;b.numSubscribedChannelResources=intentlyData.channelResources.length;0===intentlyData.channelResources.length&&issueAlert("noSubscribedChannels",{type:"basic",title:"Intently Channels",message:"You are currently not subscribed to any Intently channels! Click on the Intently icon to the right of your address bar to subscribe to Intently channels.",alert:"You are currently not subscribed to any Intently channels! Click on the Intently icon to the right of your address bar to subscribe to Intently channels.",
iconUrl:"img/browsericons/intentlyLogo128.png"});var h=[];intentlyData.ownedChannels.forEach(function(a){h.push(a.id)});Conf.USER_DOMAIN_WHITELISTS=[];var q="";intentlyData.userDomainWhitelists.forEach(function(a){Conf.USER_DOMAIN_WHITELISTS.push(a.domain);q+=a.domain;q+="\n"});c=\u00b5Block;c.netWhitelist=c.whitelistFromString(q);c.saveWhitelist();if(0<intentlyData.channelResources.length){var l=0;c=intentlyData.channelResources.filter(function(a){return a.impression&&"0"==a.impression?(l++,!1):
!0});intentlyData.channelResources=c;b.numHoneymoonResources=0;intentlyData.channelResources.forEach(function(a){intentlyData.channelResourceHistory[a.id]||(intentlyData.channelResourceHistory[a.id]={timesSinceLastUse:intentlyData.channelResources.length,lastUsedTimestamp:0});"1"==a.honeymoon&&b.numHoneymoonResources++})}NewTabController.init();d()}}else Utils.logerror(a)}})})}else extension.intentlyInitializing=!1}})},refreshAdDefinitionData=function(a){purgeAdDefinitionData(function(){var b={retrievalStart:-1,
retrievalEnd:-1,storageStart:-1,storageEnd:-1,adDefinitionExpiration:-1};Utils.log("fetching ad definitions");b.retrievalStart=(new Date).getTime();extension.ajax({url:Conf.AD_DEFINITIONS_URL,success:function(d,c,e){b.retrievalEnd=(new Date).getTime();if((d=e.json)&&d.adReplacementRules&&d.adBlockingRules){d.adBlockingRules=FilterNormalizer.normalizeList(d.adBlockingRules);c={};Utils.log("================= ADBLOCK============Length"+d.adBlockingRules.length);for(e=0;e<d.adBlockingRules.length;e++)c[d.adBlockingRules[e]]=
1;delete c[""];d.adBlockingRules=c;b.storageStart=(new Date).getTime();vAPI.storage.set(d,function(){b.storageEnd=(new Date).getTime();var c=vAPI.lastError();c&&(Utils.logerror("µBlock> cachedAssetsManager.save():"+c.message),b.error=c.message);Utils.log("ad definitions stored in local storage");"function"===typeof a&&a(b)})}else Utils.log("Ad definitions error ")}})})},purgeAdDefinitionData=function(a){Utils.log("purging ad definition data");var b=[];vAPI.storage.get(null,function(d){for(var c in d)d=
c.split("-"),2==d.length&&"adDefinition"==d[0]&&b.push(c);Utils.log("found "+b.length+" ad definitions to purge from local storage");0<b.length&&vAPI.storage.remove(b);Utils.log("purging of ad definition data complete");"function"===typeof a&&a()})},fetchChannelResourceData=function(a,b){var d={numChannelResourceRetrieved:-1,channelResourceRetrievalStart:-1,channelResourceRetrievalEnd:-1},c=function(){Utils.log("retrieval and saving of channel resource data complete");"function"===typeof b&&b(d)};
0<a.length?(d.numChannelResourceRetrieved=0,d.channelResourceRetrievalStart=(new Date).getTime(),Utils.log("setting storage"),vAPI.storage.set({},function(){Utils.log("setting storage completed");c()})):c()},purgeChannelResourceData=function(a){var b=function(b){Utils.log("purging of unused channel resource data complete");"function"===typeof a&&a(b)};if(intentlyData.channelResources&&0<intentlyData.channelResources.length){var d=[];vAPI.storage.get(null,function(a){for(var e in a)if(a=e.split("-"),
3==a.length&&"channelResource"==a[0]&&"DATA"==a[2]){for(var f=!1,h=0;h<intentlyData.channelResources.length;h++)intentlyData.channelResources[h].id==a[1]&&(f=!0);!1===f&&(d.push("channelResource-"+a[1]+"-DATA"),d.push("channelResource-"+a[1]+"-TIME"))}Utils.log("found "+d.length+" channel resource entries that can be purged from local storage");0<d.length&&vAPI.storage.remove(d);b(d.length)})}else b(0)},base64ArrayBuffer=function(a){var b="";a=new Uint8Array(a);for(var d=a.byteLength,c=d%3,d=d-c,
e,f,h,m,n=0;n<d;n+=3)m=a[n]<<16|a[n+1]<<8|a[n+2],e=(m&16515072)>>18,f=(m&258048)>>12,h=(m&4032)>>6,m&=63,b+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[e]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[f]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[h]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[m];1==c?(m=a[d],b+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[(m&252)>>2]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[(m&
3)<<4]+"=="):2==c&&(m=a[d]<<8|a[d+1],b+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[(m&64512)>>10]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[(m&1008)>>4]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[(m&15)<<2]+"=");return b},adDefinitionsExpired=function(a){vAPI.storage.get("adDefinitionsExpirationTimestamp",function(b){var d=!0;b.adDefinitionsExpirationTimestamp&&b.adDefinitionsExpirationTimestamp>(new Date).getTime()&&(d=!1);
"function"===typeof a&&a(d)})};Utils.log("Intently background loaded in "+Conf.MODE+" mode with debug "+(Conf.DEBUG?"enabled":"disabled"));extension.framedata.retrieve();\u00b5Block.restart=function(){extension.init();return function(){}}();\u00b5Block.restart();
