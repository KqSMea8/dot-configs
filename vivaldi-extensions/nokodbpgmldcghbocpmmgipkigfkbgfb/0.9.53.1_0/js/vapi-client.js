'use strict';(function(e){var b=e.vAPI=e.vAPI||{},a=e.chrome;if(!b.vapiClientInjected){b.vapiClientInjected=!0;b.sessionId=String.fromCharCode(Date.now()%25+97)+Math.random().toString(36).slice(2);b.chrome=!0;a.runtime?a.runtime.onMessage||(a.runtime.onMessage=a.extension.onMessage,a.runtime.sendMessage=a.extension.sendMessage,a.runtime.onConnect=a.extension.onConnect,a.runtime.connect=a.extension.connect):a.runtime=a.extension;var g=function(d){if(d){var a=b.messaging.channels,f,c;if(!0!==d.broadcast||
d.channelName)d.requestId&&(c=b.messaging.listeners[d.requestId],delete b.messaging.listeners[d.requestId],delete d.requestId),c||(c=(f=a[d.channelName])&&f.listener),"function"===typeof c&&c(d.msg);else for(f in a)!1!==a.hasOwnProperty(f)&&(c=a[f].listener,"function"===typeof c&&c(d.msg))}};b.messaging={port:null,channels:{},listeners:{},requestId:1,setup:function(){this.port=a.runtime.connect({name:b.sessionId});this.port.onMessage.addListener(g)},close:function(){null!==this.port&&(this.port.disconnect(),
this.port.onMessage.removeListener(g),this.port=null,this.channels={},this.listeners={})},channel:function(a,e){if(a)return this.channels[a]={channelName:a,listener:"function"===typeof e?e:null,send:function(a,c){null===b.messaging.port&&b.messaging.setup();a={channelName:this.channelName,msg:a};c&&(a.requestId=b.messaging.requestId++,b.messaging.listeners[a.requestId]=c);b.messaging.port.postMessage(a)},close:function(){delete b.messaging.channels[this.channelName];0===Object.keys(b.messaging.channels).length&&
b.messaging.close()}},this.channels[a]}}}})(this);
