$(document).ready(function(){var online=navigator.onLine;if(online===!1){$("#errorbox").show()}
var monthNames=["January","February","March","April","May","June","July","August","September","October","November","December"];var dayNames=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];var newDate=new Date();newDate.setDate(newDate.getDate());$('#date').html(newDate.getDate()+' '+monthNames[newDate.getMonth()]+' '+newDate.getFullYear());$('#day').html(dayNames[newDate.getDay()]);setInterval(function(){var seconds=new Date().getSeconds();$("#sec").html((seconds<10?"0":"")+seconds)},1000);setInterval(function(){var minutes=new Date().getMinutes();$("#min").html((minutes<10?"0":"")+minutes)},1000);setInterval(function(){var hours=new Date().getHours();$("#hours").html((hours<10?"0":"")+hours)},1000);chrome.storage.sync.get('blockedurl',function(obj){var nonourl=obj.blockedurl;if(nonourl!==""&&nonourl!==undefined){var eyeNum=Math.floor(Math.random()*7)+1;var eyes="<img src='images/eyes/"+eyeNum+".jpg'/>";$('.eyes').append(eyes);$('.blockedurl').append(nonourl);$('.hide-blocked').addClass("show-eyes")};$(".hide-blocked").click(function(){$(this).addClass("fade-out-eyes");setTimeout(function(){$(".hide-blocked").hide()},800)})});$("#empty-list").click(function(){$(this).addClass("prod-poof").delay(300).queue(function(next){$(this).hide();next()})});chrome.storage.sync.get({pause:{active:!1,pauseMoment:"",dayOff:"",duration:0}},function(data){pause=data.pause;if(pause.active===!0){$("#todo-list-item").attr("placeholder","Add a to-do to resume site blocking\u2026")}});function resetPause(){if(pause.active===!0){var pauseObj={active:!1,pauseMoment:0,dayOff:"",duration:0};chrome.storage.sync.set({pause:pauseObj});chrome.storage.sync.get({pause:{active:!1,pauseMoment:"",dayOff:"",duration:0}},function(data){pause=data.pause});$("#todo-list-item").attr("placeholder","Add a to-do\u2026");$("#blocking-resumed").fadeIn(700).delay(1300).queue(function(next){$(this).fadeOut(700);next()})}}
chrome.storage.sync.get('listItems',function(obj){var items=obj.listItems;if(items!==undefined){$(items).each(function(i){$('#list-items').append("<li class='todo-item "+this.h+"' data-d='"+this.d+"'><span class='to-do-inner'>"+this.c+"</span><span class='handle noclick'></span><span class='make-header noclick'></span></li>")})}
if($('#list-items').is(':empty')){$('#empty-list').show();$('#finished-list').show()}});$('.add-items').submit(function(event){event.preventDefault();var item=$('#todo-list-item').val();var d=new Date();if(item){var itemstr=item.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;');$('#list-items').append("<li class='todo-item' class='' data-d='"+d+"'><span class='to-do-inner'>"+itemstr+"</span><span class='handle noclick'></span><span class='make-header noclick'></span></li>");updateList();if($('#list-items').not(':empty')){$('#finished-list').hide();$('#empty-list').addClass("prod-poof").delay(300).queue(function(next){$(this).hide();next()});hidebg()};$('#todo-list-item').val("");resetPause()}});$(document).on('click','.todo-item',function(e){if($(e.target).hasClass("noclick")){return}else{var m=Math.floor(Math.random()*10)+1;var n="p"+m.toString();$(this).addClass("poof "+n).delay(300).queue(function(next){$(this).remove();updateList();resetPause();if($('#list-items').is(':empty')){var listfallback='';chrome.storage.sync.set({'listItems':listfallback},function(){});showbg();$('#finished-list').fadeIn(5000)};next()})}});$(function(){$("#list-items").sortable({handle:'.handle',placeholder:"li-placeholder",update:function(event,ui){updateList()},connectWith:"#list-items",start:function(e,ui){ui.placeholder.height(ui.item.height())}});$("#list-items").disableSelection()});$(document).on('click','.make-header',function(){$(this).parent().toggleClass('h');updateList()});function updateList(){var list=[];$('#list-items li').each(function(){var content=$(this).text();var header="";if($(this).hasClass('h')){header="h"}
var date=$(this).attr('data-d');var item={c:content,d:date,h:header};list.push(item)});chrome.storage.sync.set({'listItems':list},function(){})}
chrome.storage.sync.get('prodDate',function(d){var proddate=d.prodDate;var date=new Date;var d=date.toISOString().split('T')[0];if(proddate!==d){var produrl="https://prodtodolist.com/json/"+d;$.getJSON(produrl,{format:"json"}).done(function(data){if(data.title!==undefined){$(".prod-container").hide().append("<div class='prod'><h4 class='prod-title "+data.style+" center-text'><span>"+data.title+"</span></h4><div class='prod-content'>"+data.content+"</div><div class='prod-sources'>"+data.sources+"</div></div>").fadeIn(300);$(".prod-title").click(function(){$(".prod-container").addClass("prod-poof").delay(300).queue(function(next){$(this).hide();next()});chrome.storage.sync.set({'prodDate':d},function(){})})}else{return}})}else{return}});var blockedurl="";chrome.storage.sync.set({'blockedurl':blockedurl},function(){});$(".go-to-options").click(function(){chrome.tabs.update({'url':chrome.extension.getURL('options.html')})});chrome.storage.sync.get('welcome',function(w){var welcome=w.welcome;if(welcome!=="yes"){$('.hide-welcome').show();$('#empty-list').hide();$('#finished-list').hide();var welcomeitems=[{d:"",h:"h",c:"This is your to-do list"},{d:"",h:"",c:"You can add a to-do by typing in the input above"},{d:"",h:"",c:"When you've completed a to-do, give it a click"},{d:"",h:"",c:"Click the H button"},{d:"",h:"",c:"Use the arrow button to drag and drop items"},{d:"",h:"",c:"The options button is hidden at the bottom of the page"}];$(welcomeitems).each(function(i){$('#list-items').append("<li class='todo-item "+this.h+"' data-d='"+this.d+"'><span class='to-do-inner'>"+this.c+"</span><span class='handle noclick'></span><span class='make-header noclick'></span></li>")});$("#continue").click(function(){$(".hide-welcome").addClass("prod-poof").delay(300).queue(function(next){$(this).hide();next()})});chrome.storage.sync.set({'welcome':"yes"},function(){})}else{return}});if(online===!0){var imageURL="url(https://source.unsplash.com/collection/2721999/daily)"}else{var imageURL="url(images/m.jpg)"}
$('#bgimage').css('background-image',imageURL);function showbg(){$('#prod').fadeOut(300);$('#bgimage').addClass("showbg")}
function hidebg(){$('#prod').fadeIn(300);$('#bgimage').removeClass("showbg")}(function(){var ga=document.createElement('script');ga.type='text/javascript';ga.async=!0;ga.src='https://ssl.google-analytics.com/ga.js';var s=document.getElementsByTagName('script')[0];s.parentNode.insertBefore(ga,s)})()})
