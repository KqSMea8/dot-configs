$(document).ready(function(){chrome.storage.sync.get('welcome',function(w){var w=w.welcome;if(w!=="yes"){$("#welcome-popup").show();$("#launch").click(function(){chrome.tabs.create({'url':chrome.extension.getURL('new-tab.html')})})}else{normal()}});function normal(){chrome.storage.sync.get({pause:{active:!1,pauseMoment:"",dayOff:"",duration:0}},function(data){pause=data.pause;if(pause.active===!0){$("#todo-list-item-popup").attr("placeholder","Add a to-do to resume site blocking\u2026")}});function resetPause(){if(pause.active===!0){var pauseObj={active:!1,pauseMoment:0,dayOff:"",duration:0};chrome.storage.sync.set({pause:pauseObj});chrome.storage.sync.get({pause:{active:!1,pauseMoment:"",dayOff:"",duration:0}},function(data){pause=data.pause});$("#todo-list-item-popup").attr("placeholder","Add a to-do\u2026")}}
chrome.tabs.query({currentWindow:!0,active:!0},function(tabs){if(tabs[0].title=="New Tab"){chrome.storage.sync.get({blockedUrls:[]},function(d){if(d.blockedUrls.length===0){$("#blocked-message").text("You haven't blocked any sites.");$("#show-options").show()}else{$("#pay-for-prod").show()}})}else{$("#add-to-list").show();$("#open-new-tab").click(function(){chrome.tabs.create({'url':chrome.extension.getURL('new-tab.html')})});$('.add-items').submit(function(event){event.preventDefault();var item=$('#todo-list-item-popup').val();var d=new Date();if(item){var itemstr=item.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;');appendList(item,d);$('#todo-list-item-popup').val("")}
resetPause()})}});chrome.storage.sync.get({listItems:[]},function(obj){var c=obj.listItems.length;var countText="";var count=c.toString();if(c===0){$("#finished-list-popup").show()}else if(c===1){$("#taskCount").show();$("#count").text(count);$("#s").hide()}else{$("#taskCount").show();$("#count").text(count);$("#s").show()}});function appendList(content,date){chrome.storage.sync.get({listItems:[]},function(obj){var list=obj.listItems;var c=list.length;if(c===0){list=[]}
var item={c:content,d:date,h:""};list.push(item);chrome.storage.sync.set({'listItems':list},function(obj){c++;updateCount(c)})})}
function updateCount(c){if(c===1){$("#finished-list-popup").fadeOut(300,function(){$("#count").text(c);$("#taskCount").fadeIn(300)})}else{$("#count").fadeOut(300,function(){$("#count").text(c).fadeIn(300)});if(c>1){$("#s").fadeIn(300)}}}
$('#open-options').click(function(){if(chrome.runtime.openOptionsPage){chrome.runtime.openOptionsPage()}else{window.open(chrome.runtime.getURL('options.html'))}})}})
